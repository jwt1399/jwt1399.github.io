<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Q&amp;AÔºöJUC, ÁÆÄÁÆÄ,ÁÆÄÁÆÄÂçöÂÆ¢,ÁΩëÁªúÂÆâÂÖ®,ËÆ°ÁÆóÊú∫,JavaÂºÄÂèë">
    <meta name="description" content="‚ë†Á∫øÁ®ã‚ù∂Âü∫Á°ÄüåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´ËøõÁ®ãÔºöÊòØÁ®ãÂ∫èËøêË°åÂíåËµÑÊ∫êÂàÜÈÖçÁöÑÂü∫Êú¨Âçï‰Ωç

Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÂ†ÜÂíåÊ†àÔºåÊó¢‰∏çÂÖ±‰∫´Â†ÜÔºå‰∫¶‰∏çÂÖ±‰∫´Ê†àÔºåËøõÁ®ãÁî±Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶„ÄÇ

Á∫øÁ®ãÔºöÊòØ CPU Ë∞ÉÂ∫¶ÂíåÂàÜÊ¥æÁöÑÂü∫Êú¨Âçï‰ΩçÔºåÊòØËøõÁ®ãÁöÑ‰∏Ä‰∏™ÂÆû‰Ωì

Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÊ†àÂíåÂÖ±‰∫´ÁöÑÂ†ÜÔºåÂÖ±‰∫´Â†ÜÔºå‰∏ç">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html;charset=gb2312" />
    <meta name="sogou_site_verification" content="VTcD33rrfd" />
    <meta name="google-site-verification" content="mHsYpjV9Rl0e0UzjioJFLg8RMtOhxw8HB3D21dIWvmc" />
	<meta name="referrer" content="unsafe-url">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Q&amp;AÔºöJUC | ÁÆÄË®Ä‰πã</title>
    <link rel="icon" type="image/png" href="/favicon.png">
	<!--ÂèòÁÅ∞-->
	<!-- <link href="http://static.isenyu.cn/file/css/MemorialDay.css"; rel="stylesheet" type="text/css" /> -->
    <!-- <style type="text/css">
     html{ filter: grayscale(100%); /* Ê†áÂáÜÂÜôÊ≥ï just for IE6-9 */ 
        -webkit-filter: grayscale(100%); /* webkit ÂÜÖÊ†∏ÊîØÊåÅÁ®ãÂ∫¶ËæÉÂ•Ω */ 
        -moz-filter: grayscale(100%); /* ÂÖ∂‰ªñÂÜÖÊ†∏Áé∞Âú®Âπ∂‰∏çÊîØÊåÅÔºå‰∏∫‰∫ÜÂ∞ÜÊù•ÂÖºÂÆπÊÄß‰π¶ÂÜô */ 
        -ms-filter: grayscale(100%); 
        -o-filter: grayscale(100%); filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
        filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 3.5+ */ }
     </style> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.staticfile.org/font-awesome/6.0.0/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.staticfile.org/aos/0.1.0/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="https://upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.3.min.js"></script>
	<!--valine_‰∫∫Êú∫È™åËØÅ-->
	<script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
	<script src="/js/Valine-RJyanzheng.js"></script>

    
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="ÁÆÄË®Ä‰πã" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img no-lazy src="/medias/logo.png" class="logo-img" alt="">
                    
                    <span class="logo-span">ÁÆÄË®Ä‰πã</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Home</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-user-secret" style="zoom: 0.6;"></i>
      
      <span>Sec</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/categories/Web/">
          
          <i class="fab fa-internet-explorer" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Web</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/CTF/">
          
          <i class="fas fa-flag" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>CTF</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Crypto/">
          
          <i class="fa-solid fa-shield" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Data</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fab fa-java" style="zoom: 0.6;"></i>
      
      <span>Java</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/categories/JavaSE/">
          
          <i class="fa-solid fa-mug-saucer" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>JavaSE</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/JavaWeb/">
          
          <i class="fa-solid fa-earth-americas" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>JavaWeb</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Spring/">
          
          <i class="fa-solid fa-leaf" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Spring</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Q-A/">
          
          <i class="fa-solid fa-bell" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Q&A</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fa-solid fa-desktop" style="zoom: 0.6;"></i>
      
      <span>CS</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/categories/CS%E5%9F%BA%E7%A1%80/">
          
          <i class="fa-solid fa-server" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>CSÂü∫Á°Ä</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/SQL/">
          
          <i class="fas fa-database" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Êï∞ÊçÆÂ∫ì</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/">
          
          <i class="fa-solid fa-bezier-curve" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ÁªìÊûÑ-ÁÆóÊ≥ï</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-layer-group" style="zoom: 0.6;"></i>
      
      <span>Others</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/categories/Python/">
          
          <i class="fab fa-python" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Python</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Course/">
          
          <i class="fa-solid fa-graduation-cap" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Course</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Share/">
          
          <i class="fa-solid fa-crown" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Share~</span>
        </a>
      </li>
      
      <li>
        <a href="/categories/Tools/">
          
          <i class="fas fa-tools" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Tools~</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Êï¥ÁêÜ</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/tags/">
          
          <i class="fas fa-bookmark" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ÂΩíÁ±ª</span>
        </a>
      </li>
      
      <li>
        <a href="/archives/">
          
          <i class="fas fa-file-contract" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ÂΩíÊ°£</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fa-solid fa-paper-plane" style="zoom: 0.6;"></i>
      
      <span>‰∫§ÊµÅ</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/friends/">
          
          <i class="fas fa-venus-mars" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ÂèãÈìæ</span>
        </a>
      </li>
      
      <li>
        <a href="/artitalk/">
          
          <i class="fa-solid fa-message" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ËØ¥ËØ¥</span>
        </a>
      </li>
      
      <li>
        <a href="/contact/">
          
          <i class="fas fa-envelope" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>ÁïôË®Ä</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about/" class="waves-effect waves-light">
      
      <i class="fas fa-id-card-alt" style="zoom: 0.6;"></i>
      
      <span>ÂÖ≥‰∫é</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="ÊêúÁ¥¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img no-lazy src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">ÁÆÄË®Ä‰πã</div>
        <div class="logo-desc">
            
            ÊÇÑÊó†Â£∞ÊÅØÂú∞ÂèòÂùöÂº∫ÔºåÂÆâÈùôÂú∞Âèò‰ºòÁßÄÔºÅ
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Home
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-user-secret"></i>
			
			Sec
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/categories/Web/ " style="margin-left:50px";>
				  
				   <i class="fab fa-internet-explorer" style="position: absolute;left:28px" ></i>
			      
		          <span>Web</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/CTF/ " style="margin-left:50px";>
				  
				   <i class="fas fa-flag" style="position: absolute;left:28px" ></i>
			      
		          <span>CTF</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Crypto/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-shield" style="position: absolute;left:28px" ></i>
			      
		          <span>Data</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fab fa-java"></i>
			
			Java
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/categories/JavaSE/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-mug-saucer" style="position: absolute;left:28px" ></i>
			      
		          <span>JavaSE</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/JavaWeb/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-earth-americas" style="position: absolute;left:28px" ></i>
			      
		          <span>JavaWeb</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Spring/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-leaf" style="position: absolute;left:28px" ></i>
			      
		          <span>Spring</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Q-A/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-bell" style="position: absolute;left:28px" ></i>
			      
		          <span>Q&A</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fa-solid fa-desktop"></i>
			
			CS
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/categories/CS%E5%9F%BA%E7%A1%80/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-server" style="position: absolute;left:28px" ></i>
			      
		          <span>CSÂü∫Á°Ä</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/SQL/ " style="margin-left:50px";>
				  
				   <i class="fas fa-database" style="position: absolute;left:28px" ></i>
			      
		          <span>Êï∞ÊçÆÂ∫ì</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-bezier-curve" style="position: absolute;left:28px" ></i>
			      
		          <span>ÁªìÊûÑ-ÁÆóÊ≥ï</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-layer-group"></i>
			
			Others
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/categories/Python/ " style="margin-left:50px";>
				  
				   <i class="fab fa-python" style="position: absolute;left:28px" ></i>
			      
		          <span>Python</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Course/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-graduation-cap" style="position: absolute;left:28px" ></i>
			      
		          <span>Course</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Share/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-crown" style="position: absolute;left:28px" ></i>
			      
		          <span>Share~</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/categories/Tools/ " style="margin-left:50px";>
				  
				   <i class="fas fa-tools" style="position: absolute;left:28px" ></i>
			      
		          <span>Tools~</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Êï¥ÁêÜ
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/tags/ " style="margin-left:50px";>
				  
				   <i class="fas fa-bookmark" style="position: absolute;left:28px" ></i>
			      
		          <span>ÂΩíÁ±ª</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/archives/ " style="margin-left:50px";>
				  
				   <i class="fas fa-file-contract" style="position: absolute;left:28px" ></i>
			      
		          <span>ÂΩíÊ°£</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fa-solid fa-paper-plane"></i>
			
			‰∫§ÊµÅ
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/friends/ " style="margin-left:50px";>
				  
				   <i class="fas fa-venus-mars" style="position: absolute;left:28px" ></i>
			      
		          <span>ÂèãÈìæ</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/artitalk/ " style="margin-left:50px";>
				  
				   <i class="fa-solid fa-message" style="position: absolute;left:28px" ></i>
			      
		          <span>ËØ¥ËØ¥</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/contact/ " style="margin-left:50px";>
				  
				   <i class="fas fa-envelope" style="position: absolute;left:28px" ></i>
			      
		          <span>ÁïôË®Ä</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-id-card-alt"></i>
			
			ÂÖ≥‰∫é
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('ÁåúÁåúÂØÜÁ†ÅÊòØ‰ªÄ‰πàÂë¢„ÉæÔæâ‚âß‚àÄ‚â¶)o')).toString(CryptoJS.enc.Hex)) {
                alert('ÂìéÂë¶ÔºÅÂØÜÁ†ÅÂ•ΩÂÉè‰∏çÂØπÂìüÔºåÂ∞ÜËøîÂõû‰∏ªÈ°µÔºÅ');
                location.href = '/';	
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://img.jwt1399.top/img/202212062044543.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Q&amp;AÔºöJUC</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    /*.toc-widget {
        width: 345px;
        padding-left: 20px;
    }*/
    .toc-widget {
        width: 345px;
        padding-left: 20px;
        /* ÊØõÁéªÁíÉ */
        /*background-color: rgba(162,101,228, 0.08);*/
        /*backdrop-filter: saturate(180%) blur(20px);*/
        /*ÁõÆÂΩïÊ†∑Âºè‰øÆÊîπ*/
        background-color: rgb(255, 255, 255,0.7);
        border-radius: 10px;
        box-shadow: 0 10px 35px 2px rgba(0, 0, 0, .15), 0 5px 15px rgba(0, 0, 0, .07), 0 2px 5px -5px rgba(0, 0, 0, .1) !important;
    }
    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- ÊñáÁ´†ÂÜÖÂÆπËØ¶ÊÉÖ -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/JUC/">
                                <span class="chip bg-color">JUC</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Q-A/" class="post-category">
                                Q&A
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>ÂèëÂ∏ÉÊó•Êúü:&nbsp;&nbsp;
                    2022-12-27
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Êõ¥Êñ∞Êó•Êúü:&nbsp;&nbsp;
                    2023-01-20
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>ÊñáÁ´†Â≠óÊï∞:&nbsp;&nbsp;
                    28.3k
                </div>
                

                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>ÈòÖËØªÊ¨°Êï∞:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="‚ë†Á∫øÁ®ã"><a href="#‚ë†Á∫øÁ®ã" class="headerlink" title="‚ë†Á∫øÁ®ã"></a>‚ë†Á∫øÁ®ã</h1><h2 id="‚ù∂Âü∫Á°Ä"><a href="#‚ù∂Âü∫Á°Ä" class="headerlink" title="‚ù∂Âü∫Á°Ä"></a>‚ù∂Âü∫Á°Ä</h2><h3 id="üåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´"><a href="#üåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´" class="headerlink" title="üåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´"></a>üåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´</h3><p><strong>ËøõÁ®ã</strong>ÔºöÊòØÁ®ãÂ∫èËøêË°åÂíåËµÑÊ∫êÂàÜÈÖçÁöÑÂü∫Êú¨Âçï‰Ωç</p>
<ul>
<li>Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÂ†ÜÂíåÊ†àÔºåÊó¢‰∏çÂÖ±‰∫´Â†ÜÔºå‰∫¶‰∏çÂÖ±‰∫´Ê†àÔºåËøõÁ®ãÁî±Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶„ÄÇ</li>
</ul>
<p><strong>Á∫øÁ®ã</strong>ÔºöÊòØ CPU Ë∞ÉÂ∫¶ÂíåÂàÜÊ¥æÁöÑÂü∫Êú¨Âçï‰ΩçÔºåÊòØËøõÁ®ãÁöÑ‰∏Ä‰∏™ÂÆû‰Ωì</p>
<ul>
<li>Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÊ†àÂíåÂÖ±‰∫´ÁöÑÂ†ÜÔºåÂÖ±‰∫´Â†ÜÔºå‰∏çÂÖ±‰∫´Ê†àÔºåÁ∫øÁ®ã‰∫¶Áî±Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶(Ê†áÂáÜÁ∫øÁ®ãÊòØÁöÑ)„ÄÇ</li>
</ul>
<p>‰∏Ä‰∏™Á®ãÂ∫èËá≥Â∞ëÊúâ‰∏Ä‰∏™ËøõÁ®ãÔºå‰∏Ä‰∏™ËøõÁ®ãËá≥Â∞ëÊúâ‰∏Ä‰∏™Á∫øÁ®ã„ÄÇËøõÁ®ãÂú®ÊâßË°åËøáÁ®ã‰∏≠Êã•ÊúâÁã¨Á´ãÁöÑÂÜÖÂ≠òÂçïÂÖÉÔºåËÄåÂ§ö‰∏™Á∫øÁ®ãÂÖ±‰∫´ÂÜÖÂ≠òËµÑÊ∫êÔºåÂáèÂ∞ëÂàáÊç¢Ê¨°Êï∞Ôºå‰ªéËÄåÊïàÁéáÊõ¥È´ò„ÄÇ</p>
<h3 id="üåüËØ¥ËØ¥ÂçèÁ®ãÂíåÁ∫øÁ®ãÂå∫Âà´"><a href="#üåüËØ¥ËØ¥ÂçèÁ®ãÂíåÁ∫øÁ®ãÂå∫Âà´" class="headerlink" title="üåüËØ¥ËØ¥ÂçèÁ®ãÂíåÁ∫øÁ®ãÂå∫Âà´"></a>üåüËØ¥ËØ¥ÂçèÁ®ãÂíåÁ∫øÁ®ãÂå∫Âà´</h3><p>ÂçèÁ®ãÊòØ‰∏ÄÁßçÊØîÁ∫øÁ®ãÊõ¥Âä†ËΩªÈáèÁ∫ßÁöÑÂ≠òÂú®„ÄÇÂçèÁ®ã‰∏çÊòØË¢´Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÊâÄÁÆ°ÁêÜÔºåËÄåÂÆåÂÖ®ÊòØÁî±Á®ãÂ∫èÊâÄÊéßÂà∂Ôºà‰πüÂ∞±ÊòØÂú®Áî®Êà∑ÊÄÅ‰∏≠ÊâßË°åÔºâ„ÄÇËøôÊ†∑Â∏¶Êù•ÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØÊÄßËÉΩÂæóÂà∞‰∫ÜÂæàÂ§ßÁöÑÊèêÂçáÔºå‰∏ç‰ºöÂÉèÁ∫øÁ®ãÂàáÊç¢ÈÇ£Ê†∑Ê∂àËÄóËµÑÊ∫ê„ÄÇÂõ†Ê≠§ÂçèÁ®ãÁöÑÂºÄÈîÄËøúËøúÂ∞è‰∫éÁ∫øÁ®ãÁöÑÂºÄÈîÄ„ÄÇ</p>
<p>ÂçèÁ®ãÊã•ÊúâËá™Â∑±ÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à„ÄÇÂçèÁ®ãË∞ÉÂ∫¶ÂàáÊç¢Êó∂ÔºåÂ∞ÜÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†à‰øùÂ≠òÂà∞ÂÖ∂ÂÆÉÂú∞ÊñπÔºåÂú®ÂàáÂõûÊù•ÁöÑÊó∂ÂÄôÔºåÊÅ¢Â§çÂÖàÂâç‰øùÂ≠òÁöÑÂØÑÂ≠òÂô®‰∏ä‰∏ãÊñáÂíåÊ†àÔºåÁõ¥Êé•Êìç‰ΩúÊ†àÂàôÂü∫Êú¨Ê≤°ÊúâÂÜÖÊ†∏ÂàáÊç¢ÁöÑÂºÄÈîÄÔºåÂèØ‰ª•‰∏çÂä†ÈîÅÁöÑËÆøÈóÆÂÖ®Â±ÄÂèòÈáèÔºåÊâÄ‰ª•‰∏ä‰∏ãÊñáÁöÑÂàáÊç¢ÈùûÂ∏∏Âø´„ÄÇ</p>
<ul>
<li>‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÊúâÂ§ö‰∏™ÂçèÁ®ãÔºå‰∏Ä‰∏™ËøõÁ®ã‰πüÂèØ‰ª•ÂçïÁã¨Êã•ÊúâÂ§ö‰∏™ÂçèÁ®ãÔºõ</li>
<li>Á∫øÁ®ãËøõÁ®ãÈÉΩÊòØÂêåÊ≠•Êú∫Âà∂ÔºåËÄåÂçèÁ®ãÂàôÊòØÂºÇÊ≠•Êú∫Âà∂Ôºõ</li>
<li>ÂçèÁ®ãËÉΩ‰øùÁïô‰∏ä‰∏ÄÊ¨°Ë∞ÉÁî®ÁöÑÁä∂ÊÄÅÔºåÊØèÊ¨°ÈáçÂÖ•Êó∂ÔºåÂ∞±Áõ∏ÂΩì‰∫éËøõÂÖ•‰∏ä‰∏ÄÊ¨°Ë∞ÉÁî®ÁöÑÁä∂ÊÄÅÔºõ</li>
</ul>
<h3 id="üåüÂêåÊ≠•ÂíåÂºÇÊ≠•ÁöÑÂå∫Âà´"><a href="#üåüÂêåÊ≠•ÂíåÂºÇÊ≠•ÁöÑÂå∫Âà´" class="headerlink" title="üåüÂêåÊ≠•ÂíåÂºÇÊ≠•ÁöÑÂå∫Âà´"></a>üåüÂêåÊ≠•ÂíåÂºÇÊ≠•ÁöÑÂå∫Âà´</h3><ul>
<li><strong>ÂêåÊ≠•</strong> Ôºö ÂèëÂá∫‰∏Ä‰∏™Ë∞ÉÁî®‰πãÂêéÔºåÂú®Ê≤°ÊúâÂæóÂà∞ÁªìÊûú‰πãÂâçÔºå ËØ•Ë∞ÉÁî®Â∞±‰∏çÂèØ‰ª•ËøîÂõûÔºå‰∏ÄÁõ¥Á≠âÂæÖ„ÄÇ</li>
<li><strong>ÂºÇÊ≠•</strong> ÔºöË∞ÉÁî®Âú®ÂèëÂá∫‰πãÂêéÔºå‰∏çÁî®Á≠âÂæÖËøîÂõûÁªìÊûúÔºåËØ•Ë∞ÉÁî®Áõ¥Êé•ËøîÂõû„ÄÇ</li>
</ul>
<h3 id="üåüÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÁöÑÂå∫Âà´"><a href="#üåüÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÁöÑÂå∫Âà´" class="headerlink" title="üåüÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÁöÑÂå∫Âà´"></a>üåüÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÁöÑÂå∫Âà´</h3><p>Áî®Êà∑Á∫øÁ®ãÔºöÂπ≥Êó∂‰ΩøÁî®Âà∞ÁöÑÁ∫øÁ®ãÂùá‰∏∫Áî®Êà∑Á∫øÁ®ã„ÄÇ </p>
<p>ÂÆàÊä§Á∫øÁ®ãÔºöÁî®Êù•ÊúçÂä°Áî®Êà∑Á∫øÁ®ãÁöÑÁ∫øÁ®ãÔºå‰æãÂ¶ÇÂûÉÂúæÂõûÊî∂Á∫øÁ®ã„ÄÇ </p>
<p>‰ªª‰ΩïÁ∫øÁ®ãÈÉΩÂèØ‰ª•ËÆæÁΩÆ‰∏∫ÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÔºåÈÄöËøáÊñπÊ≥ï<code>Thread.setDaemon(true/false)</code> ËÆæÁΩÆ</p>
<ul>
<li>trueÂàôÊòØÂ∞ÜËØ•Á∫øÁ®ãËÆæÁΩÆ‰∏∫ÂÆàÊä§Á∫øÁ®ãÔºåfalseÂàôÊòØÂ∞ÜËØ•Á∫øÁ®ãËÆæÁΩÆ‰∏∫Áî®Êà∑Á∫øÁ®ã„ÄÇ</li>
<li>ÂøÖÈ°ªÂú® <code>Thread.start()</code> ‰πãÂâçË∞ÉÁî®ÔºåÂê¶ÂàôËøêË°åÊó∂‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</li>
</ul>
<p>ÂÆàÊä§Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÁöÑÂå∫Âà´‰∏ªË¶ÅÂú®‰∫éJavaËôöÊãüÊú∫ÊòØÂê¶Â≠òÊ¥ª„ÄÇ</p>
<ul>
<li>Áî®Êà∑Á∫øÁ®ãÔºöÂΩì‰ªª‰Ωï‰∏Ä‰∏™Áî®Êà∑Á∫øÁ®ãÊú™ÁªìÊùüÔºåJavaËôöÊãüÊú∫Âàô‰∏ç‰ºöÁªìÊùü„ÄÇ </li>
<li>ÂÆàÊä§Á∫øÁ®ãÔºöÂ¶ÇÊûúÂè™Ââ©ÂÆàÊä§Á∫øÁ®ãÊú™ÁªìÊùüÔºåJavaËôöÊãüÊú∫ÁªìÊùü„ÄÇ</li>
</ul>
<h3 id="üåüÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢"><a href="#üåüÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢" class="headerlink" title="üåüÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢"></a>üåüÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢</h3><p>CPU‰ºöÈÄöËøáÊó∂Èó¥ÁâáÂàÜÈÖçÁÆóÊ≥ïÊù•Âæ™ÁéØÊâßË°å‰ªªÂä°ÔºåÂΩìÂâç‰ªªÂä°ÊâßË°åÂÆå‰∏Ä‰∏™Êó∂Èó¥ÁâáÂêé‰ºöÂàáÊç¢Âà∞‰∏ã‰∏Ä‰∏™‰ªªÂä°Ôºå‰ΩÜÂàáÊç¢Ââç‰ºö‰øùÂ≠ò‰∏ä‰∏Ä‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅÔºåÂõ†‰∏∫‰∏ãÊ¨°ÂàáÊç¢ÂõûËøô‰∏™‰ªªÂä°Êó∂ËøòË¶ÅÂä†ËΩΩËøô‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅÁªßÁª≠ÊâßË°åÔºå‰ªé‰ªªÂä°‰øùÂ≠òÂà∞ÂÜçÂä†ËΩΩÁöÑËøáÁ®ãÂ∞±ÊòØ‰∏ÄÊ¨°‰∏ä‰∏ãÊñáÂàáÊç¢„ÄÇ</p>
<h3 id="üåüÁ∫øÁ®ãÁä∂ÊÄÅÂèäËΩ¨Êç¢"><a href="#üåüÁ∫øÁ®ãÁä∂ÊÄÅÂèäËΩ¨Êç¢" class="headerlink" title="üåüÁ∫øÁ®ãÁä∂ÊÄÅÂèäËΩ¨Êç¢"></a>üåüÁ∫øÁ®ãÁä∂ÊÄÅÂèäËΩ¨Êç¢</h3><blockquote>
<p>Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂíåÁä∂ÊÄÅ</p>
</blockquote>
<p>Âú® Java API ‰∏≠ <code>java.lang.Thread.State</code> Ëøô‰∏™Êûö‰∏æ‰∏≠ÁªôÂá∫‰∫ÜÂÖ≠ÁßçÁ∫øÁ®ãÁä∂ÊÄÅÔºö</p>
<table>
<thead>
<tr>
<th>Á∫øÁ®ãÁä∂ÊÄÅ</th>
<th>ÂØºËá¥Áä∂ÊÄÅÂèëÁîüÊù°‰ª∂</th>
</tr>
</thead>
<tbody><tr>
<td>NEW</td>
<td>ÂàùÂßãÁä∂ÊÄÅÔºåÁ∫øÁ®ãÂàöË¢´ÂàõÂª∫Ôºå‰ΩÜÊòØÂπ∂Êú™ÂêØÂä®ÔºåËøòÊ≤°Ë∞ÉÁî® start ÊñπÊ≥ïÔºåÂè™ÊúâÁ∫øÁ®ãÂØπË±°ÔºåÊ≤°ÊúâÁ∫øÁ®ãÁâπÂæÅ</td>
</tr>
<tr>
<td>RUNNABLE</td>
<td>ËøêË°åÁä∂ÊÄÅÔºåÂåÖÂê´Â∞±Áª™ÂíåËøêË°å‰∏≠‰∏§ÁßçÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>BLOCKED</td>
<td>ÈòªÂ°ûÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>WAITING</td>
<td>Á≠âÂæÖÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>TIME_WAITING</td>
<td>Ë∂ÖÊó∂Á≠âÂæÖÁä∂ÊÄÅÔºåÂíåÁ≠âÂæÖÁä∂ÊÄÅ‰∏çÂêåÁöÑÊòØÔºåÂÆÉÂèØ‰ª•Âú®Âà∂ÂÆöÁöÑÊó∂Èó¥Ëá™Ë°åËøîÂõû</td>
</tr>
<tr>
<td>TERMINATED</td>
<td>ÁªàÊ≠¢Áä∂ÊÄÅÔºåÁ∫øÁ®ãËøêË°åÁªìÊùü</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><img src="https://img.jwt1399.top/img/202212281951644.png"></th>
<th><img src="https://img.jwt1399.top/img/202212281939521.png" alt="Á∫øÁ®ãÁä∂ÊÄÅËΩ¨ÁßªÂõæ"></th>
</tr>
</thead>
</table>
<h3 id="üåüÁ∫øÁ®ãÊ≠ªÈîÅÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºåÂ¶Ç‰ΩïÈÅøÂÖç"><a href="#üåüÁ∫øÁ®ãÊ≠ªÈîÅÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºåÂ¶Ç‰ΩïÈÅøÂÖç" class="headerlink" title="üåüÁ∫øÁ®ãÊ≠ªÈîÅÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºåÂ¶Ç‰ΩïÈÅøÂÖç"></a>üåüÁ∫øÁ®ãÊ≠ªÈîÅÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºåÂ¶Ç‰ΩïÈÅøÂÖç</h3><p>Ê≠ªÈîÅÔºöÁî±‰∫é‰∏§‰∏™Êàñ‰∏§‰∏™‰ª•‰∏äÁöÑÁ∫øÁ®ãÁõ∏‰∫íÁ´û‰∫âÂØπÊñπÁöÑËµÑÊ∫êÔºåËÄåÂêåÊó∂‰∏çÈáäÊîæËá™Â∑±ÁöÑËµÑÊ∫êÔºåÂØºËá¥ÊâÄÊúâÁ∫øÁ®ãÂêåÊó∂Ë¢´ÈòªÂ°û„ÄÇ</p>
<p>Ê≠ªÈîÅ‰∫ßÁîüÁöÑÊù°‰ª∂Ôºö</p>
<ul>
<li>  ‰∫íÊñ•Êù°‰ª∂Ôºö‰∏Ä‰∏™ËµÑÊ∫êÂú®Âêå‰∏ÄÊó∂ÂàªÂè™Áî±‰∏Ä‰∏™Á∫øÁ®ãÂç†Áî®„ÄÇ</li>
<li>  ËØ∑Ê±Ç‰∏é‰øùÊåÅÊù°‰ª∂Ôºö‰∏Ä‰∏™Á∫øÁ®ãÂú®ËØ∑Ê±ÇË¢´Âç†ËµÑÊ∫êÊó∂ÂèëÁîüÈòªÂ°ûÔºåÂπ∂ÂØπÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫ê‰øùÊåÅ‰∏çÊîæ„ÄÇ</li>
<li>  Âæ™ÁéØÁ≠âÂæÖÊù°‰ª∂ÔºöÂèëÁîüÊ≠ªÈîÅÊó∂ÔºåÊâÄÊúâÁöÑÁ∫øÁ®ã‰ºöÂΩ¢Êàê‰∏Ä‰∏™Ê≠ªÂæ™ÁéØÔºå‰∏ÄÁõ¥ÈòªÂ°û„ÄÇ</li>
<li>  ‰∏çÂâ•Â§∫Êù°‰ª∂ÔºöÁ∫øÁ®ãÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫êÂú®Êú™‰ΩøÁî®ÂÆå‰∏çËÉΩË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÂâ•Â§∫ÔºåÂè™ËÉΩÁî±Ëá™Â∑±‰ΩøÁî®ÂÆåÈáäÊîæËµÑÊ∫ê„ÄÇ</li>
</ul>
<p>ÈÅøÂÖçÊ≠ªÈîÅÁöÑÊñπÊ≥ï‰∏ªË¶ÅÊòØÁ†¥ÂùèÊ≠ªÈîÅ‰∫ßÁîüÁöÑÊù°‰ª∂„ÄÇ</p>
<ul>
<li>  Á†¥Âùè‰∫íÊñ•Êù°‰ª∂ÔºöËøô‰∏™Êù°‰ª∂Êó†Ê≥ïËøõË°åÁ†¥ÂùèÔºåÈîÅÁöÑ‰ΩúÁî®Â∞±ÊòØ‰Ωø‰ªñ‰ª¨‰∫íÊñ•„ÄÇ</li>
<li>  Á†¥ÂùèËØ∑Ê±Ç‰∏é‰øùÊåÅÊù°‰ª∂Ôºö‰∏ÄÊ¨°ÊÄßÁî≥ËØ∑ÊâÄÊúâÁöÑËµÑÊ∫ê„ÄÇ</li>
<li>  Á†¥ÂùèÂæ™ÁéØÁ≠âÂæÖÊù°‰ª∂ÔºöÊåâÈ°∫Â∫èÊù•Áî≥ËØ∑ËµÑÊ∫ê„ÄÇ</li>
<li>  Á†¥Âùè‰∏çÂâ•Â§∫Êù°‰ª∂ÔºöÁ∫øÁ®ãÂú®Áî≥ËØ∑‰∏çÂà∞ÊâÄÈúÄËµÑÊ∫êÊó∂Ôºå‰∏ªÂä®ÊîæÂºÉÊâÄÊåÅÊúâÁöÑËµÑÊ∫ê„ÄÇ</li>
</ul>
<h3 id="üåüÊ≠ªÈîÅ„ÄÅÊ¥ªÈîÅ„ÄÅÈ••È•øÊúâ‰ªÄ‰πàÂå∫Âà´Ôºü"><a href="#üåüÊ≠ªÈîÅ„ÄÅÊ¥ªÈîÅ„ÄÅÈ••È•øÊúâ‰ªÄ‰πàÂå∫Âà´Ôºü" class="headerlink" title="üåüÊ≠ªÈîÅ„ÄÅÊ¥ªÈîÅ„ÄÅÈ••È•øÊúâ‰ªÄ‰πàÂå∫Âà´Ôºü"></a>üåüÊ≠ªÈîÅ„ÄÅÊ¥ªÈîÅ„ÄÅÈ••È•øÊúâ‰ªÄ‰πàÂå∫Âà´Ôºü</h3><p>Ê¥ªÈîÅÔºö‰ªªÂä°ÊàñËÄÖÊâßË°åËÄÖÊ≤°ÊúâË¢´ÈòªÂ°ûÔºåÁî±‰∫éÊüê‰∫õÊù°‰ª∂Ê≤°ÊúâË¢´Êª°Ë∂≥ÔºåÂØºËá¥Á∫øÁ®ã‰∏ÄÁõ¥ÈáçÂ§çÂ∞ùËØï„ÄÅÂ§±Ë¥•„ÄÅÂ∞ùËØï„ÄÅÂ§±Ë¥•„ÄÇ</p>
<p>Ê¥ªÈîÅÂíåÊ≠ªÈîÅÁöÑÂå∫Âà´Ôºö</p>
<ul>
<li>  Ê¥ªÈîÅÊòØÂú®‰∏çÊñ≠Âú∞Â∞ùËØï„ÄÅÊ≠ªÈîÅÊòØÂú®‰∏ÄÁõ¥Á≠âÂæÖ„ÄÇ</li>
<li>  Ê¥ªÈîÅÊúâÂèØËÉΩËá™Ë°åËß£ÂºÄ„ÄÅÊ≠ªÈîÅÊó†Ê≥ïËá™Ë°åËß£ÂºÄ„ÄÇ</li>
</ul>
<p>È••È•øÔºö‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Á∫øÁ®ãÂõ†‰∏∫ÁßçÁßçÂéüÂõ†Êó†Ê≥ïËé∑ÂæóÊâÄÈúÄË¶ÅÁöÑËµÑÊ∫êÔºå ÂØºËá¥‰∏ÄÁõ¥Êó†Ê≥ïÊâßË°åÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<p>Ê≠ªÈîÅ„ÄÅÈ••È•øÁöÑÂå∫Âà´ÔºöÈ••È•øÂèØËá™Ë°åËß£ÂºÄÔºåÊ≠ªÈîÅ‰∏çË°å„ÄÇ</p>
<h2 id="‚ù∑‰ΩøÁî®"><a href="#‚ù∑‰ΩøÁî®" class="headerlink" title="‚ù∑‰ΩøÁî®"></a>‚ù∑‰ΩøÁî®</h2><h3 id="üåüÂàõÂª∫Á∫øÁ®ãÁöÑÂá†ÁßçÊñπÂºè"><a href="#üåüÂàõÂª∫Á∫øÁ®ãÁöÑÂá†ÁßçÊñπÂºè" class="headerlink" title="üåüÂàõÂª∫Á∫øÁ®ãÁöÑÂá†ÁßçÊñπÂºè"></a>üåüÂàõÂª∫Á∫øÁ®ãÁöÑÂá†ÁßçÊñπÂºè</h3><ol>
<li>ÁªßÊâø Thread Á±ªÂàõÂª∫Á∫øÁ®ãÔºõ</li>
<li>ÂÆûÁé∞ Runnable Êé•Âè£ÂàõÂª∫Á∫øÁ®ãÔºõ</li>
<li>ÈÄöËøá Callable Âíå Future ÂàõÂª∫Á∫øÁ®ãÔºõ</li>
<li>ÈÄöËøáÁ∫øÁ®ãÊ±†ÂàõÂª∫Á∫øÁ®ã„ÄÇ</li>
</ol>
<h3 id="üåürunnable-Âíå-callable-Êúâ‰ªÄ‰πàÂå∫Âà´"><a href="#üåürunnable-Âíå-callable-Êúâ‰ªÄ‰πàÂå∫Âà´" class="headerlink" title="üåürunnable Âíå callable Êúâ‰ªÄ‰πàÂå∫Âà´"></a>üåürunnable Âíå callable Êúâ‰ªÄ‰πàÂå∫Âà´</h3><ol>
<li>Runnable Êé•Âè£‰∏≠ÁöÑ run() ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÊòØ voidÔºåÂÆÉÂÅöÁöÑ‰∫ãÊÉÖÂè™ÊòØÁ∫ØÁ≤πÂú∞ÂéªÊâßË°å run() ÊñπÊ≥ï‰∏≠ÁöÑ‰ª£Á†ÅËÄåÂ∑≤Ôºõ</li>
<li>Callable Êé•Âè£‰∏≠ÁöÑ call() ÊñπÊ≥ïÊòØÊúâËøîÂõûÂÄºÁöÑÔºåÊòØ‰∏Ä‰∏™Ê≥õÂûãÔºåÂíå Future„ÄÅFutureTask ÈÖçÂêàÂèØ‰ª•Áî®Êù•Ëé∑ÂèñÂºÇÊ≠•ÊâßË°åÁöÑÁªìÊûú„ÄÇ</li>
</ol>
<h3 id="üåürun-Âíå-start-Êúâ‰ªÄ‰πàÂå∫Âà´"><a href="#üåürun-Âíå-start-Êúâ‰ªÄ‰πàÂå∫Âà´" class="headerlink" title="üåürun() Âíå start() Êúâ‰ªÄ‰πàÂå∫Âà´"></a>üåürun() Âíå start() Êúâ‰ªÄ‰πàÂå∫Âà´</h3><ul>
<li>  Á∫øÁ®ãÊòØÈÄöËøá<code>Thread</code>ÂØπË±°ÊâÄÂØπÂ∫îÁöÑÊñπÊ≥ï<code>run()</code>Êù•ÂÆåÊàêÂÖ∂Êìç‰ΩúÁöÑÔºåËÄåÁ∫øÁ®ãÁöÑÂêØÂä®ÊòØÈÄöËøá<code>start()</code>ÊñπÊ≥ïÊâßË°åÁöÑ„ÄÇ</li>
<li>  <code>run()</code>ÊñπÊ≥ïÂèØ‰ª•ÈáçÂ§çË∞ÉÁî®Ôºå<code>start()</code>ÊñπÊ≥ïÂè™ËÉΩË∞ÉÁî®‰∏ÄÊ¨°</li>
</ul>
<h3 id="üåüÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®-Thread-Á±ªÁöÑ-run-ÊñπÊ≥ïÂêó"><a href="#üåüÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®-Thread-Á±ªÁöÑ-run-ÊñπÊ≥ïÂêó" class="headerlink" title="üåüÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî® Thread Á±ªÁöÑ run ÊñπÊ≥ïÂêó"></a>üåüÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî® Thread Á±ªÁöÑ run ÊñπÊ≥ïÂêó</h3><blockquote>
<p>‰∏∫‰ªÄ‰πàË∞ÉÁî®start()ÊñπÊ≥ïÊó∂‰ºöÊâßË°årun()ÊñπÊ≥ïÔºåËÄå‰∏çÁõ¥Êé•ÊâßË°årun()ÊñπÊ≥ïÔºü</p>
</blockquote>
<p>ÁªìËÆ∫ÔºöË∞ÉÁî® <code>start()</code> ÊñπÊ≥ïÂèØÂêØÂä®Á∫øÁ®ãÂπ∂‰ΩøÁ∫øÁ®ãËøõÂÖ•Â∞±Áª™Áä∂ÊÄÅÔºåÁõ¥Êé•ÊâßË°å <code>run()</code> ÊñπÊ≥ïÁöÑËØù‰∏ç‰ºö‰ª•Â§öÁ∫øÁ®ãÁöÑÊñπÂºèÊâßË°åÔºåËÄåÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÁöÑ„ÄÇ</p>
<p>Ë∞ÉÁî® <code>start()</code>ÊñπÊ≥ïÔºå‰ºöÂêØÂä®‰∏Ä‰∏™Á∫øÁ®ãÔºåËøôÊó∂Á∫øÁ®ãÂ§Ñ‰∫éÂ∞±Áª™Áä∂ÊÄÅÔºåÂΩìÂàÜÈÖçÂà∞CPUÊó∂Èó¥ÁâáÂêéÔºåÂ∞±ÂºÄÂßãÊâßË°å<code>run()</code>ÊñπÊ≥ïÔºåÂÆÉÂåÖÂê´‰∫ÜË¶ÅÊâßË°åÁöÑËøô‰∏™Á∫øÁ®ãÁöÑÂÜÖÂÆπÔºåËøôÊòØÁúüÊ≠£ÁöÑÂ§öÁ∫øÁ®ãÂ∑•‰Ωú„ÄÇ </p>
<p>Áõ¥Êé•ÊâßË°å <code>run()</code> ÊñπÊ≥ïÔºå‰ºöÊää <code>run()</code> ÊñπÊ≥ïÂΩìÊàê‰∏Ä‰∏™ main Á∫øÁ®ã‰∏ãÁöÑÊôÆÈÄöÊñπÊ≥ïÂéªÊâßË°åÔºåÂπ∂‰∏ç‰ºöÂú®Êüê‰∏™Á∫øÁ®ã‰∏≠ÊâßË°åÂÆÉÔºåËøôÊ†∑Â∞±Ê≤°ÊúâËææÂà∞Â§öÁ∫øÁ®ãÁöÑÁõÆÁöÑ„ÄÇ</p>
<h3 id="üåüsleep-Âíå-wait-ÁöÑÂå∫Âà´"><a href="#üåüsleep-Âíå-wait-ÁöÑÂå∫Âà´" class="headerlink" title="üåüsleep() Âíå wait() ÁöÑÂå∫Âà´"></a>üåüsleep() Âíå wait() ÁöÑÂå∫Âà´</h3><blockquote>
<p>Thread.sleep()ÂíåObject.wait()ÁöÑÂå∫Âà´</p>
</blockquote>
<p><strong>ÂÖ±ÂêåÁÇπ</strong> Ôºö‰∏§ËÄÖÈÉΩÂèØ‰ª•ÊöÇÂÅúÁ∫øÁ®ãÁöÑÊâßË°å„ÄÇ</p>
<p><strong>Âå∫Âà´</strong> Ôºö</p>
<ul>
<li><code>sleep()</code> ‰∏ç‰ºöÈáäÊîæÂç†ÊúâÁöÑÈîÅÔºåËÄå <code>wait()</code> ‰ºöÈáäÊîæÂç†ÊúâÁöÑÈîÅ „ÄÇ</li>
<li><code>wait()</code> ÈÄöÂ∏∏Ë¢´Áî®‰∫éÁ∫øÁ®ãÈó¥‰∫§‰∫í/ÈÄö‰ø°Ôºå<code>sleep()</code>ÈÄöÂ∏∏Ë¢´Áî®‰∫éÊöÇÂÅúÊâßË°å„ÄÇ</li>
<li><code>wait()</code> ÊñπÊ≥ïË¢´Ë∞ÉÁî®ÂêéÔºåÁ∫øÁ®ã‰∏ç‰ºöËá™Âä®ËãèÈÜíÔºåÈúÄË¶ÅÂà´ÁöÑÁ∫øÁ®ãË∞ÉÁî®Âêå‰∏Ä‰∏™ÂØπË±°‰∏äÁöÑ <code>notify()</code>ÊàñËÄÖ <code>notifyAll()</code> ÊñπÊ≥ïÔºåÊàñËÄÖ‰ΩøÁî® <code>wait(long timeout)</code> Ë∂ÖÊó∂ÂêéÁ∫øÁ®ã‰ºöËá™Âä®ËãèÈÜí„ÄÇ<code>sleep()</code>ÊñπÊ≥ïÊâßË°åÂÆåÊàêÂêéÔºåÁ∫øÁ®ã‰ºöËá™Âä®ËãèÈÜí„ÄÇ</li>
<li><code>sleep()</code> ÊòØ <code>Thread</code> Á±ªÁöÑÈùôÊÄÅÊú¨Âú∞ÊñπÊ≥ïÔºå<code>wait()</code> ÂàôÊòØ <code>Object</code> Á±ªÁöÑÊú¨Âú∞ÊñπÊ≥ï„ÄÇ</li>
</ul>
<h3 id="üåüsleep-Âíå-yield-Êúâ‰ªÄ‰πà‰∏çÂêå"><a href="#üåüsleep-Âíå-yield-Êúâ‰ªÄ‰πà‰∏çÂêå" class="headerlink" title="üåüsleep() Âíå yield() Êúâ‰ªÄ‰πà‰∏çÂêå"></a>üåüsleep() Âíå yield() Êúâ‰ªÄ‰πà‰∏çÂêå</h3><ul>
<li>  <code>sleep()</code>ÊñπÊ≥ï‰ºö‰ΩøÂæóÂΩìÂâçÁ∫øÁ®ãÊöÇÂÅúÊåáÂÆöÁöÑÊó∂Èó¥ÔºåÊ≤°ÊúâÊ∂àËÄóCPUÊó∂Èó¥Áâá„ÄÇ</li>
<li>  <code>sleep()</code>‰∏ÄÂÆö‰ºöÂÆåÊàêÁªôÂÆöÁöÑ‰ºëÁú†Êó∂Èó¥Ôºå<code>yield()</code>‰∏ç‰∏ÄÂÆöËÉΩÂÆåÊàê„ÄÇ</li>
<li>  <code>sleep()</code>‰ΩøÂæóÁ∫øÁ®ãËøõÂÖ•Âà∞ÈòªÂ°ûÁä∂ÊÄÅÔºå<code>yield()</code>Âè™ÊòØÂØπCPUËøõË°åÊèêÁ§∫ÔºåÂ¶ÇÊûúCPUÊ≤°ÊúâÂøΩÁï•Ëøô‰∏™ÊèêÁ§∫Ôºå‰ºö‰ΩøÂæóÁ∫øÁ®ã‰∏ä‰∏ãÊñáÁöÑÂàáÊç¢ÔºåËøõÂÖ•Âà∞Â∞±Áª™Áä∂ÊÄÅ„ÄÇ</li>
<li>  <code>sleep()</code>ÈúÄË¶ÅÊäõÂá∫InterruptedExceptionÔºåËÄå<code>yield()</code>ÊñπÊ≥ïÊó†ÈúÄÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</li>
</ul>
<h3 id="üåü‰∏∫‰ªÄ‰πàwait-Ôºånotify-ÂøÖÈ°ªÂú®ÂêåÊ≠•ÊñπÊ≥ïÊàñËÄÖÂêåÊ≠•Âùó‰∏≠Ë¢´Ë∞ÉÁî®"><a href="#üåü‰∏∫‰ªÄ‰πàwait-Ôºånotify-ÂøÖÈ°ªÂú®ÂêåÊ≠•ÊñπÊ≥ïÊàñËÄÖÂêåÊ≠•Âùó‰∏≠Ë¢´Ë∞ÉÁî®" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàwait()Ôºånotify()ÂøÖÈ°ªÂú®ÂêåÊ≠•ÊñπÊ≥ïÊàñËÄÖÂêåÊ≠•Âùó‰∏≠Ë¢´Ë∞ÉÁî®"></a>üåü‰∏∫‰ªÄ‰πàwait()Ôºånotify()ÂøÖÈ°ªÂú®ÂêåÊ≠•ÊñπÊ≥ïÊàñËÄÖÂêåÊ≠•Âùó‰∏≠Ë¢´Ë∞ÉÁî®</h3><p>Âõ†‰∏∫wait()ÊöÇÂÅúÁöÑÊòØÊåÅÊúâÈîÅÁöÑÂØπË±°Ôºånotify()ÊàñnotifyAll()Âî§ÈÜíÁöÑÊòØÁ≠âÂæÖÈîÅÁöÑÂØπË±°„ÄÇ</p>
<p>ÊâÄ‰ª•wait()„ÄÅnotify()„ÄÅnotifyAll()ÈÉΩÈúÄË¶ÅÁ∫øÁ®ãÊåÅÊúâÈîÅÁöÑÂØπË±°ÔºåËøõËÄåÈúÄË¶ÅÂú®ÂêåÊ≠•ÊñπÊ≥ïÊàñËÄÖÂêåÊ≠•Âùó‰∏≠Ë¢´Ë∞ÉÁî®„ÄÇ</p>
<h3 id="üåü‰∏∫‰ªÄ‰πàwait-„ÄÅnotify-„ÄÅnotifyAll-Ë¢´ÂÆö‰πâÂú®ObjectÁ±ª‰∏≠ËÄå‰∏çÊòØÂú®ThreadÁ±ª‰∏≠"><a href="#üåü‰∏∫‰ªÄ‰πàwait-„ÄÅnotify-„ÄÅnotifyAll-Ë¢´ÂÆö‰πâÂú®ObjectÁ±ª‰∏≠ËÄå‰∏çÊòØÂú®ThreadÁ±ª‰∏≠" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàwait()„ÄÅnotify()„ÄÅnotifyAll()Ë¢´ÂÆö‰πâÂú®ObjectÁ±ª‰∏≠ËÄå‰∏çÊòØÂú®ThreadÁ±ª‰∏≠"></a>üåü‰∏∫‰ªÄ‰πàwait()„ÄÅnotify()„ÄÅnotifyAll()Ë¢´ÂÆö‰πâÂú®ObjectÁ±ª‰∏≠ËÄå‰∏çÊòØÂú®ThreadÁ±ª‰∏≠</h3><p>Á≠âÂæÖÂíåÂî§ÈÜíÂøÖÈ°ªÊòØÂêå‰∏ÄÈîÅ„ÄÇËÄåÈîÅÂèØ‰ª•ÊòØ‰ªªÊÑèÂØπË±°ÔºåÊâÄ‰ª•ÂèØ‰ª•Ë¢´‰ªªÊÑèÂØπË±°Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÂÆö‰πâÂú®ObjectÁ±ª‰∏≠„ÄÇ</p>
<h3 id="üåüJavaÂ¶Ç‰ΩïÂÆûÁé∞‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÈÄö‰ø°ÂíåÂçè‰Ωú"><a href="#üåüJavaÂ¶Ç‰ΩïÂÆûÁé∞‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÈÄö‰ø°ÂíåÂçè‰Ωú" class="headerlink" title="üåüJavaÂ¶Ç‰ΩïÂÆûÁé∞‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÈÄö‰ø°ÂíåÂçè‰Ωú"></a>üåüJavaÂ¶Ç‰ΩïÂÆûÁé∞‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÈÄö‰ø°ÂíåÂçè‰Ωú</h3><ul>
<li>  <code>syncrhoized</code>Âä†ÈîÅÁöÑÁ∫øÁ®ãÁöÑ<code>Object</code>Á±ªÁöÑ<code>wait()</code>/<code>notify()</code>/<code>notifyAll()</code></li>
<li>  ‰ΩøÁî® <code>volatile</code> ÂÖ≥ÈîÆÂ≠ó„ÄÇÂü∫‰∫évolatileÂÖ≥ÈîÆÂ≠óÂÆûÁé∞Á∫øÁ®ãÈó¥Áõ∏‰∫íÈÄö‰ø°ÔºåÂÖ∂Â∫ïÂ±Ç‰ΩøÁî®‰∫ÜÂÖ±‰∫´ÂÜÖÂ≠ò„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåÂ∞±ÊòØÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ÁõëÂê¨‰∏Ä‰∏™ÂèòÈáèÔºåÂΩìËøô‰∏™ÂèòÈáèÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄô ÔºåÁ∫øÁ®ãËÉΩÂ§üÊÑüÁü•Âπ∂ÊâßË°åÁõ∏Â∫îÁöÑ‰∏öÂä°„ÄÇ</li>
<li>  <code>ReentrantLock</code>Á±ªÂä†ÈîÅÁöÑÁ∫øÁ®ãÁöÑ<code>Condition</code>Á±ªÁöÑ<code>await()</code>/<code>signal()</code>/<code>signalAll()</code></li>
<li>  Âü∫‰∫é <code>LockSupport</code> ÂÆûÁé∞Á∫øÁ®ãÈó¥ÁöÑÈòªÂ°ûÂíåÂî§ÈÜí„ÄÇ<code>LockSupport</code> ÊòØ‰∏ÄÁßçÈùûÂ∏∏ÁÅµÊ¥ªÁöÑÂÆûÁé∞Á∫øÁ®ãÈó¥ÈòªÂ°ûÂíåÂî§ÈÜíÁöÑÂ∑•ÂÖ∑Ôºå‰ΩøÁî®ÂÆÉ‰∏çÁî®ÂÖ≥Ê≥®ÊòØÁ≠âÂæÖÁ∫øÁ®ãÂÖàËøõË°åËøòÊòØÂî§ÈÜíÁ∫øÁ®ãÂÖàËøêË°åÔºå‰ΩÜÊòØÂæóÁü•ÈÅìÁ∫øÁ®ãÁöÑÂêçÂ≠ó„ÄÇ</li>
<li>  ‰ΩøÁî®JUCÂ∑•ÂÖ∑Á±ª <code>CountDownLatch</code>„ÄÇjdk1.5 ‰πãÂêéÂú®<code>java.util.concurrent</code>ÂåÖ‰∏ãÊèê‰æõ‰∫ÜÂæàÂ§öÂπ∂ÂèëÁºñÁ®ãÁõ∏ÂÖ≥ÁöÑÂ∑•ÂÖ∑Á±ªÔºåÁÆÄÂåñ‰∫ÜÂπ∂ÂèëÁºñÁ®ãÂºÄÂèëÔºå<code>CountDownLatch</code> Âü∫‰∫é AQS Ê°ÜÊû∂ÔºåÁõ∏ÂΩì‰∫é‰πüÊòØÁª¥Êä§‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÈó¥ÂÖ±‰∫´ÂèòÈáè state„ÄÇ</li>
<li>  ÈÄöËøáÁÆ°ÈÅìËøõË°åÁ∫øÁ®ãÈó¥ÈÄö‰ø°Ôºö1ÔºâÂ≠óËäÇÊµÅÔºõ2ÔºâÂ≠óÁ¨¶ÊµÅ ÔºåÂ∞±ÊòØ‰∏Ä‰∏™Á∫øÁ®ãÂèëÈÄÅÊï∞ÊçÆÂà∞ËæìÂá∫ÁÆ°ÈÅìÔºåÂè¶‰∏Ä‰∏™Á∫øÁ®ã‰ªéËæìÂÖ•ÁÆ°ÈÅìËØªÊï∞ÊçÆ„ÄÇ</li>
</ul>
<h3 id="üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÂêåÊ≠•Ôºü‰ªÄ‰πàÊòØÁ∫øÁ®ã‰∫íÊñ•ÔºüÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü"><a href="#üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÂêåÊ≠•Ôºü‰ªÄ‰πàÊòØÁ∫øÁ®ã‰∫íÊñ•ÔºüÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÂêåÊ≠•Ôºü‰ªÄ‰πàÊòØÁ∫øÁ®ã‰∫íÊñ•ÔºüÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü"></a>üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÂêåÊ≠•Ôºü‰ªÄ‰πàÊòØÁ∫øÁ®ã‰∫íÊñ•ÔºüÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü</h3><p>Á∫øÁ®ã‰∫íÊñ•ÊòØÊåáÊüê‰∏Ä‰∏™ËµÑÊ∫êÂè™ËÉΩË¢´‰∏Ä‰∏™ËÆøÈóÆËÄÖËÆøÈóÆÔºåÂÖ∑ÊúâÂîØ‰∏ÄÊÄßÂíåÊéí‰ªñÊÄß„ÄÇ‰ΩÜËÆøÈóÆËÄÖÂØπËµÑÊ∫êËÆøÈóÆÁöÑÈ°∫Â∫èÊòØ‰π±Â∫èÁöÑ„ÄÇ </p>
<p>Á∫øÁ®ãÂêåÊ≠•ÊòØÊåáÂú®‰∫íÊñ•ÁöÑÂü∫Á°Ä‰∏ä‰ΩøÂæóËÆøÈóÆËÄÖÂØπËµÑÊ∫êËøõË°åÊúâÂ∫èËÆøÈóÆ„ÄÇ ÈúÄË¶ÅÁ≠âÂæÖÂâçÈù¢ÁªìÊûúËøîÂõûÔºåÊâçËÉΩÁªßÁª≠ËøêË°å</p>
<p>Á∫øÁ®ãÂêåÊ≠•ÁöÑÂÆûÁé∞ÊñπÊ≥ïÔºö </p>
<ul>
<li>  ÂêåÊ≠•ÊñπÊ≥ï</li>
<li>  ÂêåÊ≠•‰ª£Á†ÅÂùó</li>
<li>  <code>wait()</code>Âíå<code>notify()</code></li>
<li>  ‰ΩøÁî®volatileÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•</li>
<li>  ‰ΩøÁî®ÈáçÂÖ•ÈîÅÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•</li>
<li>  ‰ΩøÁî®Â±ÄÈÉ®ÂèòÈáèÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•</li>
<li>  ‰ΩøÁî®ÈòªÂ°ûÈòüÂàóÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•</li>
</ul>
<h3 id="üåüÂ¶Ç‰Ωï‰øùËØÅÁ∫øÁ®ãÁöÑËøêË°åÂÆâÂÖ®"><a href="#üåüÂ¶Ç‰Ωï‰øùËØÅÁ∫øÁ®ãÁöÑËøêË°åÂÆâÂÖ®" class="headerlink" title="üåüÂ¶Ç‰Ωï‰øùËØÅÁ∫øÁ®ãÁöÑËøêË°åÂÆâÂÖ®"></a>üåüÂ¶Ç‰Ωï‰øùËØÅÁ∫øÁ®ãÁöÑËøêË°åÂÆâÂÖ®</h3><p>Á∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢ò‰∏ªË¶Å‰ΩìÁé∞Âú®ÂéüÂ≠êÊÄß„ÄÅÂèØËßÅÊÄßÂíåÊúâÂ∫èÊÄß„ÄÇ</p>
<ul>
<li>  ÂéüÂ≠êÊÄßÔºö‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Êìç‰ΩúÂú® CPU ÊâßË°åÁöÑËøáÁ®ã‰∏≠‰∏çË¢´‰∏≠Êñ≠ÁöÑÁâπÊÄß„ÄÇÁ∫øÁ®ãÂàáÊç¢Â∏¶Êù•ÁöÑÂéüÂ≠êÊÄßÈóÆÈ¢ò„ÄÇ</li>
<li>  ÂèØËßÅÊÄßÔºö‰∏Ä‰∏™Á∫øÁ®ãÂØπÂÖ±‰∫´ÂèòÈáèÁöÑ‰øÆÊîπÔºåÂè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãËÉΩÂ§üÁ´ãÂàªÁúãÂà∞„ÄÇÁºìÂ≠òÂØºËá¥ÁöÑÂèØËßÅÊÄßÈóÆÈ¢ò„ÄÇ</li>
<li>  ÊúâÂ∫èÊÄßÔºöÁ®ãÂ∫èÊâßË°åÁöÑÈ°∫Â∫èÊåâÁÖß‰ª£Á†ÅÁöÑÂÖàÂêéÈ°∫Â∫èÊâßË°å„ÄÇÁºñËØë‰ºòÂåñÂ∏¶Êù•ÁöÑÊúâÂ∫èÊÄßÈóÆÈ¢ò„ÄÇ</li>
</ul>
<p>Ëß£ÂÜ≥ÊñπÊ≥ïÔºö</p>
<ul>
<li>  ÂéüÂ≠êÊÄßÈóÆÈ¢òÔºöÂèØÁî®JDK <code>Atomic</code>ÂºÄÂ§¥ÁöÑÂéüÂ≠êÁ±ª„ÄÅ<code>synchronized</code>„ÄÅ<code>LOCK</code>Êù•Ëß£ÂÜ≥</li>
<li>  ÂèØËßÅÊÄßÈóÆÈ¢òÔºöÂèØÁî®<code>synchronized</code>„ÄÅ<code>volatile</code>„ÄÅ<code>LOCK</code>Êù•Ëß£ÂÜ≥</li>
<li>  ÊúâÂ∫èÊÄßÈóÆÈ¢òÔºöÂèØÁî®<code>Happens-Before</code> ËßÑÂàôÊù•Ëß£ÂÜ≥</li>
</ul>
<h3 id="üåüÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÂÆûÁé∞ÊñπÊ≥ï"><a href="#üåüÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÂÆûÁé∞ÊñπÊ≥ï" class="headerlink" title="üåüÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÂÆûÁé∞ÊñπÊ≥ï"></a>üåüÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÂÆûÁé∞ÊñπÊ≥ï</h3><ul>
<li>‰∫íÊñ•ÂêåÊ≠•Ôºösynchronized Ôºå ReentrantLock</li>
<li>ÈùûÈòªÂ°ûÂêåÊ≠•ÔºöCASÔºåAtomicÁ±ª</li>
<li>Êó†ÂêåÊ≠•ÊñπÊ°àÔºöÊ†àÂ∞ÅÈó≠ÔºåÊú¨Âú∞Â≠òÂÇ®(ThreadLocal)ÔºåÂèØÈáçÂÖ•‰ª£Á†Å</li>
</ul>
<h3 id="üåüÂ¶Ç‰ΩïÂÅúÊ≠¢‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ã"><a href="#üåüÂ¶Ç‰ΩïÂÅúÊ≠¢‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ã" class="headerlink" title="üåüÂ¶Ç‰ΩïÂÅúÊ≠¢‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ã"></a>üåüÂ¶Ç‰ΩïÂÅúÊ≠¢‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ã</h3><ul>
<li>  ‰∏≠Êñ≠Ôºö<code>Interrupt</code>ÊñπÊ≥ï‰∏≠Êñ≠Á∫øÁ®ã</li>
<li>  ‰ΩøÁî®<code>volatile boolean</code>Ê†áÂøó‰ΩçÂÅúÊ≠¢Á∫øÁ®ãÔºöÂú®Á∫øÁ®ã‰∏≠ËÆæÁΩÆ‰∏Ä‰∏™<code>boolean</code>Ê†áÂøó‰ΩçÔºåÂêåÊó∂Áî®<code>volatile</code>‰øÆÈ•∞‰øùËØÅÂèØËßÅÊÄßÔºåÂú®Á∫øÁ®ãÈáå‰∏çÊñ≠Âú∞ËØªÂèñËøô‰∏™ÂÄºÔºåÂÖ∂‰ªñÂú∞ÊñπÂèØ‰ª•‰øÆÊîπËøô‰∏™<code>boolean</code>ÂÄº„ÄÇ</li>
<li>  ‰ΩøÁî®<code>stop()</code>ÊñπÊ≥ïÂÅúÊ≠¢Á∫øÁ®ãÔºå‰ΩÜËØ•ÊñπÊ≥ïÂ∑≤ÁªèË¢´Â∫üÂºÉ„ÄÇÂõ†‰∏∫ËøôÊ†∑Á∫øÁ®ã‰∏çËÉΩÂú®ÂÅúÊ≠¢Ââç‰øùÂ≠òÊï∞ÊçÆÔºå‰ºöÂá∫Áé∞Êï∞ÊçÆÂÆåÊï¥ÊÄßÈóÆÈ¢ò„ÄÇ</li>
</ul>
<h3 id="üåüËØ¥‰∏ã‰Ω†ÂØπ-Java-ÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÁöÑÁêÜËß£Ôºü"><a href="#üåüËØ¥‰∏ã‰Ω†ÂØπ-Java-ÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÁöÑÁêÜËß£Ôºü" class="headerlink" title="üåüËØ¥‰∏ã‰Ω†ÂØπ Java ÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÁöÑÁêÜËß£Ôºü"></a>üåüËØ¥‰∏ã‰Ω†ÂØπ Java ÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÁöÑÁêÜËß£Ôºü</h3><blockquote>
<p>Â§ÑÁêÜÂô®ÂíåÂÜÖÂ≠ò‰∏çÊòØÂêåÊï∞ÈáèÁ∫ßÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®‰∏≠Èó¥Âª∫Á´ã‰∏≠Èó¥Â±ÇÔºå‰πüÂ∞±ÊòØÈ´òÈÄüÁºìÂ≠òÔºåËøô‰ºöÂºïÂá∫ÁºìÂ≠ò‰∏ÄËá¥ÊÄßÈóÆÈ¢ò„ÄÇÂú®Â§öÂ§ÑÁêÜÂô®Á≥ªÁªü‰∏≠ÔºåÊØè‰∏™Â§ÑÁêÜÂô®ÈÉΩÊúâËá™Â∑±ÁöÑÈ´òÈÄüÁºìÂ≠òÔºåËÄåÂÆÉ‰ª¨ÂèàÂÖ±‰∫´Âêå‰∏Ä‰∏ªÂÜÖÂ≠òÔºàMain MemoryÔºâÔºåÊúâÂèØËÉΩÊìç‰ΩúÂêå‰∏Ä‰ΩçÁΩÆÂºïËµ∑ÂêÑËá™ÁºìÂ≠ò‰∏ç‰∏ÄËá¥ÔºåËøôÊó∂ÂÄôÈúÄË¶ÅÁ∫¶ÂÆöÂçèËÆÆÂú®‰øùËØÅ‰∏ÄËá¥ÊÄß„ÄÇ</p>
</blockquote>
<p>Java ÂÜÖÂ≠òÊ®°Âûã(Java Memory ModelÔºåJMM)ÔºöÂ±èËîΩÊéâ‰∫ÜÂêÑÁßçÁ°¨‰ª∂ÂíåÊìç‰ΩúÁ≥ªÁªüÁöÑÂÜÖÂ≠òËÆøÈóÆÂ∑ÆÂºÇÔºå‰ª•ÂÆûÁé∞ËÆ© Java Á®ãÂ∫èÂú®ÂêÑÁßçÂπ≥Âè∞‰∏ãÈÉΩËÉΩËææÂà∞‰∏ÄËá¥ÊÄßÁöÑÂÜÖÂ≠òËÆøÈóÆÊïàÊûú</p>
<p><strong>‰∏ªÂÜÖÂ≠ò‰∏éÂ∑•‰ΩúÂÜÖÂ≠ò</strong></p>
<p>Java ÂÜÖÂ≠òÊ®°ÂûãÁöÑ‰∏ªË¶ÅÁõÆÊ†áÊòØÂÆö‰πâÁ®ãÂ∫è‰∏≠ÂêÑ‰∏™ÂèòÈáèÁöÑËÆøÈóÆËßÑÂàôÔºåÂç≥Âú®ËôöÊãüÊú∫‰∏≠Â∞ÜÂèòÈáèÂ≠òÂÇ®Âà∞ÂÜÖÂ≠òÂíå‰ªéÂÜÖÂ≠ò‰∏≠ÂèñÂá∫ÂèòÈáèËøôÊ†∑ÁöÑÂ∫ïÂ±ÇÁªÜËäÇ„ÄÇ</p>
<p>Java ÂÜÖÂ≠òÊ®°ÂûãËßÑÂÆö‰∫ÜÊâÄÊúâÁöÑÂèòÈáèÈÉΩÂ≠òÂÇ®Âú®‰∏ªÂÜÖÂ≠òÔºàMain MemoryÔºâ‰∏≠ÔºåÊØè‰∏™Á∫øÁ®ãÊúâËá™Â∑±ÁöÑÂ∑•‰ΩúÂÜÖÂ≠òÔºàWorking MemoryÔºâÔºå‰øùÂ≠ò‰∏ªÂÜÖÂ≠òÂâØÊú¨ÂíåËá™Â∑±ÁßÅÊúâÂèòÈáèÔºå‰∏çÂêåÁ∫øÁ®ã‰∏çËÉΩËÆøÈóÆÂ∑•‰ΩúÂÜÖÂ≠ò‰∏≠ÁöÑÂèòÈáè„ÄÇÁ∫øÁ®ãÈó¥ÂèòÈáèÂÄºÁöÑ‰º†ÈÄíÈúÄË¶ÅÈÄöËøá‰∏ªÂÜÖÂ≠òÊù•ÂÆåÊàê„ÄÇ</p>
<h1 id="‚ë°ÂÖ≥ÈîÆÂ≠ó"><a href="#‚ë°ÂÖ≥ÈîÆÂ≠ó" class="headerlink" title="‚ë°ÂÖ≥ÈîÆÂ≠ó"></a>‚ë°ÂÖ≥ÈîÆÂ≠ó</h1><h2 id="‚ù∂synchronized"><a href="#‚ù∂synchronized" class="headerlink" title="‚ù∂synchronized"></a>‚ù∂synchronized</h2><p>synchronizedËß£ÂÜ≥ÁöÑÊòØÂ§ö‰∏™Á∫øÁ®ã‰πãÈó¥ËÆøÈóÆËµÑÊ∫êÁöÑÂêåÊ≠•ÊÄßÔºåsynchronizedÂèØ‰ª•‰øùËØÅË¢´ÂÆÉ‰øÆÈ•∞ÁöÑÊñπÊ≥ïÊàñËÄÖ‰ª£Á†ÅÂùóÂú®‰ªªÊÑèÊó∂ÂàªÂè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãÊâßË°å„ÄÇ</p>
<h3 id="üåüsynchronizedÁöÑÁî®Ê≥ïÊúâÂì™‰∫õ"><a href="#üåüsynchronizedÁöÑÁî®Ê≥ïÊúâÂì™‰∫õ" class="headerlink" title="üåüsynchronizedÁöÑÁî®Ê≥ïÊúâÂì™‰∫õ?"></a>üåüsynchronizedÁöÑÁî®Ê≥ïÊúâÂì™‰∫õ?</h3><blockquote>
<p>Â¶Ç‰ΩïÂú®È°πÁõÆ‰∏≠‰ΩøÁî® synchronized ÁöÑÔºü</p>
<p>synchronizedÂÖ≥ÈîÆÂ≠óÁöÑ‰ΩøÁî®ÊñπÊ≥ï?</p>
</blockquote>
<ol>
<li><strong>‰øÆÈ•∞ÊôÆÈÄöÊñπÊ≥ï</strong>Ôºö‰ΩúÁî®‰∫éÂΩìÂâçÂØπË±°ÂÆû‰æãÔºåËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂâçË¶ÅËé∑ÂæóÂΩìÂâçÂØπË±°ÂÆû‰æãÁöÑÈîÅ</li>
<li><strong>‰øÆÈ•∞ÈùôÊÄÅÊñπÊ≥ï</strong>Ôºö‰ΩúÁî®‰∫éÂΩìÂâçÁ±ªÔºåËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂâçË¶ÅËé∑ÂæóÂΩìÂâçÁ±ªÂØπË±°ÁöÑÈîÅÔºåsynchronizedÂÖ≥ÈîÆÂ≠óÂä†Âà∞static ÈùôÊÄÅÊñπÊ≥ïÂíå synchronized(class)‰ª£Á†ÅÂùó‰∏äÈÉΩÊòØÊòØÁªô Class Á±ª‰∏äÈîÅ</li>
<li><strong>‰øÆÈ•∞‰ª£Á†ÅÂùó</strong>ÔºöÊåáÂÆöÂä†ÈîÅÂØπË±°ÔºåÂØπÁªôÂÆöÂØπË±°Âä†ÈîÅÔºåËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂùóÂâçË¶ÅËé∑ÂæóÁªôÂÆöÂØπË±°ÁöÑÈîÅ</li>
</ol>
<h3 id="üåüsynchronized‰∏âÂ§ßÁâπÊÄßÊòØ‰ªÄ‰πàÔºü"><a href="#üåüsynchronized‰∏âÂ§ßÁâπÊÄßÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüsynchronized‰∏âÂ§ßÁâπÊÄßÊòØ‰ªÄ‰πàÔºü"></a>üåüsynchronized‰∏âÂ§ßÁâπÊÄßÊòØ‰ªÄ‰πàÔºü</h3><blockquote>
<p>synchronizedÁöÑ‰ΩúÁî®ÊúâÂì™‰∫õ</p>
<p>ÂèØËßÅÊÄßÂíåÂéüÂ≠êÊÄßÊúâ‰ªÄ‰πàÂå∫Âà´</p>
</blockquote>
<p><strong>ÂéüÂ≠êÊÄß</strong>Ôºö‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êìç‰ΩúË¶Å‰πàÂÖ®ÈÉ®ÊâßË°åÊàêÂäüÔºåË¶Å‰πàÂÖ®ÈÉ®ÊâßË°åÂ§±Ë¥•„ÄÇÁ°Æ‰øùÁ∫øÁ®ã‰∫íÊñ•ÁöÑËÆøÈóÆÂêåÊ≠•‰ª£Á†ÅÔºõ</p>
<p><strong>ÂèØËßÅÊÄß</strong>ÔºöÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂØπÂÖ±‰∫´ÂèòÈáèËøõË°å‰øÆÊîπÂêéÔºåÂÖ∂‰ªñÁ∫øÁ®ãÂèØ‰ª•Á´ãÂàªÁúãÂà∞„ÄÇ‰øùËØÅÂÖ±‰∫´ÂèòÈáèÁöÑ‰øÆÊîπËÉΩÂ§üÂèäÊó∂ÂèØËßÅÔºõ</p>
<p><strong>ÊúâÂ∫èÊÄß</strong>ÔºöÁ®ãÂ∫èÁöÑÊâßË°åÈ°∫Â∫è‰ºöÊåâÁÖß‰ª£Á†ÅÁöÑÂÖàÂêéÈ°∫Â∫èÊâßË°å„ÄÇÊúâÊïàËß£ÂÜ≥ÈáçÊéíÂ∫èÈóÆÈ¢ò„ÄÇ</p>
<h3 id="üåüsynchronizedÂèØÂÆûÁé∞‰ªÄ‰πàÁ±ªÂûãÁöÑÈîÅÔºü"><a href="#üåüsynchronizedÂèØÂÆûÁé∞‰ªÄ‰πàÁ±ªÂûãÁöÑÈîÅÔºü" class="headerlink" title="üåüsynchronizedÂèØÂÆûÁé∞‰ªÄ‰πàÁ±ªÂûãÁöÑÈîÅÔºü"></a>üåüsynchronizedÂèØÂÆûÁé∞‰ªÄ‰πàÁ±ªÂûãÁöÑÈîÅÔºü</h3><p><strong>ÊÇ≤ËßÇÈîÅ</strong>ÔºösynchronizedÂÖ≥ÈîÆÂ≠óÂÆûÁé∞ÁöÑÊòØÊÇ≤ËßÇÈîÅÔºåÊØèÊ¨°ËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÊó∂ÈÉΩ‰ºö‰∏äÈîÅ„ÄÇ</p>
<p><strong>ÈùûÂÖ¨Âπ≥ÈîÅ</strong>ÔºösynchronizedÂÖ≥ÈîÆÂ≠óÂÆûÁé∞ÁöÑÊòØÈùûÂÖ¨Âπ≥ÈîÅÔºåÂç≥Á∫øÁ®ãËé∑ÂèñÈîÅÁöÑÈ°∫Â∫èÂπ∂‰∏ç‰∏ÄÂÆöÊòØÊåâÁÖßÁ∫øÁ®ãÈòªÂ°ûÁöÑÈ°∫Â∫è„ÄÇ</p>
<p><strong>ÂèØÈáçÂÖ•ÈîÅ</strong>ÔºösynchronizedÂÖ≥ÈîÆÂ≠óÂÆûÁé∞ÁöÑÊòØÂèØÈáçÂÖ•ÈîÅÔºåÂç≥Â∑≤ÁªèËé∑ÂèñÈîÅÁöÑÁ∫øÁ®ãÂèØ‰ª•ÂÜçÊ¨°Ëé∑ÂèñÈîÅ„ÄÇ</p>
<p><strong>Áã¨Âç†ÈîÅÊàñËÄÖÊéí‰ªñÈîÅ</strong>ÔºösynchronizedÂÖ≥ÈîÆÂ≠óÂÆûÁé∞ÁöÑÊòØÁã¨Âç†ÈîÅÔºåÂç≥ËØ•ÈîÅÂè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãÊâÄÊåÅÊúâÔºåÂÖ∂‰ªñÁ∫øÁ®ãÂùáË¢´ÈòªÂ°û„ÄÇ</p>
<h3 id="üåüsynchronized-Â∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜÔºü"><a href="#üåüsynchronized-Â∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜÔºü" class="headerlink" title="üåüsynchronized Â∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜÔºü"></a>üåüsynchronized Â∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜÔºü</h3><p>synchronized ÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂÆûÁé∞ÊòØÈÄöËøá <code>monitorenter</code> Âíå <code>monitorexit</code> Êåá‰ª§Ôºå</p>
<ul>
<li> <code>monitorenter</code> Êåá‰ª§ÊåáÂêëÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂºÄÂßã‰ΩçÁΩÆÔºå</li>
<li> <code>monitorexit</code> Êåá‰ª§ÂàôÊåáÊòéÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÁªìÊùü‰ΩçÁΩÆ„ÄÇ</li>
</ul>
<p>ÂΩìÊâßË°å <code>monitorenter</code> Êåá‰ª§Êó∂ÔºåÁ∫øÁ®ãËØïÂõæËé∑ÂèñÈîÅ‰πüÂ∞±ÊòØËé∑Âèñ <code>monitor</code>ÁöÑÊåÅÊúâÊùÉÔºàmonitorÂØπË±°Â≠òÂú®‰∫éÊØè‰∏™JavaÂØπË±°ÁöÑÂØπË±°Â§¥‰∏≠Ôºå synchronized ÈîÅ‰æøÊòØÈÄöËøáËøôÁßçÊñπÂºèËé∑ÂèñÈîÅÁöÑÔºå‰πüÊòØ‰∏∫‰ªÄ‰πàJava‰∏≠‰ªªÊÑèÂØπË±°ÂèØ‰ª•‰Ωú‰∏∫ÈîÅÁöÑÂéüÂõ†Ôºâ„ÄÇÂÖ∂ÂÜÖÈÉ®ÂåÖÂê´‰∏Ä‰∏™ËÆ°Êï∞Âô®ÔºåÂΩìËÆ°Êï∞Âô®‰∏∫0ÂàôÂèØ‰ª•ÊàêÂäüËé∑ÂèñÔºåËé∑ÂèñÂêéÂ∞ÜÈîÅËÆ°Êï∞Âô®ËÆæ‰∏∫1‰πüÂ∞±ÊòØÂä†1„ÄÇÁõ∏Â∫îÁöÑÂú®ÊâßË°å <code>monitorexit</code> Êåá‰ª§ÂêéÔºåÂ∞ÜÈîÅËÆ°Êï∞Âô®ËÆæ‰∏∫0 ÔºåË°®ÊòéÈîÅË¢´ÈáäÊîæ„ÄÇÂ¶ÇÊûúËé∑ÂèñÂØπË±°ÈîÅÂ§±Ë¥•ÔºåÈÇ£ÂΩìÂâçÁ∫øÁ®ãÂ∞±Ë¶ÅÈòªÂ°ûÁ≠âÂæÖÔºåÁõ¥Âà∞ÈîÅË¢´Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÈáäÊîæ‰∏∫Ê≠¢</p>
<p>synchronized ‰øÆÈ•∞ÁöÑÊñπÊ≥ïÂπ∂Ê≤°Êúâ <code>monitorenter</code> Êåá‰ª§Âíå <code>monitorexit</code> Êåá‰ª§ÔºåÂèñÂæó‰ª£‰πãÁöÑÁ°ÆÂÆûÊòØ<code>ACC_SYNCHRONIZED</code> Ê†áËØÜÔºåËØ•Ê†áËØÜÊåáÊòé‰∫ÜËØ•ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÂêåÊ≠•ÊñπÊ≥ïÔºåJVM ÈÄöËøáËØ• <code>ACC_SYNCHRONIZED</code> ËÆøÈóÆÊ†áÂøóÊù•Ëæ®Âà´‰∏Ä‰∏™ÊñπÊ≥ïÊòØÂê¶Â£∞Êòé‰∏∫ÂêåÊ≠•ÊñπÊ≥ïÔºå‰ªéËÄåÊâßË°åÁõ∏Â∫îÁöÑÂêåÊ≠•Ë∞ÉÁî®„ÄÇ</p>
<h3 id="üåüJDK1-6ÂêésynchronizedÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñ"><a href="#üåüJDK1-6ÂêésynchronizedÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñ" class="headerlink" title="üåüJDK1.6ÂêésynchronizedÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñ"></a>üåüJDK1.6ÂêésynchronizedÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñ</h3><p>JDK1.6 ÂØπÈîÅÁöÑÂÆûÁé∞ÂºïÂÖ•‰∫ÜÂ§ßÈáèÁöÑ‰ºòÂåñÔºåÂ¶ÇÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅËá™ÊóãÈîÅ„ÄÅÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ„ÄÅÈîÅÊ∂àÈô§„ÄÅÈîÅÁ≤óÂåñÁ≠âÊäÄÊúØÊù•ÂáèÂ∞ëÈîÅÊìç‰ΩúÁöÑÂºÄÈîÄ„ÄÇ</p>
<p>ÈîÅ‰∏ªË¶ÅÂ≠òÂú®ÂõõÁßçÁä∂ÊÄÅÔºå‰æùÊ¨°ÊòØÔºöÊó†ÈîÅÁä∂ÊÄÅ„ÄÅÂÅèÂêëÈîÅÁä∂ÊÄÅ„ÄÅËΩªÈáèÁ∫ßÈîÅÁä∂ÊÄÅ„ÄÅÈáçÈáèÁ∫ßÈîÅÁä∂ÊÄÅÔºå‰ªñ‰ª¨‰ºöÈöèÁùÄÁ´û‰∫âÁöÑÊøÄÁÉàËÄåÈÄêÊ∏êÂçáÁ∫ß„ÄÇÊ≥®ÊÑèÈîÅÂèØ‰ª•ÂçáÁ∫ß‰∏çÂèØÈôçÁ∫ßÔºåËøôÁßçÁ≠ñÁï•ÊòØ‰∏∫‰∫ÜÊèêÈ´òËé∑ÂæóÈîÅÂíåÈáäÊîæÈîÅÁöÑÊïàÁéá„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://www.mianshi.online/multi-thread-synchronized-optimize.html">36.jdk1.6‰∏∫‰ªÄ‰πàË¶ÅÂØπsynchronizedËøõË°å‰ºòÂåñÔºüÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñÔºü - Ë∑Ø‰∫∫Âº†ÁöÑÈù¢ËØïÁ¨îËÆ∞ (mianshi.online)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.iamshuaidi.com/1084.html">ËØ¥ËØ¥ JDK1.6 ‰πãÂêéÁöÑ synchronized ÂÖ≥ÈîÆÂ≠óÂ∫ïÂ±ÇÂÅö‰∫ÜÂì™‰∫õ‰ºòÂåñÔºåÂèØ‰ª•ËØ¶ÁªÜ‰ªãÁªç‰∏Ä‰∏ãËøô‰∫õ‰ºòÂåñÂêóÔºü-Â∏ÖÂú∞Áé©ÁºñÁ®ã (iamshuaidi.com)</a></p>
<h3 id="üåüÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅÈáçÈáèÁ∫ßÈîÅÁöÑÂØπÊØî"><a href="#üåüÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅÈáçÈáèÁ∫ßÈîÅÁöÑÂØπÊØî" class="headerlink" title="üåüÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅÈáçÈáèÁ∫ßÈîÅÁöÑÂØπÊØî"></a>üåüÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅÈáçÈáèÁ∫ßÈîÅÁöÑÂØπÊØî</h3><table>
<thead>
<tr>
<th>ÈîÅ</th>
<th align="center">‰ºòÁÇπ</th>
<th align="center">Áº∫ÁÇπ</th>
<th align="center">‰ΩøÁî®Âú∫ÊôØ</th>
</tr>
</thead>
<tbody><tr>
<td>ÂÅèÂêëÈîÅ</td>
<td align="center">Âä†ÈîÅÂíåËß£ÈîÅ‰∏çÈúÄË¶ÅCASÊìç‰ΩúÔºåÊ≤°ÊúâÈ¢ùÂ§ñÁöÑÊÄßËÉΩÊ∂àËÄóÔºåÂíåÊâßË°åÈùûÂêåÊ≠•ÊñπÊ≥ïÁõ∏ÊØî‰ªÖÂ≠òÂú®Á∫≥ÁßíÁ∫ßÁöÑÂ∑ÆË∑ù</td>
<td align="center">Â¶ÇÊûúÁ∫øÁ®ãÈó¥Â≠òÂú®ÈîÅÁ´û‰∫âÔºå‰ºöÂ∏¶Êù•È¢ùÂ§ñÁöÑÈîÅÊí§ÈîÄÁöÑÊ∂àËÄó</td>
<td align="center">ÈÄÇÁî®‰∫éÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÂêåÊ≠•ÂùóÁöÑÂú∫ÊôØ</td>
</tr>
<tr>
<td>ËΩªÈáèÁ∫ßÈîÅ</td>
<td align="center">Á´û‰∫âÁöÑÁ∫øÁ®ã‰∏ç‰ºöÈòªÂ°ûÔºåÊèêÈ´ò‰∫ÜÂìçÂ∫îÈÄüÂ∫¶</td>
<td align="center">Â¶ÇÁ∫øÁ®ãÊàêÂßãÁªàÂæó‰∏çÂà∞ÈîÅÁ´û‰∫âÁöÑÁ∫øÁ®ãÔºå‰ΩøÁî®Ëá™Êóã‰ºöÊ∂àËÄóCPUÊÄßËÉΩ</td>
<td align="center">ËøΩÊ±ÇÂìçÂ∫îÊó∂Èó¥ÔºåÂêåÊ≠•ÂùóÊâßË°åÈÄüÂ∫¶ÈùûÂ∏∏Âø´</td>
</tr>
<tr>
<td>ÈáçÈáèÁ∫ßÈîÅ</td>
<td align="center">Á∫øÁ®ãÁ´û‰∫â‰∏çÈÄÇÁî®Ëá™ÊóãÔºå‰∏ç‰ºöÊ∂àËÄóCPU</td>
<td align="center">Á∫øÁ®ãÈòªÂ°ûÔºåÂìçÂ∫îÊó∂Èó¥ÁºìÊÖ¢ÔºåÂú®Â§öÁ∫øÁ®ã‰∏ãÔºåÈ¢ëÁπÅÁöÑËé∑ÂèñÈáäÊîæÈîÅÔºå‰ºöÂ∏¶Êù•Â∑®Â§ßÁöÑÊÄßËÉΩÊ∂àËÄó</td>
<td align="center">ËøΩÊ±ÇÂêûÂêêÈáèÔºåÂêåÊ≠•ÂùóÊâßË°åÈÄüÂ∫¶ËæÉÈïø</td>
</tr>
</tbody></table>
<h3 id="üåü‰∫ÜËß£ÈîÅÊ∂àÈô§ÂêóÔºü‰∫ÜËß£ÈîÅÁ≤óÂåñÂêóÔºü"><a href="#üåü‰∫ÜËß£ÈîÅÊ∂àÈô§ÂêóÔºü‰∫ÜËß£ÈîÅÁ≤óÂåñÂêóÔºü" class="headerlink" title="üåü‰∫ÜËß£ÈîÅÊ∂àÈô§ÂêóÔºü‰∫ÜËß£ÈîÅÁ≤óÂåñÂêóÔºü"></a>üåü‰∫ÜËß£ÈîÅÊ∂àÈô§ÂêóÔºü‰∫ÜËß£ÈîÅÁ≤óÂåñÂêóÔºü</h3><p>ÈîÅÊ∂àÈô§ÊòØÊåáJavaËôöÊãüÊú∫Âú®Âç≥Êó∂ÁºñËØëÊó∂ÔºåÈÄöËøáÂØπËøêË°å‰∏ä‰∏ãÁöÑÊâ´ÊèèÔºåÊ∂àÈô§ÈÇ£‰∫õ‰∏çÂèØËÉΩÂ≠òÂú®ÂÖ±‰∫´ËµÑÊ∫êÁ´û‰∫âÁöÑÈîÅ„ÄÇÈîÅÊ∂àÈô§ÂèØ‰ª•ËäÇÁ∫¶Êó†ÊÑè‰πâÁöÑËØ∑Ê±ÇÈîÅÊó∂Èó¥„ÄÇ</p>
<p>ÈîÅÁ≤óÂåñÊòØÊåáÂΩìËôöÊãüÊú∫Êé¢ÊµãÂà∞‰∏Ä‰∏≤ÁöÑÊìç‰ΩúÂØπÁõ∏ÂêåÂØπË±°Â§öÊ¨°Âä†ÈîÅÔºåÔºåÂØºËá¥Á∫øÁ®ãÂèëÁîüÂ§öÊ¨°ÈáçÂÖ•ÔºåÂ∞Ü‰ºöÊääÂä†ÈîÅÁöÑËåÉÂõ¥Êâ©Â±ïÔºàÁ≤óÂåñÔºâÂà∞Êï¥‰∏™Êìç‰ΩúÂ∫èÂàóÁöÑÂ§ñÈÉ®„ÄÇÂõ†‰∏∫È¢ëÁπÅÁöÑÂä†ÈîÅÊìç‰ΩúÂ∞±‰ºöÂØºËá¥ÊÄßËÉΩÊçüËÄóÔºåÂèØ‰ª•‰ΩøÁî®ÈîÅÁ≤óÂåñÊñπÂºè‰ºòÂåñ</p>
<h3 id="üåüsynchronizedÂíåvolatileÁöÑÂå∫Âà´"><a href="#üåüsynchronizedÂíåvolatileÁöÑÂå∫Âà´" class="headerlink" title="üåüsynchronizedÂíåvolatileÁöÑÂå∫Âà´"></a>üåüsynchronizedÂíåvolatileÁöÑÂå∫Âà´</h3><ul>
<li>  <code>volatile</code>‰∏ªË¶ÅÊòØÂëäËØâJVMÂΩìÂâçÂèòÈáèÂú®ÂØÑÂ≠òÂô®ÔºàÂ∑•‰ΩúÂÜÖÂ≠òÔºâ‰∏≠ÁöÑÂÄºÊòØ‰∏çÁ°ÆÂÆöÁöÑÔºåÈúÄË¶Å‰ªé‰∏ªÂ≠ò‰∏≠ËØªÂèñ„ÄÇ<code>synchronized</code>ÂàôÊòØÈîÅÂÆöÂΩìÂâçÂèòÈáèÔºåÂè™ÊúâÂΩìÂâçÁ∫øÁ®ãÂèØ‰ª•ËÆøÈóÆËØ•ÂèòÈáèÔºåÂÖ∂‰ªñÁ∫øÁ®ãË¢´ÈòªÂ°û‰Ωè„ÄÇ</li>
<li>  <code>volatile</code>‰ΩúÁî®‰∫éÂèòÈáèÔºå<code>synchronized</code>‰ΩúÁî®‰∫é‰ª£Á†ÅÂùóÊàñËÄÖÊñπÊ≥ï„ÄÇ</li>
<li>  <code>volatile</code>‰ªÖÂèØ‰ª•‰øùËØÅÊï∞ÊçÆÁöÑÂèØËßÅÊÄßÂíåÊúâÂ∫èÊÄßÔºå‰∏çËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑÂéüÂ≠êÊÄß„ÄÇ<code>synchronized</code>ÂèØ‰ª•‰øùËØÅÊï∞ÊçÆÁöÑÂèØËßÅÊÄß„ÄÅÊúâÂ∫èÊÄß„ÄÅÂéüÂ≠êÊÄß„ÄÇ</li>
<li>  <code>volatile</code>‰∏ç‰ºöÈÄ†ÊàêÁ∫øÁ®ãÁöÑÈòªÂ°ûÔºå<code>synchronized</code>‰ºöÈÄ†ÊàêÁ∫øÁ®ãÁöÑÈòªÂ°û„ÄÇ</li>
<li>  <code>volatile</code> Ê†áËÆ∞ÁöÑÂèòÈáè‰∏ç‰ºöË¢´ÁºñËØëÂô®‰ºòÂåñÔºõ<code>synchronized</code> Ê†áËÆ∞ÁöÑÂèòÈáèÂèØ‰ª•Ë¢´ÁºñËØëÂô®‰ºòÂåñ„ÄÇ</li>
</ul>
<h3 id="üåüsynchronizedÂíåReentrantLockÂå∫Âà´"><a href="#üåüsynchronizedÂíåReentrantLockÂå∫Âà´" class="headerlink" title="üåüsynchronizedÂíåReentrantLockÂå∫Âà´"></a>üåüsynchronizedÂíåReentrantLockÂå∫Âà´</h3><p>Áõ∏ÂêåÁÇπÔºö‰∏§ËÄÖÈÉΩÊòØÂèØÈáçÂÖ•ÈîÅÔºåÂç≥Ëá™Â∑±ÂèØ‰ª•ÂÜçÊ¨°Ëé∑ÂèñËá™Â∑±ÁöÑÂÜÖÈÉ®ÈîÅ</p>
<p>Âå∫Âà´Ôºö</p>
<p>1„ÄÅsynchronized ÊòØÂÖ≥ÈîÆÂ≠óÔºåReentrantLock ÊòØÁ±ªÔºåËøôÊòØ‰∫åËÄÖÁöÑÊú¨Ë¥®Âå∫Âà´„ÄÇ</p>
<p>Êó¢ÁÑ∂ ReentrantLock ÊòØÁ±ªÔºåÈÇ£‰πàÂÆÉÂ∞±Êèê‰æõ‰∫ÜÊØî synchronized Êõ¥Â§öÊõ¥ÁÅµÊ¥ªÁöÑÁâπÊÄßÔºöÁ≠âÂæÖÂèØ‰∏≠Êñ≠„ÄÅÂèØÂÆûÁé∞ÂÖ¨Âπ≥ÈîÅ„ÄÅÂèØÂÆûÁé∞ÈÄâÊã©ÊÄßÈÄöÁü•ÔºàÈîÅÂèØ‰ª•ÁªëÂÆöÂ§ö‰∏™Êù°‰ª∂Ôºâ„ÄÅÊÄßËÉΩÂ∑≤‰∏çÊòØÈÄâÊã©Ê†áÂáÜ„ÄÇ</p>
<p><strong>Á≠âÂæÖÂèØ‰∏≠Êñ≠</strong> : <code>ReentrantLock</code>Êèê‰æõ‰∫Ü‰∏ÄÁßçËÉΩÂ§ü‰∏≠Êñ≠Á≠âÂæÖÈîÅÁöÑÁ∫øÁ®ãÁöÑÊú∫Âà∂ÔºåÈÄöËøá <code>lock.lockInterruptibly()</code> Êù•ÂÆûÁé∞Ëøô‰∏™Êú∫Âà∂„ÄÇ‰πüÂ∞±ÊòØËØ¥Ê≠£Âú®Á≠âÂæÖÁöÑÁ∫øÁ®ãÂèØ‰ª•ÈÄâÊã©ÊîæÂºÉÁ≠âÂæÖÔºåÊîπ‰∏∫Â§ÑÁêÜÂÖ∂‰ªñ‰∫ãÊÉÖ„ÄÇ</p>
<p><strong>ÂèØÂÆûÁé∞ÂÖ¨Âπ≥ÈîÅ</strong> : <code>ReentrantLock</code>ÂèØ‰ª•ÊåáÂÆöÊòØÂÖ¨Âπ≥ÈîÅËøòÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇËÄå<code>synchronized</code>Âè™ËÉΩÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇÊâÄË∞ìÁöÑÂÖ¨Âπ≥ÈîÅÂ∞±ÊòØÂÖàÁ≠âÂæÖÁöÑÁ∫øÁ®ãÂÖàËé∑ÂæóÈîÅ„ÄÇ<code>ReentrantLock</code>ÈªòËÆ§ÊÉÖÂÜµÊòØÈùûÂÖ¨Âπ≥ÁöÑÔºåÂèØ‰ª•ÈÄöËøá <code>ReentrantLock</code>Á±ªÁöÑ<code>ReentrantLock(boolean fair)</code>ÊûÑÈÄ†ÊñπÊ≥ïÊù•Âà∂ÂÆöÊòØÂê¶ÊòØÂÖ¨Âπ≥ÁöÑ„ÄÇ</p>
<p><strong>ÂèØÂÆûÁé∞ÈÄâÊã©ÊÄßÈÄöÁü•ÔºàÈîÅÂèØ‰ª•ÁªëÂÆöÂ§ö‰∏™Êù°‰ª∂Ôºâ</strong>: <code>synchronized</code>ÂÖ≥ÈîÆÂ≠ó‰∏é<code>wait()</code>Âíå<code>notify()</code>/<code>notifyAll()</code>ÊñπÊ≥ïÁõ∏ÁªìÂêàÂèØ‰ª•ÂÆûÁé∞Á≠âÂæÖ/ÈÄöÁü•Êú∫Âà∂„ÄÇ<code>ReentrantLock</code>Á±ªÂΩìÁÑ∂‰πüÂèØ‰ª•ÂÆûÁé∞Ôºå‰ΩÜÊòØÈúÄË¶ÅÂÄüÂä©‰∫é<code>Condition</code>Êé•Âè£‰∏é<code>newCondition()</code>ÊñπÊ≥ï„ÄÇ</p>
<p>2„ÄÅ synchronized ‰æùËµñ‰∫é JVM ËÄå ReenTrantLock ‰æùËµñ‰∫é API„ÄÇ</p>
<p>synchronized ÊòØ‰æùËµñ‰∫é JVM ÂÆûÁé∞ÁöÑÔºåJDK1.6 ‰∏∫ synchronized ÂÖ≥ÈîÆÂ≠óËøõË°å‰∫ÜÂæàÂ§ö‰ºòÂåñÔºå‰ΩÜÊòØËøô‰∫õ‰ºòÂåñÈÉΩÊòØÂú®ËôöÊãüÊú∫Â±ÇÈù¢ÂÆûÁé∞ÁöÑÔºåÂπ∂Ê≤°ÊúâÁõ¥Êé•Êö¥Èú≤ÁªôÊàë‰ª¨„ÄÇ</p>
<p>ReenTrantLock ÊòØ JDK Â±ÇÈù¢ÂÆûÁé∞ÁöÑÔºà‰πüÂ∞±ÊòØ API Â±ÇÈù¢ÔºåÈúÄË¶Å lock() Âíå unlock ÊñπÊ≥ïÈÖçÂêà try/finally ËØ≠Âè•ÂùóÊù•ÂÆåÊàêÔºâÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊü•ÁúãÂÆÉÁöÑÊ∫ê‰ª£Á†ÅÔºåÊù•ÁúãÂÆÉÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>3„ÄÅReentrantLock ÈúÄË¶ÅÊâãÂä®Ëß£ÈîÅÔºåsynchronized ÊâßË°åÂÆå‰ª£Á†ÅÂùóËá™Âä®Ëß£ÈîÅ</p>
<h3 id="üåüsynchronizedÂíåLockÁöÑÂå∫Âà´Ôºü"><a href="#üåüsynchronizedÂíåLockÁöÑÂå∫Âà´Ôºü" class="headerlink" title="üåüsynchronizedÂíåLockÁöÑÂå∫Âà´Ôºü"></a>üåüsynchronizedÂíåLockÁöÑÂå∫Âà´Ôºü</h3><ul>
<li>  LockÊòØÊòæÁ§∫ÈîÅÔºåÈúÄË¶ÅÊâãÂä®ÂºÄÂêØÂíåÂÖ≥Èó≠„ÄÇsynchronizedÊòØÈöêÂ£´ÈîÅÔºåÂèØ‰ª•Ëá™Âä®ÈáäÊîæÈîÅ„ÄÇ</li>
<li>  LockÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåÊòØJDKÂÆûÁé∞ÁöÑ„ÄÇsynchronizedÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÂ≠óÔºåÊòØ‰æùËµñJVMÂÆûÁé∞ÁöÑ„ÄÇ</li>
<li>  LockÊòØÂèØ‰∏≠Êñ≠ÈîÅÔºåsynchronizedÊòØ‰∏çÂèØ‰∏≠Êñ≠ÈîÅÔºåÈúÄË¶ÅÁ∫øÁ®ãÊâßË°åÂÆåÊâçËÉΩÈáäÊîæÈîÅ„ÄÇ</li>
<li>  ÂèëÁîüÂºÇÂ∏∏Êó∂ÔºåLock‰∏ç‰ºö‰∏ªÂä®ÈáäÊîæÂç†ÊúâÁöÑÈîÅÔºåÂøÖÈ°ªÈÄöËøáunlockËøõË°åÊâãÂä®ÈáäÊîæÔºåÂõ†Ê≠§ÂèØËÉΩÂºïÂèëÊ≠ªÈîÅ„ÄÇsynchronizedÂú®ÂèëÁîüÂºÇÂ∏∏Êó∂‰ºöËá™Âä®ÈáäÊîæÂç†ÊúâÁöÑÈîÅÔºå‰∏ç‰ºöÂá∫Áé∞Ê≠ªÈîÅÁöÑÊÉÖÂÜµ„ÄÇ</li>
<li>  LockÂèØ‰ª•Âà§Êñ≠ÈîÅÁöÑÁä∂ÊÄÅÔºåsynchronized‰∏çÂèØ‰ª•Âà§Êñ≠ÈîÅÁöÑÁä∂ÊÄÅ„ÄÇ</li>
<li>  LockÂÆûÁé∞ÈîÅÁöÑÁ±ªÂûãÊòØÂèØÈáçÂÖ•ÈîÅ„ÄÅÂÖ¨Âπ≥ÈîÅ„ÄÇsynchronizedÂÆûÁé∞ÈîÅÁöÑÁ±ªÂûãÊòØÂèØÈáçÂÖ•ÈîÅÔºåÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇ</li>
<li>  LockÈÄÇÁî®‰∫éÂ§ßÈáèÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂú∫ÊôØÔºåsynchronizedÈÄÇÁî®‰∫éÂ∞ëÈáèÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂú∫ÊôØ„ÄÇ</li>
</ul>
<h2 id="‚ù∑volatile"><a href="#‚ù∑volatile" class="headerlink" title="‚ù∑volatile"></a>‚ù∑volatile</h2><h3 id="üåüvolatileÁöÑÁâπÊÄßÊúâÂì™‰∫õÔºü"><a href="#üåüvolatileÁöÑÁâπÊÄßÊúâÂì™‰∫õÔºü" class="headerlink" title="üåüvolatileÁöÑÁâπÊÄßÊúâÂì™‰∫õÔºü"></a>üåüvolatileÁöÑÁâπÊÄßÊúâÂì™‰∫õÔºü</h3><blockquote>
<p>Âπ∂ÂèëÁºñÁ®ãÁöÑ‰∏âÂ§ßÁâπÊÄß‰∏∫ÂèØËßÅÊÄß„ÄÅÊúâÂ∫èÊÄßÂíåÂéüÂ≠êÊÄß„ÄÇÈÄöÂ∏∏Êù•ËÆ≤<code>volatile</code>ÂèØ‰ª•‰øùËØÅÂèØËßÅÊÄßÂíåÊúâÂ∫èÊÄß„ÄÇ</p>
</blockquote>
<ul>
<li>  ÂèØËßÅÊÄßÔºö<code>volatile</code>ÂèØ‰ª•‰øùËØÅ‰∏çÂêåÁ∫øÁ®ãÂØπÂÖ±‰∫´ÂèòÈáèËøõË°åÊìç‰ΩúÊó∂ÁöÑÂèØËßÅÊÄß„ÄÇÂç≥ÂΩì‰∏Ä‰∏™Á∫øÁ®ã‰øÆÊîπ‰∫ÜÂÖ±‰∫´ÂèòÈáèÊó∂ÔºåÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ËØªÂèñÂà∞ÂÖ±‰∫´ÂèòÈáèË¢´‰øÆÊîπÂêéÁöÑÂÄº„ÄÇ</li>
<li>  ÊúâÂ∫èÊÄßÔºö<code>volatile</code>‰ºöÈÄöËøáÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èËøõËÄå‰øùËØÅÊúâÂ∫èÊÄß„ÄÇ</li>
<li>  ÂéüÂ≠êÊÄßÔºöÂØπ‰∫éÂçï‰∏™ÁöÑ<code>volatile</code>‰øÆÈ•∞ÁöÑÂèòÈáèÁöÑËØªÂÜôÊòØÂèØ‰ª•‰øùËØÅÂéüÂ≠êÊÄßÁöÑÔºå‰ΩÜÂØπ‰∫é<code>i++</code>ËøôÁßçÂ§çÂêàÊìç‰ΩúÂπ∂‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß„ÄÇËøôÂè•ËØùÁöÑÊÑèÊÄùÂü∫Êú¨‰∏äÂ∞±ÊòØËØ¥<code>volatile</code>‰∏çÂÖ∑Â§áÂéüÂ≠êÊÄß‰∫Ü„ÄÇ</li>
</ul>
<h3 id="üåüvolatileÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πà"><a href="#üåüvolatileÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πà" class="headerlink" title="üåüvolatileÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πà?"></a>üåüvolatileÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πà?</h3><ul>
<li>Èò≤ÈáçÊéíÂ∫è<ul>
<li>Â¶ÇÊûúÊàë‰ª¨Â∞ÜÂèòÈáèÂ£∞Êòé‰∏∫ <strong><code>volatile</code></strong> ÔºåÂú®ÂØπËøô‰∏™ÂèòÈáèËøõË°åËØªÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºå‰ºöÈÄöËøáÊèíÂÖ•ÁâπÂÆöÁöÑ <strong>ÂÜÖÂ≠òÂ±èÈöú</strong> ÁöÑÊñπÂºèÊù•Á¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫è„ÄÇ</li>
</ul>
</li>
<li> ÂÆûÁé∞ÂèØËßÅÊÄß</li>
<li> ‰øùËØÅÂéüÂ≠êÊÄß:ÂçïÊ¨°ËØª/ÂÜô</li>
</ul>
<h3 id="üåüvoliatileÁöÑÂÆûÁé∞ÂéüÁêÜÔºü"><a href="#üåüvoliatileÁöÑÂÆûÁé∞ÂéüÁêÜÔºü" class="headerlink" title="üåüvoliatileÁöÑÂÆûÁé∞ÂéüÁêÜÔºü"></a>üåüvoliatileÁöÑÂÆûÁé∞ÂéüÁêÜÔºü</h3><p>volatile ÂèØËßÅÊÄßÂÆûÁé∞</p>
<p>volatile ÊúâÂ∫èÊÄßÂÆûÁé∞</p>
<h3 id="üåüvolatileÂÆûÁé∞ÂÜÖÂ≠òÂèØËßÅÊÄßÂéüÁêÜ"><a href="#üåüvolatileÂÆûÁé∞ÂÜÖÂ≠òÂèØËßÅÊÄßÂéüÁêÜ" class="headerlink" title="üåüvolatileÂÆûÁé∞ÂÜÖÂ≠òÂèØËßÅÊÄßÂéüÁêÜ?"></a>üåüvolatileÂÆûÁé∞ÂÜÖÂ≠òÂèØËßÅÊÄßÂéüÁêÜ?</h3><blockquote>
<p>ÂØºËá¥ÂÜÖÂ≠ò‰∏çÂèØËßÅÁöÑ‰∏ªË¶ÅÂéüÂõ†Â∞±ÊòØJavaÂÜÖÂ≠òÊ®°Âûã‰∏≠ÁöÑÊú¨Âú∞ÂÜÖÂ≠òÂíå‰∏ªÂÜÖÂ≠ò‰πãÈó¥ÁöÑÂÄº‰∏ç‰∏ÄËá¥ÊâÄÂØºËá¥Ôºå‰æãÂ¶Ç‰∏äÈù¢ÊâÄËØ¥Á∫øÁ®ãAËÆøÈóÆËá™Â∑±Êú¨Âú∞ÂÜÖÂ≠òAÁöÑXÂÄºÊó∂Ôºå‰ΩÜÊ≠§Êó∂‰∏ªÂÜÖÂ≠òÁöÑXÂÄºÂ∑≤ÁªèË¢´Á∫øÁ®ãBÊâÄ‰øÆÊîπÔºåÊâÄ‰ª•Á∫øÁ®ãAÊâÄËÆøÈóÆÂà∞ÁöÑÂÄºÊòØ‰∏Ä‰∏™ËÑèÊï∞ÊçÆ„ÄÇÈÇ£Â¶Ç‰ΩïËß£ÂÜ≥ËøôÁßçÈóÆÈ¢òÂë¢Ôºü</p>
</blockquote>
<p><code>volatile</code>ÂèØ‰ª•‰øùËØÅÂÜÖÂ≠òÂèØËßÅÊÄßÁöÑÂÖ≥ÈîÆÊòØ<code>volatile</code>ÁöÑËØª/ÂÜôÂÆûÁé∞‰∫ÜÁºìÂ≠ò‰∏ÄËá¥ÊÄßÔºåÁºìÂ≠ò‰∏ÄËá¥ÊÄßÁöÑ‰∏ªË¶ÅÂÜÖÂÆπ‰∏∫Ôºö</p>
<ul>
<li>  ÊØè‰∏™Â§ÑÁêÜÂô®‰ºöÈÄöËøáÂóÖÊé¢ÊÄªÁ∫ø‰∏äÁöÑÊï∞ÊçÆÊù•Êü•ÁúãËá™Â∑±ÁöÑÊï∞ÊçÆÊòØÂê¶ËøáÊúüÔºå‰∏ÄÊó¶Â§ÑÁêÜÂô®ÂèëÁé∞Ëá™Â∑±ÁºìÂ≠òÂØπÂ∫îÁöÑÂÜÖÂ≠òÂú∞ÂùÄË¢´‰øÆÊîπÔºåÂ∞±‰ºöÂ∞ÜÂΩìÂâçÂ§ÑÁêÜÂô®ÁöÑÁºìÂ≠òËÆæ‰∏∫Êó†ÊïàÁä∂ÊÄÅ„ÄÇÊ≠§Êó∂ÔºåÂ¶ÇÊûúÂ§ÑÁêÜÂô®ÈúÄË¶ÅËé∑ÂèñËøô‰∏™Êï∞ÊçÆÈúÄÈáçÊñ∞‰ªé‰∏ªÂÜÖÂ≠òÂ∞ÜÂÖ∂ËØªÂèñÂà∞Êú¨Âú∞ÂÜÖÂ≠ò„ÄÇ</li>
<li>  ÂΩìÂ§ÑÁêÜÂô®ÂÜôÊï∞ÊçÆÊó∂ÔºåÂ¶ÇÊûúÂèëÁé∞Êìç‰ΩúÁöÑÊòØÂÖ±‰∫´ÂèòÈáèÔºå‰ºöÈÄöÁü•ÂÖ∂‰ªñÂ§ÑÁêÜÂô®Â∞ÜËØ•ÂèòÈáèÁöÑÁºìÂ≠òËÆæ‰∏∫Êó†ÊïàÁä∂ÊÄÅ„ÄÇ</li>
</ul>
<p>ÈÇ£ÁºìÂ≠ò‰∏ÄËá¥ÊÄßÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÂë¢ÔºüÂèØ‰ª•ÂèëÁé∞ÈÄöËøá<code>volatile</code>‰øÆÈ•∞ÁöÑÂèòÈáèÔºåÁîüÊàêÊ±áÁºñÊåá‰ª§Êó∂‰ºöÊØîÊôÆÈÄöÁöÑÂèòÈáèÂ§öÂá∫‰∏Ä‰∏™<code>Lock</code>Êåá‰ª§ÔºåËøô‰∏™<code>Lock</code>Êåá‰ª§Â∞±ÊòØ<code>volatile</code>ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øùËØÅÂÜÖÂ≠òÂèØËßÅÊÄßÁöÑÂÖ≥ÈîÆÔºåÂÆÉ‰∏ªË¶ÅÊúâ‰∏§‰∏™‰ΩúÁî®Ôºö</p>
<ul>
<li>  Â∞ÜÂΩìÂâçÂ§ÑÁêÜÂô®ÁºìÂ≠òÁöÑÊï∞ÊçÆÂà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠ò„ÄÇ</li>
<li>  Âà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠òÊó∂‰ºö‰ΩøÂæóÂÖ∂‰ªñÂ§ÑÁêÜÂô®ÁºìÂ≠òÁöÑËØ•ÂÜÖÂ≠òÂú∞ÂùÄÁöÑÊï∞ÊçÆÊó†Êïà„ÄÇ</li>
</ul>
<h3 id="üåüJavaÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÈóÆÈ¢ò"><a href="#üåüJavaÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÈóÆÈ¢ò" class="headerlink" title="üåüJavaÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÈóÆÈ¢ò"></a>üåüJavaÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÈóÆÈ¢ò</h3><p>ÂèØËßÅÊÄßÔºöÊòØÊåáÂΩìÂ§ö‰∏™Á∫øÁ®ãËÆøÈóÆÂêå‰∏Ä‰∏™ÂèòÈáèÊó∂Ôºå‰∏Ä‰∏™Á∫øÁ®ã‰øÆÊîπ‰∫ÜËøô‰∏™ÂèòÈáèÁöÑÂÄºÔºåÂÖ∂‰ªñÁ∫øÁ®ãËÉΩÂ§üÁ´ãÂç≥ÁúãÂæóÂà∞‰øÆÊîπÁöÑÂÄº</p>
<p>Â≠òÂú®‰∏çÂèØËßÅÈóÆÈ¢òÁöÑÊ†πÊú¨ÂéüÂõ†ÊòØÁî±‰∫éÁºìÂ≠òÁöÑÂ≠òÂú®ÔºåÁ∫øÁ®ãÊåÅÊúâÁöÑÊòØÂÖ±‰∫´ÂèòÈáèÁöÑÂâØÊú¨ÔºåÊó†Ê≥ïÊÑüÁü•ÂÖ∂‰ªñÁ∫øÁ®ãÂØπ‰∫éÂÖ±‰∫´ÂèòÈáèÁöÑÊõ¥ÊîπÔºåÂØºËá¥ËØªÂèñÁöÑÂÄº‰∏çÊòØÊúÄÊñ∞ÁöÑ„ÄÇ</p>
<h3 id="üåüÂ¶Ç‰Ωï‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄßÔºü"><a href="#üåüÂ¶Ç‰Ωï‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄßÔºü" class="headerlink" title="üåüÂ¶Ç‰Ωï‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄßÔºü"></a>üåüÂ¶Ç‰Ωï‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄßÔºü</h3><p>Âú® Java ‰∏≠Ôºå<code>volatile</code> ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄßÔºåÂ¶ÇÊûúÊàë‰ª¨Â∞ÜÂèòÈáèÂ£∞Êòé‰∏∫ <strong><code>volatile</code></strong> ÔºåËøôÂ∞±ÊåáÁ§∫ JVMÔºåËøô‰∏™ÂèòÈáèÊòØÂÖ±‰∫´‰∏î‰∏çÁ®≥ÂÆöÁöÑÔºåÊØèÊ¨°‰ΩøÁî®ÂÆÉÈÉΩÂà∞‰∏ªÂ≠ò‰∏≠ËøõË°åËØªÂèñ„ÄÇ</p>
<p><code>volatile</code> ÂÖ≥ÈîÆÂ≠óËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑÂèØËßÅÊÄßÔºå‰ΩÜ‰∏çËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑÂéüÂ≠êÊÄß„ÄÇ<code>synchronized</code> ÂÖ≥ÈîÆÂ≠ó‰∏§ËÄÖÈÉΩËÉΩ‰øùËØÅ„ÄÇ</p>
<h3 id="üåüvolatileÂ¶Ç‰ΩïÂÆûÁé∞ÊúâÂ∫èÊÄß"><a href="#üåüvolatileÂ¶Ç‰ΩïÂÆûÁé∞ÊúâÂ∫èÊÄß" class="headerlink" title="üåüvolatileÂ¶Ç‰ΩïÂÆûÁé∞ÊúâÂ∫èÊÄß"></a>üåüvolatileÂ¶Ç‰ΩïÂÆûÁé∞ÊúâÂ∫èÊÄß</h3><p>‰∏∫‰∫ÜÂÆûÁé∞volatileÁöÑÂÜÖÂ≠òËØ≠‰πâÔºåÁºñËØëÂô®Âú®ÁîüÊàêÂ≠óËäÇÁ†ÅÊó∂‰ºöÈÄöËøáÊèíÂÖ•ÂÜÖÂ≠òÂ±èÈöúÊù•Á¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫è„ÄÇ</p>
<p>happens-beforeÁ≠â</p>
<h3 id="üåüvolatileÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØËßÅÊÄßÁöÑ-ÂÜÖÂ≠òÂ±èÈöú„ÄÇ"><a href="#üåüvolatileÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØËßÅÊÄßÁöÑ-ÂÜÖÂ≠òÂ±èÈöú„ÄÇ" class="headerlink" title="üåüvolatileÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØËßÅÊÄßÁöÑ? ÂÜÖÂ≠òÂ±èÈöú„ÄÇ"></a>üåüvolatileÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØËßÅÊÄßÁöÑ? ÂÜÖÂ≠òÂ±èÈöú„ÄÇ</h3><h3 id="üåüvolatileËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÂêó"><a href="#üåüvolatileËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÂêó" class="headerlink" title="üåüvolatileËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÂêó?"></a>üåüvolatileËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÂêó?</h3><p><strong><code>volatile</code> ÂÖ≥ÈîÆÂ≠óËÉΩ‰øùËØÅÂèòÈáèÁöÑÂèØËßÅÊÄß„ÄÅÊúâÂ∫èÊÄßÔºå‰ΩÜ‰∏çËÉΩ‰øùËØÅÂØπÂèòÈáèÁöÑÊìç‰ΩúÊòØÂéüÂ≠êÊÄßÁöÑ„ÄÇ</strong></p>
<h3 id="üåüi-‰∏∫‰ªÄ‰πà‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß"><a href="#üåüi-‰∏∫‰ªÄ‰πà‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß" class="headerlink" title="üåüi++‰∏∫‰ªÄ‰πà‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß?"></a>üåüi++‰∏∫‰ªÄ‰πà‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß?</h3><h3 id="üåüÂ¶Ç‰Ωï‰øùËØÅÂ§öÁ∫øÁ®ã‰∏ã-i-ÁªìÊûúÊ≠£Á°Æ"><a href="#üåüÂ¶Ç‰Ωï‰øùËØÅÂ§öÁ∫øÁ®ã‰∏ã-i-ÁªìÊûúÊ≠£Á°Æ" class="headerlink" title="üåüÂ¶Ç‰Ωï‰øùËØÅÂ§öÁ∫øÁ®ã‰∏ã i++ ÁªìÊûúÊ≠£Á°Æ"></a>üåüÂ¶Ç‰Ωï‰øùËØÅÂ§öÁ∫øÁ®ã‰∏ã i++ ÁªìÊûúÊ≠£Á°Æ</h3><ol>
<li>‰ΩøÁî®Âæ™ÁéØCAS+volatileÔºåÂÆûÁé∞ i++ÂéüÂ≠êÊìç‰ΩúÔºõ  </li>
<li>‰ΩøÁî® synchronizedÔºåÂÆûÁé∞ i++ÂéüÂ≠êÊìç‰ΩúÔºõ </li>
<li>‰ΩøÁî® LockÈîÅÊú∫Âà∂ÔºåÂÆûÁé∞i++ÂéüÂ≠êÊìç‰ΩúÔºõ </li>
<li>SemaphoreÊûÑÈÄ†ÊñπÊ≥ï‰∏≠‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊòØ1ÁöÑÊó∂ÂÄôÔºåÊ≠§Êó∂Á∫øÁ®ãÂπ∂ÂèëÊï∞ÊúÄÂ§öÊòØ1‰∏™ÔºåÂç≥ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåËøôÁßçÊñπÂºè‰πüÂèØ‰ª•ÂÅöÂà∞Áé∞Âú∫‰∫íÊñ•„ÄÇ  </li>
<li>‰ΩøÁî® AtomicIntegerÔºöÁî±Á°¨‰ª∂Êèê‰æõÂéüÂ≠êÊìç‰ΩúÊåá‰ª§ÂÆûÁé∞ÁöÑÔºõ</li>
</ol>
<h3 id="üåüvolatileËÉΩ‰Ωø‰∏Ä‰∏™ÈùûÂéüÂ≠êÊìç‰ΩúÂèòÊàê‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÂêóÔºü"><a href="#üåüvolatileËÉΩ‰Ωø‰∏Ä‰∏™ÈùûÂéüÂ≠êÊìç‰ΩúÂèòÊàê‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÂêóÔºü" class="headerlink" title="üåüvolatileËÉΩ‰Ωø‰∏Ä‰∏™ÈùûÂéüÂ≠êÊìç‰ΩúÂèòÊàê‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÂêóÔºü"></a>üåüvolatileËÉΩ‰Ωø‰∏Ä‰∏™ÈùûÂéüÂ≠êÊìç‰ΩúÂèòÊàê‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÂêóÔºü</h3><p><code>volatile</code>Âè™ËÉΩ‰øùËØÅÂèØËßÅÊÄßÂíåÊúâÂ∫èÊÄßÔºå‰ΩÜÂèØ‰ª•‰øùËØÅ64‰ΩçÁöÑ<code>long</code>ÂûãÂíå<code>double</code>ÂûãÂèòÈáèÁöÑÂéüÂ≠êÊÄß„ÄÇ</p>
<p>ÂØπ‰∫é32‰ΩçÁöÑËôöÊãüÊú∫Êù•ËØ¥ÔºåÊØèÊ¨°ÂéüÂ≠êËØªÂÜôÈÉΩÊòØ32‰ΩçÁöÑÔºå‰ºöÂ∞Ü<code>long</code>Âíå<code>double</code>ÂûãÂèòÈáèÊãÜÂàÜÊàê‰∏§‰∏™32‰ΩçÁöÑÊìç‰ΩúÊù•ÊâßË°åÔºåËøôÊ†∑<code>long</code>Âíå<code>double</code>ÂûãÂèòÈáèÁöÑËØªÂÜôÂ∞±‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß‰∫ÜÔºåËÄåÈÄöËøá<code>volatile</code>‰øÆÈ•∞ÁöÑlongÂíådoubleÂûãÂèòÈáèÂàôÂèØ‰ª•‰øùËØÅÂÖ∂ÂéüÂ≠êÊÄß„ÄÇ</p>
<h3 id="üåü32‰ΩçÊú∫Âô®‰∏äÂÖ±‰∫´ÁöÑlongÂíådoubleÂèòÈáèÁöÑ‰∏∫‰ªÄ‰πàË¶ÅÁî®volatile-Áé∞Âú®64‰ΩçÊú∫Âô®‰∏äÊòØÂê¶‰πüË¶ÅËÆæÁΩÆÂë¢"><a href="#üåü32‰ΩçÊú∫Âô®‰∏äÂÖ±‰∫´ÁöÑlongÂíådoubleÂèòÈáèÁöÑ‰∏∫‰ªÄ‰πàË¶ÅÁî®volatile-Áé∞Âú®64‰ΩçÊú∫Âô®‰∏äÊòØÂê¶‰πüË¶ÅËÆæÁΩÆÂë¢" class="headerlink" title="üåü32‰ΩçÊú∫Âô®‰∏äÂÖ±‰∫´ÁöÑlongÂíådoubleÂèòÈáèÁöÑ‰∏∫‰ªÄ‰πàË¶ÅÁî®volatile? Áé∞Âú®64‰ΩçÊú∫Âô®‰∏äÊòØÂê¶‰πüË¶ÅËÆæÁΩÆÂë¢?"></a>üåü32‰ΩçÊú∫Âô®‰∏äÂÖ±‰∫´ÁöÑlongÂíådoubleÂèòÈáèÁöÑ‰∏∫‰ªÄ‰πàË¶ÅÁî®volatile? Áé∞Âú®64‰ΩçÊú∫Âô®‰∏äÊòØÂê¶‰πüË¶ÅËÆæÁΩÆÂë¢?</h3><p>ÂØπ‰∫é32‰ΩçÁöÑËôöÊãüÊú∫Êù•ËØ¥ÔºåÊØèÊ¨°ÂéüÂ≠êËØªÂÜôÈÉΩÊòØ32‰ΩçÁöÑÔºå‰ºöÂ∞Ü<code>long</code>Âíå<code>double</code>ÂûãÂèòÈáèÊãÜÂàÜÊàêÈ´ò32‰ΩçÂíå‰Ωé32‰ΩçÁöÑ‰∏§‰∏™Êìç‰ΩúÊù•ÊâßË°åÔºåËøôÊ†∑<code>long</code>Âíå<code>double</code>ÂûãÂèòÈáèÁöÑËØªÂÜôÂ∞±‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß‰∫ÜÔºåËÄåÈÄöËøá<code>volatile</code>‰øÆÈ•∞ÁöÑlongÂíådoubleÂûãÂèòÈáèÂàôÂèØ‰ª•‰øùËØÅÂÖ∂ÂéüÂ≠êÊÄß„ÄÇ</p>
<p>ÁõÆÂâçÂêÑÁßçÂπ≥Âè∞‰∏ãÁöÑÂïÜÁî®ËôöÊãüÊú∫ÈÉΩÈÄâÊã©Êää 64 ‰ΩçÊï∞ÊçÆÁöÑËØªÂÜôÊìç‰Ωú‰Ωú‰∏∫ÂéüÂ≠êÊìç‰ΩúÊù•ÂØπÂæÖÔºåÂõ†Ê≠§Êàë‰ª¨Âú®ÁºñÂÜô‰ª£Á†ÅÊó∂‰∏ÄËà¨‰∏çÊäälong Âíå double ÂèòÈáè‰∏ìÈó®Â£∞Êòé‰∏∫ volatileÂ§öÊï∞ÊÉÖÂÜµ‰∏ã‰πüÊòØ‰∏ç‰ºöÈîôÁöÑ„ÄÇ</p>
<h3 id="üåüËØ¥‰∏ãvolatileÁöÑÂ∫îÁî®Âú∫ÊôØ"><a href="#üåüËØ¥‰∏ãvolatileÁöÑÂ∫îÁî®Âú∫ÊôØ" class="headerlink" title="üåüËØ¥‰∏ãvolatileÁöÑÂ∫îÁî®Âú∫ÊôØ?"></a>üåüËØ¥‰∏ãvolatileÁöÑÂ∫îÁî®Âú∫ÊôØ?</h3><p>‰ΩøÁî® volatile ÂøÖÈ°ªÂÖ∑Â§áÁöÑÊù°‰ª∂</p>
<ol>
<li>ÂØπÂèòÈáèÁöÑÂÜôÊìç‰Ωú‰∏ç‰æùËµñ‰∫éÂΩìÂâçÂÄº„ÄÇ</li>
<li>ËØ•ÂèòÈáèÊ≤°ÊúâÂåÖÂê´Âú®ÂÖ∑ÊúâÂÖ∂‰ªñÂèòÈáèÁöÑ‰∏çÂèòÂºè‰∏≠„ÄÇ</li>
<li>Âè™ÊúâÂú®Áä∂ÊÄÅÁúüÊ≠£Áã¨Á´ã‰∫éÁ®ãÂ∫èÂÜÖÂÖ∂‰ªñÂÜÖÂÆπÊó∂ÊâçËÉΩ‰ΩøÁî® volatile„ÄÇ</li>
</ol>
<ul>
<li>‰æãÂ≠ê 1Ôºö Âçï‰æãÊ®°Âºè</li>
<li>‰æãÂ≠ê2Ôºö volatile bean</li>
</ul>
<h3 id="üåüÂ¶Ç‰ΩïÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èÔºü"><a href="#üåüÂ¶Ç‰ΩïÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èÔºü" class="headerlink" title="üåüÂ¶Ç‰ΩïÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èÔºü"></a>üåüÂ¶Ç‰ΩïÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èÔºü</h3><p> Â¶ÇÊûúÊàë‰ª¨Â∞ÜÂèòÈáèÂ£∞Êòé‰∏∫ <strong><code>volatile</code></strong> ÔºåÂú®ÂØπËøô‰∏™ÂèòÈáèËøõË°åËØªÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºå‰ºöÈÄöËøáÊèíÂÖ•ÁâπÂÆöÁöÑ <strong>ÂÜÖÂ≠òÂ±èÈöú</strong> ÁöÑÊñπÂºèÊù•Á¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫è„ÄÇ</p>
<h3 id="üåüÂèåÈáçÊ£ÄÈ™åÈîÅ-DCL-ÂÆûÁé∞Âçï‰æãÊ®°ÂºèÁöÑÂéüÁêÜ"><a href="#üåüÂèåÈáçÊ£ÄÈ™åÈîÅ-DCL-ÂÆûÁé∞Âçï‰æãÊ®°ÂºèÁöÑÂéüÁêÜ" class="headerlink" title="üåüÂèåÈáçÊ£ÄÈ™åÈîÅ(DCL)ÂÆûÁé∞Âçï‰æãÊ®°ÂºèÁöÑÂéüÁêÜ"></a>üåüÂèåÈáçÊ£ÄÈ™åÈîÅ(DCL)ÂÆûÁé∞Âçï‰æãÊ®°ÂºèÁöÑÂéüÁêÜ</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">static</span> Singleton singleton<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span>  <span class="token keyword">static</span> Singleton <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment" spellcheck="true">//ÂÖàÂà§Êñ≠ÂØπË±°ÊòØÂê¶Â∑≤ÁªèÂÆû‰æãËøáÔºåÊ≤°ÊúâÂÆû‰æãÂåñËøáÊâçËøõÂÖ•Âä†ÈîÅ‰ª£Á†Å</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>singleton <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//Á±ªÂØπË±°Âä†ÈîÅ</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>Singleton<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>singleton <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏∫‰ªÄ‰πàË¶ÅÂú®ÂèòÈáè <code>singleton</code> ‰πãÈó¥Âä†‰∏ä <code>volatile</code> ÂÖ≥ÈîÆÂ≠óÔºü</p>
<p>Âõ†‰∏∫ÂØπË±°ÁöÑÊûÑÈÄ†ËøáÁ®ãÂàÜ‰∏∫‰∏â‰∏™Ê≠•È™§Ôºö(<code>singleton = new Singleton();</code>)</p>
<ol>
<li>ÂàÜÈÖçÂÜÖÂ≠òÁ©∫Èó¥„Äê‰∏∫ <code>singleton</code> ÂàÜÈÖçÂÜÖÂ≠òÁ©∫Èó¥„Äë</li>
<li>ÂàùÂßãÂåñÂØπË±°„ÄêÂàùÂßãÂåñ <code>singleton</code>„Äë</li>
<li>Â∞ÜÂÜÖÂ≠òÁ©∫Èó¥ÁöÑÂú∞ÂùÄËµãÁªôÂØπË±°ÁöÑÂºïÁî®„ÄêÂ∞Ü <code>singleton</code> ÊåáÂêëÂàÜÈÖçÁöÑÂÜÖÂ≠òÂú∞ÂùÄ„Äë</li>
</ol>
<p>‰ΩÜÊòØÁî±‰∫é JVM ÂÖ∑ÊúâÊåá‰ª§ÈáçÊéíÁöÑÁâπÊÄßÔºåÊâßË°åÈ°∫Â∫èÊúâÂèØËÉΩÂèòÊàê 1-&gt;3-&gt;2„ÄÇÊåá‰ª§ÈáçÊéíÂú®ÂçïÁ∫øÁ®ãÁéØÂ¢É‰∏ã‰∏ç‰ºöÂá∫Áé∞ÈóÆÈ¢òÔºå‰ΩÜÊòØÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏ã‰ºöÂØºËá¥‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂæóËøòÊ≤°ÊúâÂàùÂßãÂåñÁöÑÂÆû‰æã„ÄÇ</p>
<blockquote>
<p>‰æãÂ¶ÇÔºåÁ∫øÁ®ã T1 ÊâßË°å‰∫Ü 1 Âíå 3ÔºåÊ≠§Êó∂ T2 Ë∞ÉÁî® <code>getUInstance</code>() ÂêéÂèëÁé∞ <code>singleton</code> ‰∏ç‰∏∫Á©∫ÔºåÂõ†Ê≠§ËøîÂõû <code>singleton</code>Ôºå‰ΩÜÊ≠§Êó∂ <code>singleton</code> ËøòÊú™Ë¢´ÂàùÂßãÂåñ„ÄÇ</p>
</blockquote>
<h3 id="üåü‰∏∫‰ªÄ‰πàË¶ÅËøõË°åÊåá‰ª§ÈáçÊéíÔºü"><a href="#üåü‰∏∫‰ªÄ‰πàË¶ÅËøõË°åÊåá‰ª§ÈáçÊéíÔºü" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàË¶ÅËøõË°åÊåá‰ª§ÈáçÊéíÔºü"></a>üåü‰∏∫‰ªÄ‰πàË¶ÅËøõË°åÊåá‰ª§ÈáçÊéíÔºü</h3><p>ËÆ°ÁÆóÊú∫Âú®ÊâßË°åÁ®ãÂ∫èÁöÑËøáÁ®ã‰∏≠ÔºåÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®ÈÄöÂ∏∏‰ºöÂØπÊåá‰ª§ËøõË°åÈáçÊéíÂ∫èÔºåËøôÊ†∑ÂÅöÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÊèêÈ´òÊÄßËÉΩ„ÄÇ</p>
<p>Êåá‰ª§ÈáçÊéíÂ∫è‰∏ÄËà¨ÂàÜ‰∏∫ÁºñËØëÂô®‰ºòÂåñÈáçÊéí„ÄÅÊåá‰ª§Âπ∂Ë°åÈáçÊãçÂíåÂÜÖÂ≠òÁ≥ªÁªüÈáçÊéí‰∏âÁßç„ÄÇ</p>
<ul>
<li>  ÁºñËØëÂô®‰ºòÂåñÈáçÊéíÔºöÁºñËØëÂô®Âú®‰∏çÊîπÂèòÂçïÁ∫øÁ®ãÁ®ãÂ∫èËØ≠‰πâÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•ÂØπËØ≠Âè•ÁöÑÊâßË°åÈ°∫Â∫èËøõË°åÈáçÊñ∞ÊéíÂ∫è„ÄÇ</li>
<li>  Êåá‰ª§Âπ∂Ë°åÈáçÊéíÔºöÁé∞‰ª£Â§ÑÁêÜÂô®Â§öÈááÁî®Êåá‰ª§Á∫ßÂπ∂Ë°åÊäÄÊúØÊù•Â∞ÜÂ§öÊù°Êåá‰ª§ÈáçÂè†ÊâßË°å„ÄÇÂØπ‰∫é‰∏çÂ≠òÂú®<strong>Êï∞ÊçÆ‰æùËµñ</strong>ÁöÑÁ®ãÂ∫èÔºåÂ§ÑÁêÜÂô®ÂèØ‰ª•ÂØπÊú∫Âô®Êåá‰ª§ÁöÑÊâßË°åÈ°∫Â∫èËøõË°åÈáçÊñ∞ÊéíÂàó„ÄÇ</li>
<li>  ÂÜÖÂ≠òÁ≥ªÁªüÈáçÊéíÔºöÂõ†‰∏∫Â§ÑÁêÜÂô®‰ΩøÁî®ÁºìÂ≠òÂíåËØª/ÂÜôÁºìÂÜ≤Âå∫Ôºå‰ΩøÂæóÂä†ËΩΩÔºàloadÔºâÂíåÂ≠òÂÇ®ÔºàstoreÔºâÁúã‰∏äÂéªÂÉèÊòØÂú®‰π±Â∫èÊâßË°å„ÄÇ</li>
</ul>
<p>Ê≥®ÔºöÁÆÄÂçïËß£Èáä‰∏ãÊï∞ÊçÆ‰æùËµñÊÄßÔºöÂ¶ÇÊûú‰∏§‰∏™Êìç‰ΩúËÆøÈóÆ‰∫ÜÂêå‰∏Ä‰∏™ÂèòÈáèÔºåÂπ∂‰∏îËøô‰∏§‰∏™Êìç‰ΩúÊúâ‰∏Ä‰∏™ÊòØÂÜôÊìç‰ΩúÔºåËøô‰∏§‰∏™Êìç‰Ωú‰πãÈó¥Â∞±‰ºöÂ≠òÂú®Êï∞ÊçÆ‰æùËµñÊÄßÔºå‰æãÂ¶ÇÔºö</p>
<pre class="line-numbers language-java"><code class="language-java">a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
b <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Ëøô‰∏âÁßçÊåá‰ª§ÈáçÊéíËØ¥Êòé‰∫Ü‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ∞±ÊòØÊåá‰ª§ÈáçÊéíÂú®ÂçïÁ∫øÁ®ã‰∏ãÂèØ‰ª•ÊèêÈ´ò‰ª£Á†ÅÁöÑÊÄßËÉΩÔºå‰ΩÜÂú®Â§öÁ∫øÁ®ã‰∏ãÂèØ‰ª•‰ºöÂá∫Áé∞‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ</p>
<h3 id="üåüÊåá‰ª§ÈáçÊéí‰ºöÂ∏¶Êù•‰ªÄ‰πàÈóÆÈ¢òÔºü"><a href="#üåüÊåá‰ª§ÈáçÊéí‰ºöÂ∏¶Êù•‰ªÄ‰πàÈóÆÈ¢òÔºü" class="headerlink" title="üåüÊåá‰ª§ÈáçÊéí‰ºöÂ∏¶Êù•‰ªÄ‰πàÈóÆÈ¢òÔºü"></a>üåüÊåá‰ª§ÈáçÊéí‰ºöÂ∏¶Êù•‰ªÄ‰πàÈóÆÈ¢òÔºü</h3><p>Êåá‰ª§ÈáçÊéíÂú®ÂçïÁ∫øÁ®ã‰∏ãÂèØ‰ª•ÊèêÈ´ò‰ª£Á†ÅÁöÑÊÄßËÉΩÔºå‰ΩÜÂú®Â§öÁ∫øÁ®ã‰∏ã‰ºöÁ†¥ÂùèÁ®ãÂ∫èÁöÑËØ≠‰πâ</p>
<h3 id="üåüas-if-serialËßÑÂàôÂíåhappens-beforeËßÑÂàôÁöÑÂå∫Âà´Ôºü"><a href="#üåüas-if-serialËßÑÂàôÂíåhappens-beforeËßÑÂàôÁöÑÂå∫Âà´Ôºü" class="headerlink" title="üåüas-if-serialËßÑÂàôÂíåhappens-beforeËßÑÂàôÁöÑÂå∫Âà´Ôºü"></a>üåüas-if-serialËßÑÂàôÂíåhappens-beforeËßÑÂàôÁöÑÂå∫Âà´Ôºü</h3><h3 id="üåüÂÜÖÂ≠òÂ±èÈöúÁöÑÂéüÁêÜ"><a href="#üåüÂÜÖÂ≠òÂ±èÈöúÁöÑÂéüÁêÜ" class="headerlink" title="üåüÂÜÖÂ≠òÂ±èÈöúÁöÑÂéüÁêÜ"></a>üåüÂÜÖÂ≠òÂ±èÈöúÁöÑÂéüÁêÜ</h3><h3 id="üåüÁºñËØëÂô®ÂØπÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•ÁöÑ‰ºòÂåñ"><a href="#üåüÁºñËØëÂô®ÂØπÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•ÁöÑ‰ºòÂåñ" class="headerlink" title="üåüÁºñËØëÂô®ÂØπÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•ÁöÑ‰ºòÂåñ"></a>üåüÁºñËØëÂô®ÂØπÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•ÁöÑ‰ºòÂåñ</h3><h2 id="‚ù∏final"><a href="#‚ù∏final" class="headerlink" title="‚ù∏final"></a>‚ù∏final</h2><h3 id="üåü-finalÂü∫Á°Ä‰ΩøÁî®"><a href="#üåü-finalÂü∫Á°Ä‰ΩøÁî®" class="headerlink" title="üåü finalÂü∫Á°Ä‰ΩøÁî®"></a>üåü finalÂü∫Á°Ä‰ΩøÁî®</h3><ul>
<li><p><code>final</code> ‰øÆÈ•∞ÁöÑÁ±ª‰∏çËÉΩË¢´ÁªßÊâø</p>
</li>
<li><p><code>final</code> ‰øÆÈ•∞ÁöÑÊñπÊ≥ï‰∏çËÉΩË¢´ÈáçÂÜô</p>
</li>
<li><p><code>final</code> ‰øÆÈ•∞ÁöÑÂèòÈáèÊòØÂü∫Êú¨Êï∞ÊçÆÁ±ªÂûãÂàôÂÄº‰∏çËÉΩÊîπÂèò</p>
</li>
<li><p><code>final</code> ‰øÆÈ•∞ÁöÑÂèòÈáèÊòØÂºïÁî®Á±ªÂûãÂàô‰∏çËÉΩÂÜçÊåáÂêëÂÖ∂‰ªñÂØπË±°</p>
</li>
</ul>
<p> finalÊñπÊ≥ïÂèØ‰ª•Ë¢´ÈáçËΩΩÂêó? ÂèØ‰ª•</p>
<p>Áà∂Á±ªÁöÑfinalÊñπÊ≥ïËÉΩ‰∏çËÉΩÂ§üË¢´Â≠êÁ±ªÈáçÂÜô? ‰∏çÂèØ‰ª•</p>
<p>Â¶ÇÊûúÂ≠óÊÆµÁî±staticÂíåfinal‰øÆÈ•∞Ôºå‰ªÖËÉΩÂú®Â£∞ÊòéÊó∂ËµãÂÄºÊàñÂ£∞ÊòéÂêéÂú®ÈùôÊÄÅ‰ª£Á†ÅÂùó‰∏≠ËµãÂÄºÔºåÂõ†‰∏∫ËØ•Â≠óÊÆµÂ±û‰∫éËøô‰∏™Á±ª„ÄÇ</p>
<h3 id="üåüÊâÄÊúâfinal‰øÆÈ•∞ÁöÑÂ≠óÊÆµÈÉΩÊòØÁºñËØëÊúüÂ∏∏ÈáèÂêó"><a href="#üåüÊâÄÊúâfinal‰øÆÈ•∞ÁöÑÂ≠óÊÆµÈÉΩÊòØÁºñËØëÊúüÂ∏∏ÈáèÂêó" class="headerlink" title="üåüÊâÄÊúâfinal‰øÆÈ•∞ÁöÑÂ≠óÊÆµÈÉΩÊòØÁºñËØëÊúüÂ∏∏ÈáèÂêó"></a>üåüÊâÄÊúâfinal‰øÆÈ•∞ÁöÑÂ≠óÊÆµÈÉΩÊòØÁºñËØëÊúüÂ∏∏ÈáèÂêó</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//ÁºñËØëÊúüÂ∏∏Èáè</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> J <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//ÈùûÁºñËØëÊúüÂ∏∏Èáè</span>
    Random r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> k <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏çÊòØÊâÄÊúâÁöÑfinal‰øÆÈ•∞ÁöÑÂ≠óÊÆµÈÉΩÊòØÁºñËØëÊúüÂ∏∏ÈáèÔºåkÁöÑÂÄºÁî±ÈöèÊú∫Êï∞ÂØπË±°ÂÜ≥ÂÆöÔºåÂè™ÊòØkÁöÑÂÄºÂú®Ë¢´ÂàùÂßãÂåñÂêéÊó†Ê≥ïË¢´Êõ¥Êîπ„ÄÇ</p>
<h3 id="üåüËØ¥ËØ¥finalÁ±ªÂûãÁöÑÁ±ªÂ¶Ç‰ΩïÊãìÂ±ï"><a href="#üåüËØ¥ËØ¥finalÁ±ªÂûãÁöÑÁ±ªÂ¶Ç‰ΩïÊãìÂ±ï" class="headerlink" title="üåüËØ¥ËØ¥finalÁ±ªÂûãÁöÑÁ±ªÂ¶Ç‰ΩïÊãìÂ±ï?"></a>üåüËØ¥ËØ¥finalÁ±ªÂûãÁöÑÁ±ªÂ¶Ç‰ΩïÊãìÂ±ï?</h3><blockquote>
<p>ÊØîÂ¶ÇStringÊòØfinalÁ±ªÂûãÔºåÊàë‰ª¨ÊÉ≥ÂÜô‰∏™MyStringÂ§çÁî®ÊâÄÊúâString‰∏≠ÊñπÊ≥ïÔºåÂêåÊó∂Â¢ûÂä†‰∏Ä‰∏™Êñ∞ÁöÑtoMyString()ÁöÑÊñπÊ≥ïÔºåÂ∫îËØ•Â¶Ç‰ΩïÂÅö?</p>
</blockquote>
<p>ËÆæËÆ°Ê®°Âºè‰∏≠ÊúÄÈáçË¶ÅÁöÑ‰∏§ÁßçÂÖ≥Á≥ªÔºå‰∏ÄÁßçÊòØÁªßÊâø/ÂÆûÁé∞ÔºõÂè¶Â§ñ‰∏ÄÁßçÊòØÁªÑÂêàÂÖ≥Á≥ª„ÄÇÊâÄ‰ª•ÂΩìÈÅáÂà∞‰∏çËÉΩÁî®ÁªßÊâøÁöÑ(final‰øÆÈ•∞ÁöÑÁ±ª),Â∫îËØ•ËÄÉËôëÁî®ÁªÑÂêà, Â¶Ç‰∏ã‰ª£Á†ÅÂ§ßÊ¶ÇÂÜô‰∏™ÁªÑÂêàÂÆûÁé∞ÁöÑÊÑèÊÄùÔºö</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyString</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> String innerString<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// ...init &amp; other methods</span>

    <span class="token comment" spellcheck="true">// ÊîØÊåÅËÄÅÁöÑÊñπÊ≥ï</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> innerString<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ÈÄöËøáinnerStringË∞ÉÁî®ËÄÅÁöÑÊñπÊ≥ï</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// Ê∑ªÂä†Êñ∞ÊñπÊ≥ï</span>
    <span class="token keyword">public</span> String <span class="token function">toMyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="üåüËØ¥ËØ¥finalÂüüÈáçÊéíÂ∫èËßÑÂàô"><a href="#üåüËØ¥ËØ¥finalÂüüÈáçÊéíÂ∫èËßÑÂàô" class="headerlink" title="üåüËØ¥ËØ¥finalÂüüÈáçÊéíÂ∫èËßÑÂàô?"></a>üåüËØ¥ËØ¥finalÂüüÈáçÊéíÂ∫èËßÑÂàô?</h3><h3 id="üåüËØ¥ËØ¥finalÁöÑÂéüÁêÜ"><a href="#üåüËØ¥ËØ¥finalÁöÑÂéüÁêÜ" class="headerlink" title="üåüËØ¥ËØ¥finalÁöÑÂéüÁêÜ?"></a>üåüËØ¥ËØ¥finalÁöÑÂéüÁêÜ?</h3><h3 id="üåü‰ΩøÁî®-final-ÁöÑÈôêÂà∂Êù°‰ª∂ÂíåÂ±ÄÈôêÊÄß"><a href="#üåü‰ΩøÁî®-final-ÁöÑÈôêÂà∂Êù°‰ª∂ÂíåÂ±ÄÈôêÊÄß" class="headerlink" title="üåü‰ΩøÁî® final ÁöÑÈôêÂà∂Êù°‰ª∂ÂíåÂ±ÄÈôêÊÄß?"></a>üåü‰ΩøÁî® final ÁöÑÈôêÂà∂Êù°‰ª∂ÂíåÂ±ÄÈôêÊÄß?</h3><h3 id="üåüString‰∏∫‰ªÄ‰πà‰∏çÂèØÂèò"><a href="#üåüString‰∏∫‰ªÄ‰πà‰∏çÂèØÂèò" class="headerlink" title="üåüString‰∏∫‰ªÄ‰πà‰∏çÂèØÂèò"></a>üåüString‰∏∫‰ªÄ‰πà‰∏çÂèØÂèò</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">String</span> <span class="token keyword">implements</span> <span class="token class-name">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">,</span> Comparable<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">,</span> CharSequence <span class="token punctuation">{</span>         <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">char</span> value<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//...</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>String</code> ÂÜÖÈÉ®Áî® <code>private final</code> ‰øÆÈ•∞ <code>char</code> Êï∞ÁªÑÔºåÂπ∂‰∏î<code>String</code> Á±ªÊ≤°ÊúâÊèê‰æõÊö¥Èú≤‰øÆÊîπËøô‰∏™Êï∞ÁªÑÁöÑÊñπÊ≥ï„ÄÇ<ul>
<li>Áî® <code>final</code> ‰øÆÈ•∞ <code>char</code> Êï∞ÁªÑÔºåËøô‰∏™Êï∞ÁªÑÊó†Ê≥ïË¢´‰øÆÊîπ„ÄÇ(<strong>‰ªÖ‰ªÖÊòØÊåáÂºïÁî®Âú∞ÂùÄ‰∏çÂèØË¢´‰øÆÊîπ</strong>Ôºå<strong>Âπ∂ÈùûÊòØvalue[]Ëøô‰∏™Êï∞ÁªÑÁöÑÂÜÖÂÆπ‰∏çÂèØ‰øÆÊîπ</strong>)</li>
<li>Áî® <code>private</code> ‰øÆÈ•∞ <code>char</code> Êï∞ÁªÑÔºå‰∏î<code>String</code> Á±ª‰∏çÊèê‰æõ‰øÆÊîπËøô‰∏™Êï∞ÁªÑÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•ÂàùÂßãÂåñ‰πãÂêéÊàë‰ª¨Ê≤°Ê≥ïÊîπÂèòÊï∞ÁªÑÁöÑÂÜÖÂÆπ„ÄÇ</li>
</ul>
</li>
<li><code>String</code> Á±ªË¢´ <code>final</code> ‰øÆÈ•∞ÂØºËá¥ÂÖ∂‰∏çËÉΩË¢´ÁªßÊâøÔºåËøõËÄåÈÅøÂÖç‰∫ÜÂ≠êÁ±ªÁ†¥Âùè <code>String</code> ‰∏çÂèØÂèò„ÄÇ</li>
</ul>
<p>Java ‰ΩúËÄÖÂú® String ÁöÑÊâÄÊúâÊñπÊ≥ïÈáåÈù¢ÔºåÈÉΩÂæàÂ∞èÂøÉÂú∞ÈÅøÂÖçÂéª‰øÆÊîπ‰∫Ü char Êï∞ÁªÑ‰∏≠ÁöÑÊï∞ÊçÆÔºå<strong>Ê∂âÂèäÂà∞ÂØπ char Êï∞ÁªÑ‰∏≠Êï∞ÊçÆËøõË°å‰øÆÊîπÁöÑÊìç‰ΩúÂÖ®ÈÉ®ÈÉΩ‰ºöÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™ String ÂØπË±°</strong>„ÄÇÊØîÂ¶Ç substring ÊñπÊ≥ï</p>
<p>Â¶Ç‰ΩïËÆ©StringÂèØÂèò</p>
<p>valueÊòØÁßÅÊúâÂ±ûÊÄßÔºå‰Ω†Âè™ÈúÄË¶Å‰∏ÄÁßçÊñπÊ≥ïËÆøÈóÆÁ±ªÁöÑÁßÅÊúâÂ±ûÊÄßÂç≥ÂèØ„ÄÇ‰ΩøÁî®ÂèçÂ∞ÑÂèØ‰ª•Áõ¥Êé•‰øÆÊîπvalueÊï∞ÁªÑ‰∏≠ÁöÑÂÜÖÂÆπÔºåÂΩìÁÑ∂Âª∫ËÆÆ‰∏çË¶ÅËøôÊ†∑ÂÅö„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/MwaZqbXw9W0S30mXljQhuA">ÈòøÈáå‰∫ë‰∫åÈù¢Ôºö String ‰∏∫‰ªÄ‰πà‰∏çÂèØÂèòÔºü</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52173163/article/details/125227267"> ‰Ω†ÁúüÁöÑÁü•ÈÅìString‰∏çÂèØÂèòÁöÑÂéüÂõ†ÂêóÔºü</a></p>
<h1 id="‚ë¢Êó†ÈîÅ"><a href="#‚ë¢Êó†ÈîÅ" class="headerlink" title="‚ë¢Êó†ÈîÅ"></a>‚ë¢Êó†ÈîÅ</h1><h2 id="‚ù∂CAS"><a href="#‚ù∂CAS" class="headerlink" title="‚ù∂CAS"></a>‚ù∂CAS</h2><h3 id="üåü‰ªÄ‰πàÊòØCASÔºü"><a href="#üåü‰ªÄ‰πàÊòØCASÔºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØCASÔºü"></a>üåü‰ªÄ‰πàÊòØCASÔºü</h3><p>CASÂÖ®Áß∞<code>Compare And Swap</code>ÔºåÊØîËæÉ‰∏é‰∫§Êç¢ÔºåJava‰∏≠ÂèØ‰ª•ÈÄöËøáCASÊìç‰ΩúÊù•‰øùËØÅÂéüÂ≠êÊÄßÔºåÊòØ‰πêËßÇÈîÅÁöÑ‰∏ªË¶ÅÂÆûÁé∞ÊñπÂºè„ÄÇCASÂú®‰∏ç‰ΩøÁî®ÈîÅÁöÑÊÉÖÂÜµ‰∏ãÂÆûÁé∞Â§öÁ∫øÁ®ã‰πãÈó¥ÁöÑÂèòÈáèÂêåÊ≠•„ÄÇ<code>ReentrantLock</code>ÂÜÖÈÉ®ÁöÑAQSÂíåÂéüÂ≠êÁ±ªÂÜÖÈÉ®ÈÉΩ‰ΩøÁî®‰∫ÜCAS„ÄÇ</p>
<p>CASÁÆóÊ≥ïÊ∂âÂèäÂà∞‰∏â‰∏™Êìç‰ΩúÊï∞Ôºö</p>
<ul>
<li>ÈúÄË¶ÅËØªÂÜôÁöÑÂÜÖÂ≠òÂÄºVÔºàÂÜÖÂ≠òÂÄºÔºâ„ÄÇ</li>
<li>ËøõË°åÊØîËæÉÁöÑÂÄºAÔºàÊóßÂÄºÔºâ„ÄÇ</li>
<li>Ë¶ÅÂÜôÂÖ•ÁöÑÊñ∞ÂÄºBÔºàÊñ∞ÂÄºÔºâ„ÄÇ</li>
</ul>
<p>Âè™ÊúâÂΩìVÁöÑÂÄºÁ≠â‰∫éAÊó∂ÔºåÊâç‰ºö‰ΩøÁî®ÂéüÂ≠êÊñπÂºèÁî®Êñ∞ÂÄºBÊù•Êõ¥Êñ∞VÁöÑÂÄºÔºåÂê¶Âàô‰ºöÁªßÁª≠ÈáçËØïÁõ¥Âà∞ÊàêÂäüÊõ¥Êñ∞ÂÄº„ÄÇ</p>
<p>ÂΩìÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂Êìç‰Ωú‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÊó∂ÔºåÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÂØπÂèòÈáèËøõË°åÊàêÂäüÊõ¥Êñ∞ÔºåÂÖ∂‰ªñÁ∫øÁ®ãÂùá‰ºöÂ§±Ë¥•Ôºå‰ΩÜÊòØÂ§±Ë¥•Âπ∂‰∏ç‰ºöË¢´ÊåÇËµ∑ÔºåËøõË°åÂÜçÊ¨°Â∞ùËØïÔºå‰πüÂ∞±ÊòØËá™Êóã„ÄÇJava‰∏≠ÁöÑËá™ÊóãÈîÅÂ∞±ÊòØÂà©Áî®CASÊù•ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>ÂéüÂ≠êÊìç‰ΩúÁ±ªÊòØCASÂú®Java‰∏≠ÁöÑÂ∫îÁî®</p>
<h3 id="üåüCASÂ≠òÂú®ÁöÑÈóÆÈ¢òÂèä‰ºòÁÇπ"><a href="#üåüCASÂ≠òÂú®ÁöÑÈóÆÈ¢òÂèä‰ºòÁÇπ" class="headerlink" title="üåüCASÂ≠òÂú®ÁöÑÈóÆÈ¢òÂèä‰ºòÁÇπ"></a>üåüCASÂ≠òÂú®ÁöÑÈóÆÈ¢òÂèä‰ºòÁÇπ</h3><blockquote>
<p>ÂÖ∂‰∏≠ABAÈóÆÈ¢òÊòØÈù¢ËØï‰∏≠ÊØîËæÉÂ∏∏ËßÅÁöÑÈóÆÈ¢ò</p>
</blockquote>
<ul>
<li>  <strong>ABAÈóÆÈ¢ò</strong></li>
</ul>
<p>Âú®CASÁöÑÁÆóÊ≥ïÊµÅÁ®ã‰∏≠ÔºåÈ¶ñÂÖàË¶ÅÂÖàÊØîËæÉVÁöÑÂÄºÂíåAÁöÑÂÄºÔºåÂ¶ÇÊûúÁõ∏Á≠âÂàôËøõË°åÊõ¥Êñ∞„ÄÇ</p>
<p>ABA ÈóÆÈ¢òÔºöÂΩìËøõË°åËé∑Âèñ‰∏ªÂÜÖÂ≠òÂÄºÊó∂ÔºåËØ•ÂÜÖÂ≠òÂÄºÂú®ÂÜôÂÖ•‰∏ªÂÜÖÂ≠òÊó∂Â∑≤ÁªèË¢´‰øÆÊîπ‰∫Ü N Ê¨°Ôºå‰ΩÜÊòØÊúÄÁªàÂèàÊîπÊàêÂéüÊù•ÁöÑÂÄº„ÄÇÂç≥ÂÖ∂‰ªñÁ∫øÁ®ãÂÖàÊää A ÊîπÊàê B ÂèàÊîπÂõû AÔºå‰∏ªÁ∫øÁ®ã<strong>‰ªÖËÉΩÂà§Êñ≠Âá∫ÂÖ±‰∫´ÂèòÈáèÁöÑÂÄº‰∏éÊúÄÂàùÂÄº A ÊòØÂê¶Áõ∏Âêå</strong>Ôºå‰∏çËÉΩÊÑüÁü•Âà∞ËøôÁßç‰ªé A Êîπ‰∏∫ B Âèà ÊîπÂõû A ÁöÑÊÉÖÂÜµÔºåËøôÊó∂ CAS ËôΩÁÑ∂ÊàêÂäüÔºå‰ΩÜÊòØËøáÁ®ãÂ≠òÂú®ÈóÆÈ¢ò„ÄÇ</p>
<p>ABA ÈóÆÈ¢òÁöÑËß£ÂÜ≥ÊñπÂºèÔºöABA ÁöÑËß£ÂÜ≥ÊñπÊ≥ï‰πüÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂà©Áî®<strong>ÁâàÊú¨Âè∑</strong>„ÄÇÁªôÂèòÈáèÂä†‰∏ä‰∏Ä‰∏™ÁâàÊú¨Âè∑ÔºåÊØèÊ¨°ÂèòÈáèÊõ¥Êñ∞ÁöÑÊó∂ÂÄôÂ∞±ÊääÁâàÊú¨Âè∑Âä†1ÔºåËøôÊ†∑Âç≥‰Ωø ÊóßÂÄºA ÁöÑ‰ªé A‚Äî&gt;B‚Äî&gt;AÔºåÁâàÊú¨Âè∑‰πüÂèëÁîü‰∫ÜÂèòÂåñÔºåËøôÊ†∑Â∞±Ëß£ÂÜ≥‰∫ÜCASÂá∫Áé∞ÁöÑABAÈóÆÈ¢ò„ÄÇÂü∫‰∫éCASÁöÑ‰πêËßÇÈîÅ‰πüÊòØËøô‰∏™ÂÆûÁé∞ÂéüÁêÜ„ÄÇ</p>
<ul>
<li>  <strong>Âæ™ÁéØÊó∂Èó¥ËøáÈïøÂØºËá¥ÂºÄÈîÄÂ§™Â§ß</strong></li>
</ul>
<p>CASËá™ÊóãÊó∂Èó¥ËøáÈïø‰ºöÁªôCPUÂ∏¶Êù•ÈùûÂ∏∏Â§ßÁöÑÂºÄÈîÄÔºåÂú®JUC‰∏≠Êúâ‰∫õÂú∞ÊñπÂ∞±ÈôêÂà∂‰∫ÜCASËá™ÊóãÁöÑÊ¨°Êï∞Ôºå‰æãÂ¶ÇBlockingQueueÁöÑSynchronousQueue„ÄÇ</p>
<ul>
<li>  <strong>Âè™ËÉΩ‰øùËØÅ‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÂéüÂ≠êÊìç‰Ωú</strong></li>
</ul>
<p>Âú®Êìç‰Ωú‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÊó∂ÔºåÂèØ‰ª•ÈÄöËøáCASÁöÑÊñπÂºè‰øùËØÅÊìç‰ΩúÁöÑÂéüÂ≠êÊÄßÔºå‰ΩÜÂ¶ÇÊûúÂØπÂ§ö‰∏™ÂÖ±‰∫´ÂèòÈáèËøõË°åÊìç‰ΩúÊó∂ÔºåCASÂàôÊó†Ê≥ï‰øùËØÅÊìç‰ΩúÁöÑÂéüÂ≠êÊÄßÔºåËøôÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÁî®ÈîÅ‰∫Ü„ÄÇÂú®Áúã„ÄäJavaÂπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„ÄãÊó∂ÔºåÈáåÈù¢ÊèêÂà∞‰∫Ü‰∏Ä‰∏™ÂäûÊ≥ïÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ãÔºåÂ∞±ÊòØÂ∞ÜÂ§ö‰∏™ÂÖ±‰∫´ÂèòÈáèÂêàÂπ∂Êàê‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÊù•Êìç‰Ωú„ÄÇÊØîÂ¶ÇÔºåÊúâ‰∏§‰∏™ÂÖ±‰∫´ÂèòÈáè<code>i=2,j=a</code>ÔºåÂêàÂπ∂Êàê<code>ij=2a</code>ÔºåÁÑ∂ÂêéÁî®CASÊù•Êìç‰Ωú<code>ij</code>Ôºå‰ªéJava1.5ÂºÄÂßãJDKÊèê‰æõ‰∫Ü<strong>AtomicReference</strong>Á±ªÊù•‰øùËØÅÂºïÁî®ÂØπË±°‰πãÈó¥ÁöÑÂéüÂ≠êÊÄßÔºå‰Ω†ÂèØ‰ª•ÊääÂ§ö‰∏™ÂèòÈáèÊîæÂú®‰∏Ä‰∏™ÂØπË±°ÈáåÊù•ËøõË°åCASÊìç‰Ωú„ÄÇ</p>
<p>ÈÇ£‰πàCASÊúâ‰ªÄ‰πà‰ºòÁÇπÂë¢ÔºüÂú®Âπ∂ÂèëÈáè‰∏çÊòØÂæàÂ§ßÊó∂ÊèêÈ´òÊïàÁéá„ÄÇ </p>
<h3 id="üåüÂπ∂ÂèëÈòüÂàóÁöÑÊó†ÈîÅÂåñÂèØ‰ª•ÊÄé‰πàÂÆûÁé∞Ôºü"><a href="#üåüÂπ∂ÂèëÈòüÂàóÁöÑÊó†ÈîÅÂåñÂèØ‰ª•ÊÄé‰πàÂÆûÁé∞Ôºü" class="headerlink" title="üåüÂπ∂ÂèëÈòüÂàóÁöÑÊó†ÈîÅÂåñÂèØ‰ª•ÊÄé‰πàÂÆûÁé∞Ôºü"></a>üåüÂπ∂ÂèëÈòüÂàóÁöÑÊó†ÈîÅÂåñÂèØ‰ª•ÊÄé‰πàÂÆûÁé∞Ôºü</h3><p><code>Compare And Swap</code>ÔºåÊØîËæÉ‰∏é‰∫§Êç¢ÔºåJava‰∏≠ÂèØ‰ª•ÈÄöËøáCASÊìç‰ΩúÊù•‰øùËØÅÂéüÂ≠êÊÄßÔºåÊòØ‰πêËßÇÈîÅÁöÑ‰∏ªË¶ÅÂÆûÁé∞ÊñπÂºè„ÄÇ</p>
<h3 id="üåüËØ¥‰∏ãÂØπÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅÁöÑÁêÜËß£Ôºü"><a href="#üåüËØ¥‰∏ãÂØπÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅÁöÑÁêÜËß£Ôºü" class="headerlink" title="üåüËØ¥‰∏ãÂØπÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅÁöÑÁêÜËß£Ôºü"></a>üåüËØ¥‰∏ãÂØπÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅÁöÑÁêÜËß£Ôºü</h3><ul>
<li>  <strong>ÊÇ≤ËßÇÈîÅ</strong></li>
</ul>
<p>ÊÄªÊòØÂÅáËÆæÊúÄÂùèÁöÑÊÉÖÂÜµÔºåÊØèÊ¨°ÂéªÊãøÊï∞ÊçÆÁöÑÊó∂ÂÄôÈÉΩËÆ§‰∏∫Âà´‰∫∫‰ºö‰øÆÊîπÔºåÊâÄ‰ª•ÊØèÊ¨°Âú®ÊãøÊï∞ÊçÆÁöÑÊó∂ÂÄôÈÉΩ‰ºö‰∏äÈîÅÔºåËøôÊ†∑Âà´‰∫∫ÊÉ≥ÊãøËøô‰∏™Êï∞ÊçÆÂ∞±‰ºöÈòªÂ°ûÁõ¥Âà∞ÂÆÉÊãøÂà∞ÈîÅÔºàÂÖ±‰∫´ËµÑÊ∫êÊØèÊ¨°Âè™Áªô‰∏Ä‰∏™Á∫øÁ®ã‰ΩøÁî®ÔºåÂÖ∂ÂÆÉÁ∫øÁ®ãÈòªÂ°ûÔºåÁî®ÂÆåÂêéÂÜçÊääËµÑÊ∫êËΩ¨ËÆ©ÁªôÂÖ∂ÂÆÉÁ∫øÁ®ãÔºâ„ÄÇ‰º†ÁªüÁöÑÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÈáåËæπÂ∞±Áî®Âà∞‰∫ÜÂæàÂ§öËøôÁßçÈîÅÊú∫Âà∂ÔºåÊØîÂ¶ÇÔºöË°åÈîÅ„ÄÅË°®ÈîÅ„ÄÅËØªÈîÅ„ÄÅÂÜôÈîÅÁ≠âÔºåÈÉΩÊòØÂú®ÂÅöÊìç‰Ωú‰πãÂâçÂÖà‰∏äÈîÅ„ÄÇJava ‰∏≠ synchronized Âíå ReentrantLock Á≠âÁã¨Âç†ÈîÅÂ∞±ÊòØÊÇ≤ËßÇÈîÅÊÄùÊÉ≥ÁöÑÂÆûÁé∞„ÄÇ</p>
<ul>
<li>  <strong>‰πêËßÇÈîÅ</strong></li>
</ul>
<p>ÊÄªÊòØÂÅáËÆæÊúÄÂ•ΩÁöÑÊÉÖÂÜµÔºåÊØèÊ¨°ÂéªÊãøÊï∞ÊçÆÁöÑÊó∂ÂÄôÈÉΩËÆ§‰∏∫Âà´‰∫∫‰∏ç‰ºö‰øÆÊîπÔºåÊâÄ‰ª•‰∏ç‰ºö‰∏äÈîÅÔºå‰ΩÜÊòØÂú®Êõ¥Êñ∞ÁöÑÊó∂ÂÄô‰ºöÂà§Êñ≠‰∏Ä‰∏ãÂú®Ê≠§ÊúüÈó¥Âà´‰∫∫ÊúâÊ≤°ÊúâÂéªÊõ¥Êñ∞Ëøô‰∏™Êï∞ÊçÆÔºåÂèØ‰ª•‰ΩøÁî®ÁâàÊú¨Âè∑Êú∫Âà∂Âíå CAS ÁÆóÊ≥ïÂÆûÁé∞„ÄÇ‰πêËßÇÈîÅÈÄÇÁî®‰∫éÂ§öËØªÁöÑÂ∫îÁî®Á±ªÂûãÔºåËøôÊ†∑ÂèØ‰ª•ÊèêÈ´òÂêûÂêêÈáèÔºåÂÉèÊï∞ÊçÆÂ∫ìÊèê‰æõÁöÑÁ±ª‰ºº‰∫é write_condition Êú∫Âà∂ÔºåÂÖ∂ÂÆûÈÉΩÊòØÊèê‰æõÁöÑ‰πêËßÇÈîÅ„ÄÇÂú® Java ‰∏≠ java.util.concurrent.atomic ÂåÖ‰∏ãÈù¢ÁöÑÂéüÂ≠êÂèòÈáèÁ±ªÂ∞±ÊòØ‰ΩøÁî®‰∫Ü‰πêËßÇÈîÅÁöÑ‰∏ÄÁßçÂÆûÁé∞ÊñπÂºè CAS ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<ul>
<li>  <strong>‰∏§ÁßçÈîÅÁöÑ‰ΩøÁî®Âú∫ÊôØ</strong></li>
</ul>
<p>‰∏§ÁßçÈîÅÂêÑÊúâ‰ºòÁº∫ÁÇπÔºå‰∏çÂèØËÆ§‰∏∫‰∏ÄÁßçÂ•Ω‰∫éÂè¶‰∏ÄÁßçÔºå</p>
<ul>
<li><strong>ÊÇ≤ËßÇÈîÅÈÄÇÂêàÂÜôÊìç‰ΩúÂ§öÁöÑÂú∫ÊôØ</strong>ÔºåÂÖàÂä†ÈîÅÂèØ‰ª•‰øùËØÅÂÜôÊìç‰ΩúÊó∂Êï∞ÊçÆÊ≠£Á°Æ„ÄÇ</li>
<li><strong>‰πêËßÇÈîÅÈÄÇÂêàËØªÊìç‰ΩúÂ§öÁöÑÂú∫ÊôØ</strong>Ôºå‰∏çÂä†ÈîÅÁöÑÁâπÁÇπËÉΩÂ§ü‰ΩøÂÖ∂ËØªÊìç‰ΩúÁöÑÊÄßËÉΩÂ§ßÂπÖÊèêÂçá„ÄÇ</li>
</ul>
<h3 id="üåü‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅÁöÑÂå∫Âà´ÂèØ‰ª•ËØ¥‰∏Ä‰∏ãÂêóÔºü"><a href="#üåü‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅÁöÑÂå∫Âà´ÂèØ‰ª•ËØ¥‰∏Ä‰∏ãÂêóÔºü" class="headerlink" title="üåü‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅÁöÑÂå∫Âà´ÂèØ‰ª•ËØ¥‰∏Ä‰∏ãÂêóÔºü"></a>üåü‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅÁöÑÂå∫Âà´ÂèØ‰ª•ËØ¥‰∏Ä‰∏ãÂêóÔºü</h3><p>ÊÇ≤ËßÇÈîÅÔºå<strong>ÊØèÊ¨°ËÆøÈóÆËµÑÊ∫êÈÉΩ‰ºöÂä†ÈîÅ</strong>ÔºåÊâßË°åÂÆåÂêåÊ≠•‰ª£Á†ÅÈáäÊîæÈîÅÔºå<code>synchronized</code>Âíå<code>ReentrantLock</code>Â±û‰∫éÊÇ≤ËßÇÈîÅ„ÄÇ</p>
<p>‰πêËßÇÈîÅÔºå<strong>‰∏ç‰ºöÈîÅÂÆöËµÑÊ∫ê</strong>ÔºåÊâÄÊúâÁöÑÁ∫øÁ®ãÈÉΩËÉΩËÆøÈóÆÂπ∂‰øÆÊîπÂêå‰∏Ä‰∏™ËµÑÊ∫êÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÜ≤Á™ÅÂ∞±‰øÆÊîπÊàêÂäüÂπ∂ÈÄÄÂá∫ÔºåÂê¶ÂàôÂ∞±‰ºöÁªßÁª≠Âæ™ÁéØÂ∞ùËØï„ÄÇ‰πêËßÇÈîÅÊúÄÂ∏∏ËßÅÁöÑÂÆûÁé∞Â∞±ÊòØ<code>CAS</code>„ÄÇ</p>
<h3 id="üåü‰πêËßÇÈîÅÂ∏∏ËßÅÁöÑ‰∏§ÁßçÂÆûÁé∞ÊñπÂºèÊòØ‰ªÄ‰πàÔºü"><a href="#üåü‰πêËßÇÈîÅÂ∏∏ËßÅÁöÑ‰∏§ÁßçÂÆûÁé∞ÊñπÂºèÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåü‰πêËßÇÈîÅÂ∏∏ËßÅÁöÑ‰∏§ÁßçÂÆûÁé∞ÊñπÂºèÊòØ‰ªÄ‰πàÔºü"></a>üåü‰πêËßÇÈîÅÂ∏∏ËßÅÁöÑ‰∏§ÁßçÂÆûÁé∞ÊñπÂºèÊòØ‰ªÄ‰πàÔºü</h3><p>‰πêËßÇÈîÅ‰∏ÄËà¨‰ºö‰ΩøÁî®ÁâàÊú¨Âè∑Êú∫Âà∂ÊàñËÄÖ CAS ÁÆóÊ≥ïÂÆûÁé∞„ÄÇ</p>
<ul>
<li><p><strong>ÁâàÊú¨Âè∑Êú∫Âà∂</strong></p>
<p>‰∏ÄËà¨ÊòØÂú®Êï∞ÊçÆË°®‰∏≠Âä†‰∏ä‰∏Ä‰∏™Êï∞ÊçÆÁâàÊú¨Âè∑ version Â≠óÊÆµÔºåË°®Á§∫Êï∞ÊçÆË¢´‰øÆÊîπÁöÑÊ¨°Êï∞ÔºåÂΩìÊï∞ÊçÆË¢´‰øÆÊîπÊó∂Ôºåversion ÂÄº‰ºöÂä† 1„ÄÇÂΩìÁ∫øÁ®ã A Ë¶ÅÊõ¥Êñ∞Êï∞ÊçÆÂÄºÊó∂ÔºåÂú®ËØªÂèñÊï∞ÊçÆÁöÑÂêåÊó∂‰πü‰ºöËØªÂèñ version ÂÄºÔºåÂú®Êèê‰∫§Êõ¥Êñ∞Êó∂ÔºåËã•ÂàöÊâçËØªÂèñÂà∞ÁöÑ version ÂÄº‰∏∫ÂΩìÂâçÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑ version ÂÄºÁõ∏Á≠âÊó∂ÊâçÊõ¥Êñ∞ÔºåÂê¶ÂàôÈáçËØïÊõ¥Êñ∞Êìç‰ΩúÔºåÁõ¥Âà∞Êõ¥Êñ∞ÊàêÂäü„ÄÇ</p>
</li>
<li><p><strong>CAS ÁÆóÊ≥ï</strong></p>
<p>Âç≥ compare and swapÔºàÊØîËæÉ‰∏é‰∫§Êç¢ÔºâÔºåÊòØ‰∏ÄÁßçÊúâÂêçÁöÑÊó†ÈîÅÁÆóÊ≥ï„ÄÇÊó†ÈîÅÁºñÁ®ãÔºåÂç≥‰∏ç‰ΩøÁî®ÈîÅÁöÑÊÉÖÂÜµ‰∏ãÂÆûÁé∞Â§öÁ∫øÁ®ã‰πãÈó¥ÁöÑÂèòÈáèÂêåÊ≠•Ôºå‰πüÂ∞±ÊòØÂú®Ê≤°ÊúâÁ∫øÁ®ãË¢´ÈòªÂ°ûÁöÑÊÉÖÂÜµ‰∏ãÂÆûÁé∞ÂèòÈáèÁöÑÂêåÊ≠•ÔºåÊâÄ‰ª•‰πüÂè´ÈùûÈòªÂ°ûÂêåÊ≠•ÔºàNon-blocking SynchronizationÔºâ„ÄÇCAS ÁÆóÊ≥ïÊ∂âÂèäÂà∞‰∏â‰∏™Êìç‰ΩúÊï∞ÔºöÈúÄË¶ÅËØªÂÜôÁöÑÂÜÖÂ≠òÂÄº V„ÄÅËøõË°åÊØîËæÉÁöÑÂÄº A„ÄÅÊãüÂÜôÂÖ•ÁöÑÊñ∞ÂÄº B</p>
</li>
</ul>
<p>ÂΩì‰∏î‰ªÖÂΩì V ÁöÑÂÄºÁ≠â‰∫é A Êó∂ÔºåCAS ÈÄöËøáÂéüÂ≠êÊñπÂºèÁî®Êñ∞ÂÄº B Êù•Êõ¥Êñ∞ V ÁöÑÂÄºÔºåÂê¶Âàô‰∏ç‰ºöÊâßË°å‰ªª‰ΩïÊìç‰ΩúÔºàÊØîËæÉÂíåÊõøÊç¢ÊòØ‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÔºâ„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØ‰∏Ä‰∏™Ëá™ÊóãÊìç‰ΩúÔºåÂç≥‰∏çÊñ≠ÁöÑÈáçËØï„ÄÇ</p>
<h3 id="üåüCAS-Âíå-synchronized-ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºü"><a href="#üåüCAS-Âíå-synchronized-ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºü" class="headerlink" title="üåüCAS Âíå synchronized ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºü"></a>üåüCAS Âíå synchronized ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºü</h3><blockquote>
<p>ÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅÁöÑ‰ΩøÁî®Âú∫ÊôØ</p>
</blockquote>
<p>ÁÆÄÂçïÁöÑÊù•ËØ¥ CAS ÈÄÇÁî®‰∫éÂÜôÊØîËæÉÂ∞ëÁöÑÊÉÖÂÜµ‰∏ãÔºàÂ§öËØªÂú∫ÊôØÔºåÂÜ≤Á™Å‰∏ÄËà¨ËæÉÂ∞ëÔºâÔºåsynchronized ÈÄÇÁî®‰∫éÂÜôÊØîËæÉÂ§öÁöÑÊÉÖÂÜµ‰∏ãÔºàÂ§öÂÜôÂú∫ÊôØÔºåÂÜ≤Á™Å‰∏ÄËà¨ËæÉÂ§öÔºâ„ÄÇ</p>
<p>1„ÄÅÂØπ‰∫éËµÑÊ∫êÁ´û‰∫âËæÉÂ∞ëÔºàÁ∫øÁ®ãÂÜ≤Á™ÅËæÉËΩªÔºâÁöÑÊÉÖÂÜµÔºå‰ΩøÁî® synchronized ÂêåÊ≠•ÈîÅËøõË°åÁ∫øÁ®ãÈòªÂ°ûÂíåÂî§ÈÜíÂàáÊç¢‰ª•ÂèäÁî®Êà∑ÊÄÅÂÜÖÊ†∏ÊÄÅÈó¥ÁöÑÂàáÊç¢Êìç‰ΩúÈ¢ùÂ§ñÊµ™Ë¥πÊ∂àËÄó cpu ËµÑÊ∫êÔºõËÄå CAS Âü∫‰∫éÁ°¨‰ª∂ÂÆûÁé∞Ôºå‰∏çÈúÄË¶ÅËøõÂÖ•ÂÜÖÊ†∏Ôºå‰∏çÈúÄË¶ÅÂàáÊç¢Á∫øÁ®ãÔºåÊìç‰ΩúËá™ÊóãÂá†ÁéáËæÉÂ∞ëÔºåÂõ†Ê≠§ÂèØ‰ª•Ëé∑ÂæóÊõ¥È´òÁöÑÊÄßËÉΩ„ÄÇ</p>
<p>2„ÄÅÂØπ‰∫éËµÑÊ∫êÁ´û‰∫â‰∏•ÈáçÔºàÁ∫øÁ®ãÂÜ≤Á™Å‰∏•ÈáçÔºâÁöÑÊÉÖÂÜµÔºåCAS Ëá™ÊóãÁöÑÊ¶ÇÁéá‰ºöÊØîËæÉÂ§ßÔºå‰ªéËÄåÊµ™Ë¥πÊõ¥Â§öÁöÑ CPU ËµÑÊ∫êÔºåÊïàÁéá‰Ωé‰∫é synchronized„ÄÇ</p>
<h3 id="üåüJVM-‰∏≠ÁöÑ-CAS-ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºüÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÂë¢Ôºü"><a href="#üåüJVM-‰∏≠ÁöÑ-CAS-ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºüÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÂë¢Ôºü" class="headerlink" title="üåüJVM ‰∏≠ÁöÑ CAS ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºüÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÂë¢Ôºü"></a>üåüJVM ‰∏≠ÁöÑ CAS ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÔºüÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÂë¢Ôºü</h3><p>„ÄÇ„ÄÇ„ÄÇ„ÄÇ</p>
<p>CASÁöÑÂÖ®Áß∞‰∏∫<strong>Compare And Swap</strong>ÔºåÁõ¥ËØëÂ∞±ÊòØÊØîËæÉ‰∫§Êç¢„ÄÇÊòØ‰∏ÄÊù°CPUÁöÑÂéüÂ≠êÊåá‰ª§ÔºåÂÖ∂‰ΩúÁî®ÊòØËÆ©CPUÂÖàËøõË°åÊØîËæÉ‰∏§‰∏™ÂÄºÊòØÂê¶Áõ∏Á≠âÔºåÁÑ∂ÂêéÂéüÂ≠êÂú∞Êõ¥Êñ∞Êüê‰∏™‰ΩçÁΩÆÁöÑÂÄºÔºåÂÖ∂ÂÆûÁé∞ÊñπÂºèÊòØÂü∫‰∫éÁ°¨‰ª∂Âπ≥Âè∞ÁöÑÊ±áÁºñÊåá‰ª§ÔºåÂú®intelÁöÑCPU‰∏≠Ôºå‰ΩøÁî®ÁöÑÊòØcmpxchgÊåá‰ª§ÔºåÂ∞±ÊòØËØ¥CASÊòØÈù†Á°¨‰ª∂ÂÆûÁé∞ÁöÑÔºå‰ªéËÄåÂú®Á°¨‰ª∂Â±ÇÈù¢ÊèêÂçáÊïàÁéá„ÄÇ</p>
<h2 id="‚ù∑Atomic"><a href="#‚ù∑Atomic" class="headerlink" title="‚ù∑Atomic"></a>‚ù∑Atomic</h2><h3 id="üåüËØ∑ÈòêËø∞‰Ω†ÂØπUnsafeÁ±ªÁöÑÁêÜËß£"><a href="#üåüËØ∑ÈòêËø∞‰Ω†ÂØπUnsafeÁ±ªÁöÑÁêÜËß£" class="headerlink" title="üåüËØ∑ÈòêËø∞‰Ω†ÂØπUnsafeÁ±ªÁöÑÁêÜËß£?"></a>üåüËØ∑ÈòêËø∞‰Ω†ÂØπUnsafeÁ±ªÁöÑÁêÜËß£?</h3><p>Unsafe ÊòØ CAS ÁöÑÊ†∏ÂøÉÁ±ªÔºåÁî±‰∫é Java Êó†Ê≥ïÁõ¥Êé•ËÆøÈóÆÂ∫ïÂ±ÇÁ≥ªÁªüÔºåÈúÄË¶ÅÈÄöËøáÊú¨Âú∞ÔºàNativeÔºâÊñπÊ≥ïÊù•ËÆøÈóÆ</p>
<p>Unsafe Á±ªÂ≠òÂú® sun.misc ÂåÖÔºå‰∏ªË¶ÅÊèê‰æõ‰∏Ä‰∫õÁî®‰∫éÊâßË°å‰ΩéÁ∫ßÂà´„ÄÅ‰∏çÂÆâÂÖ®Êìç‰ΩúÁöÑÊñπÊ≥ïÔºåÂ¶ÇÁõ¥Êé•ËÆøÈóÆÁ≥ªÁªüÂÜÖÂ≠òËµÑÊ∫ê„ÄÅËá™‰∏ªÁÆ°ÁêÜÂÜÖÂ≠òËµÑÊ∫êÁ≠âÔºåÂÖ∂‰∏≠ÊâÄÊúâÊñπÊ≥ïÈÉΩÊòØ native ‰øÆÈ•∞ÁöÑÔºåÈÉΩÊòØÁõ¥Êé•Ë∞ÉÁî®<strong>Êìç‰ΩúÁ≥ªÁªüÂ∫ïÂ±ÇËµÑÊ∫ê</strong>ÊâßË°åÁõ∏Â∫îÁöÑ‰ªªÂä°ÔºåÂü∫‰∫éËØ•Á±ªÂèØ‰ª•Áõ¥Êé•Êìç‰ΩúÁâπÂÆöÁöÑÂÜÖÂ≠òÊï∞ÊçÆÔºåÂÖ∂ÂÜÖÈÉ®ÊñπÊ≥ïÊìç‰ΩúÁ±ª‰ºº C ÁöÑÊåáÈíàÔºåËøôÊó†Áñë‰πüÂ¢ûÂä†‰∫ÜÁ®ãÂ∫èÂèëÁîüÁõ∏ÂÖ≥ÊåáÈíàÈóÆÈ¢òÁöÑÈ£éÈô©„ÄÇÂú®Á®ãÂ∫è‰∏≠ËøáÂ∫¶„ÄÅ‰∏çÊ≠£Á°Æ‰ΩøÁî®UnsafeÁ±ª‰ºö‰ΩøÂæóÁ®ãÂ∫èÂá∫ÈîôÁöÑÊ¶ÇÁéáÂèòÂ§ßÔºå‰ΩøÂæóJavaËøôÁßçÂÆâÂÖ®ÁöÑËØ≠Ë®ÄÂèòÂæó‰∏çÂÜç‚ÄúÂÆâÂÖ®‚ÄùÔºåÂõ†Ê≠§ÂØπUnsafeÁöÑ‰ΩøÁî®‰∏ÄÂÆöË¶ÅÊÖéÈáç„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2019/02/14/talk-about-java-magic-class-unsafe.html">JavaÈ≠îÊ≥ïÁ±ªÔºöUnsafeÂ∫îÁî®Ëß£Êûê - ÁæéÂõ¢ÊäÄÊúØÂõ¢Èòü (meituan.com)</a></p>
<h3 id="üåüÁÆÄÂçïËØ¥‰∏ãÂØπ-Java-‰∏≠ÁöÑÂéüÂ≠êÁ±ªÁöÑÁêÜËß£Ôºü"><a href="#üåüÁÆÄÂçïËØ¥‰∏ãÂØπ-Java-‰∏≠ÁöÑÂéüÂ≠êÁ±ªÁöÑÁêÜËß£Ôºü" class="headerlink" title="üåüÁÆÄÂçïËØ¥‰∏ãÂØπ Java ‰∏≠ÁöÑÂéüÂ≠êÁ±ªÁöÑÁêÜËß£Ôºü"></a>üåüÁÆÄÂçïËØ¥‰∏ãÂØπ Java ‰∏≠ÁöÑÂéüÂ≠êÁ±ªÁöÑÁêÜËß£Ôºü</h3><blockquote>
<p>ÂåÖÂê´13‰∏™Ôºå4ÁªÑÂàÜÁ±ªÔºåËØ¥ËØ¥‰ΩúÁî®Âíå‰ΩøÁî®Âú∫ÊôØ„ÄÇ</p>
<p>Atomic Êåá‰∏Ä‰∏™Êìç‰ΩúÊòØ‰∏çÂèØ‰∏≠Êñ≠ÁöÑ„ÄÇÂç≥‰ΩøÊòØÂú®Â§ö‰∏™Á∫øÁ®ã‰∏ÄËµ∑ÊâßË°åÁöÑÊó∂ÂÄôÔºå‰∏Ä‰∏™Êìç‰Ωú‰∏ÄÊó¶ÂºÄÂßãÔºåÂ∞±‰∏ç‰ºöË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÂπ≤Êâ∞„ÄÇ</p>
</blockquote>
<p>ÂéüÂ≠êÊìç‰ΩúÁ±ªÊòØCASÂú®Java‰∏≠ÁöÑÂ∫îÁî®Ôºå‰ªéJDK1.5ÂºÄÂßãÊèê‰æõ‰∫Ü<code>java.util.concurrent.atomic</code>ÂåÖÔºåËøô‰∏™ÂåÖ‰∏≠ÁöÑÂéüÂ≠êÊìç‰ΩúÁ±ªÊèê‰æõ‰∫Ü‰∏ÄÁßçÁî®Ê≥ïÁÆÄÂçï„ÄÅÊÄßËÉΩÈ´òÊïà„ÄÅÁ∫øÁ®ãÂÆâÂÖ®Âú∞Êõ¥Êñ∞‰∏Ä‰∏™ÂèòÈáèÁöÑÊñπÂºè„ÄÇAtomicÂåÖÈáåÁöÑÁ±ªÂü∫Êú¨ÈÉΩÊòØ‰ΩøÁî®<code>Unsafe</code>ÂÆûÁé∞ÁöÑÂåÖË£ÖÁ±ª„ÄÇ</p>
<p>JUCÂåÖ‰∏≠ÁöÑ4ÁßçÂéüÂ≠êÁ±ª</p>
<ul>
<li><strong>Âü∫Êú¨Á±ªÂûã</strong>Ôºö‰ΩøÁî®ÂéüÂ≠êÁöÑÊñπÂºèÊõ¥Êñ∞Âü∫Êú¨Á±ªÂûã<ul>
<li>  <code>AtomicInteger</code>ÔºöÊï¥ÂΩ¢ÂéüÂ≠êÁ±ª</li>
<li>  <code>AtomicLong</code>ÔºöÈïøÊï¥ÂûãÂéüÂ≠êÁ±ª</li>
<li>  <code>AtomicBoolean</code>ÔºöÂ∏ÉÂ∞îÂûãÂéüÂ≠êÁ±ª</li>
</ul>
</li>
<li><strong>Êï∞ÁªÑÁ±ªÂûã</strong>Ôºö‰ΩøÁî®ÂéüÂ≠êÁöÑÊñπÂºèÊõ¥Êñ∞Êï∞ÁªÑÈáåÁöÑÊüê‰∏™ÂÖÉÁ¥†<ul>
<li>  <code>AtomicIntegerArray</code>ÔºöÊï¥ÂΩ¢Êï∞ÁªÑÂéüÂ≠êÁ±ª</li>
<li>  <code>AtomicLongArray</code>ÔºöÈïøÊï¥ÂΩ¢Êï∞ÁªÑÂéüÂ≠êÁ±ª</li>
<li>  <code>AtomicReferenceArray</code>ÔºöÂºïÁî®Á±ªÂûãÊï∞ÁªÑÂéüÂ≠êÁ±ª</li>
</ul>
</li>
<li><strong>ÂºïÁî®Á±ªÂûã</strong>Ôºö<ul>
<li>  <code>AtomicReference</code>ÔºöÂºïÁî®Á±ªÂûãÂéüÂ≠êÁ±ªÔºåÂ≠òÂú®ABAÈóÆÈ¢ò</li>
<li>  <code>AtomicStampedReference</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞Â∏¶ÊúâÁâàÊú¨Âè∑ÁöÑÂºïÁî®Á±ªÂûã„ÄÇËØ•Á±ªÂ∞ÜÊï¥Êï∞ÂÄº‰∏éÂºïÁî®ÂÖ≥ËÅîËµ∑Êù•ÔºåÂèØÁî®‰∫éÂéüÂ≠êÁöÑÊõ¥Êñ∞Êï∞ÊçÆÂíåÊï∞ÊçÆÁöÑÁâàÊú¨Âè∑ÔºåÂèØ‰ª•Ëß£ÂÜ≥‰ΩøÁî®CASËøõË°åÂéüÂ≠êÊõ¥Êñ∞Êó∂ÂèØËÉΩÂá∫Áé∞ÁöÑABAÈóÆÈ¢ò„ÄÇ</li>
<li>  <code>AtomicMarkableReference</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞Â∏¶ÊúâÊ†áËÆ∞‰ΩçÁöÑÂºïÁî®Á±ªÂûã</li>
</ul>
</li>
<li><strong>ÂéüÂ≠êÊõ¥Êñ∞Â≠óÊÆµÁ±ª</strong><ul>
<li>  <code>AtomicIntegerFieldUpdater</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞Êï¥ÂûãÁöÑÂ≠óÊÆµÁöÑÊõ¥Êñ∞Âô®„ÄÇ</li>
<li>  <code>AtomicLongFieldUpdater</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞ÈïøÊï¥ÂûãÂ≠óÊÆµÁöÑÊõ¥Êñ∞Âô®„ÄÇ</li>
<li>  <code>AtomicReferenceFieldUpdater</code>ÔºöÂºïÁî®Á±ªÂûãÊõ¥Êñ∞Âô®ÂéüÂ≠êÁ±ª</li>
</ul>
</li>
</ul>
<h3 id="üåüAtomicIntegerÂ∫ïÂ±ÇÂÆûÁé∞-CAS-volatile"><a href="#üåüAtomicIntegerÂ∫ïÂ±ÇÂÆûÁé∞-CAS-volatile" class="headerlink" title="üåüAtomicIntegerÂ∫ïÂ±ÇÂÆûÁé∞? CAS+volatile"></a>üåüAtomicIntegerÂ∫ïÂ±ÇÂÆûÁé∞? CAS+volatile</h3><h3 id="üåüatomic-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"><a href="#üåüatomic-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüatomic ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"></a>üåüatomic ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü</h3><p>Atomic ÂåÖ‰∏≠ÁöÑÁ±ªÂü∫Êú¨ÁöÑÁâπÊÄßÂ∞±ÊòØÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏ãÔºåÂΩìÊúâÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ÂØπÂçï‰∏™ÔºàÂåÖÊã¨Âü∫Êú¨Á±ªÂûãÂèäÂºïÁî®Á±ªÂûãÔºâÂèòÈáèËøõË°åÊìç‰ΩúÊó∂ÔºåÂÖ∑ÊúâÊéí‰ªñÊÄßÔºåÂç≥ÂΩìÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ÂØπËØ•ÂèòÈáèÁöÑÂÄºËøõË°åÊõ¥Êñ∞Êó∂Ôºå‰ªÖÊúâ‰∏Ä‰∏™Á∫øÁ®ãËÉΩÊàêÂäüÔºåËÄåÊú™ÊàêÂäüÁöÑÁ∫øÁ®ãÂèØ‰ª•ÂêëËá™ÊóãÈîÅ‰∏ÄÊ†∑ÔºåÁªßÁª≠Â∞ùËØïÔºå‰∏ÄÁõ¥Á≠âÂà∞ÊâßË°åÊàêÂäü„ÄÇ</p>
<p>Atomic Á≥ªÂàóÁöÑÁ±ª‰∏≠ÁöÑÊ†∏ÂøÉÊñπÊ≥ïÈÉΩ‰ºöË∞ÉÁî® unsafe Á±ª‰∏≠ÁöÑÂá†‰∏™Êú¨Âú∞ÊñπÊ≥ï„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÖàÁü•ÈÅì‰∏Ä‰∏™‰∏úË•øÂ∞±ÊòØ Unsafe Á±ªÔºåÂÖ®Âêç‰∏∫Ôºösun.misc.UnsafeÔºåËøô‰∏™Á±ªÂåÖÂê´‰∫ÜÂ§ßÈáèÁöÑÂØπ C ‰ª£Á†ÅÁöÑÊìç‰ΩúÔºåÂåÖÊã¨ÂæàÂ§öÁõ¥Êé•ÂÜÖÂ≠òÂàÜÈÖç‰ª•ÂèäÂéüÂ≠êÊìç‰ΩúÁöÑË∞ÉÁî®ÔºåËÄåÂÆÉ‰πãÊâÄ‰ª•Ê†áËÆ∞‰∏∫ÈùûÂÆâÂÖ®ÁöÑÔºåÊòØÂëäËØâ‰Ω†Ëøô‰∏™ÈáåÈù¢Â§ßÈáèÁöÑÊñπÊ≥ïË∞ÉÁî®ÈÉΩ‰ºöÂ≠òÂú®ÂÆâÂÖ®ÈöêÊÇ£ÔºåÈúÄË¶ÅÂ∞èÂøÉ‰ΩøÁî®ÔºåÂê¶Âàô‰ºöÂØºËá¥‰∏•ÈáçÁöÑÂêéÊûúÔºå‰æãÂ¶ÇÂú®ÈÄöËøá unsafe ÂàÜÈÖçÂÜÖÂ≠òÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúËá™Â∑±ÊåáÂÆöÊüê‰∫õÂå∫ÂüüÂèØËÉΩ‰ºöÂØºËá¥‰∏Ä‰∫õÁ±ª‰ºº C++ ‰∏ÄÊ†∑ÁöÑÊåáÈíàË∂äÁïåÂà∞ÂÖ∂‰ªñËøõÁ®ãÁöÑÈóÆÈ¢ò„ÄÇ</p>
<h2 id="‚ù∏ThreadLocal"><a href="#‚ù∏ThreadLocal" class="headerlink" title="‚ù∏ThreadLocal"></a>‚ù∏ThreadLocal</h2><h3 id="üåü‰ªÄ‰πàÊòØThreadLocalÔºü"><a href="#üåü‰ªÄ‰πàÊòØThreadLocalÔºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØThreadLocalÔºü"></a>üåü‰ªÄ‰πàÊòØThreadLocalÔºü</h3><p><code>ThreadLocal</code>ÊòØ JDK <code>java.lang</code> ÂåÖ‰∏ãÁöÑ‰∏Ä‰∏™Á±ªÔºå<code>ThreadLocal</code>‰∏∫ÂèòÈáèÂú®ÊØè‰∏™Á∫øÁ®ã‰∏≠ÈÉΩÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂâØÊú¨ÔºåÈÇ£‰πàÊØè‰∏™Á∫øÁ®ãÂèØ‰ª•ËÆøÈóÆËá™Â∑±ÂÜÖÈÉ®ÁöÑÂâØÊú¨ÂèòÈáèÔºåÂπ∂‰∏î‰∏ç‰ºöÂíåÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÂ±ÄÈÉ®ÂèòÈáèÂÜ≤Á™ÅÔºåÂÆûÁé∞‰∫ÜÁ∫øÁ®ãÈó¥ÁöÑÊï∞ÊçÆÈöîÁ¶ª„ÄÇÂàÜÈÖçÂú®Â†ÜÂÜÖÁöÑ <strong>TLAB</strong> ‰∏≠</p>
<h3 id="üåüThreadLocal-Ëß£ÂÜ≥‰∫ÜÂì™‰∫õÈóÆÈ¢ò"><a href="#üåüThreadLocal-Ëß£ÂÜ≥‰∫ÜÂì™‰∫õÈóÆÈ¢ò" class="headerlink" title="üåüThreadLocal Ëß£ÂÜ≥‰∫ÜÂì™‰∫õÈóÆÈ¢ò"></a>üåüThreadLocal Ëß£ÂÜ≥‰∫ÜÂì™‰∫õÈóÆÈ¢ò</h3><blockquote>
<p>ThreadLocal Êúâ‰ªÄ‰πàÁî®ÔºüÁî®Êù•Ëß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÁöÑ?</p>
<p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂàõÂª∫ÁöÑÂèòÈáèÊòØÂèØ‰ª•Ë¢´‰ªª‰Ωï‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÂπ∂‰øÆÊîπÁöÑ„ÄÇÂ¶ÇÊûúÊÉ≥ÂÆûÁé∞ÊØè‰∏Ä‰∏™Á∫øÁ®ãÈÉΩÊúâËá™Â∑±ÁöÑ‰∏ìÂ±ûÊú¨Âú∞ÂèòÈáèËØ•Â¶Ç‰ΩïËß£ÂÜ≥Âë¢Ôºü</p>
</blockquote>
<p><code>ThreadLocal</code>Á±ªÊ≠£ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ËøôÊ†∑ÁöÑÈóÆÈ¢ò„ÄÇ <strong><code>ThreadLocal</code>Á±ª‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÂ∞±ÊòØËÆ©ÊØè‰∏™Á∫øÁ®ãÁªëÂÆöËá™Â∑±ÁöÑÂÄºÔºåÂÆûÁé∞‰∫ÜÁ∫øÁ®ãÈó¥ÁöÑÊï∞ÊçÆÈöîÁ¶ª</strong></p>
<p>Â¶ÇÊûú‰Ω†ÂàõÂª∫‰∫Ü‰∏Ä‰∏™<code>ThreadLocal</code>ÂèòÈáèÔºåÈÇ£‰πàËÆøÈóÆËøô‰∏™ÂèòÈáèÁöÑÊØè‰∏™Á∫øÁ®ãÈÉΩ‰ºöÊúâËøô‰∏™ÂèòÈáèÁöÑÊú¨Âú∞ÂâØÊú¨ÔºåËøô‰πüÊòØ<code>ThreadLocal</code>ÂèòÈáèÂêçÁöÑÁî±Êù•„ÄÇ‰ªñ‰ª¨ÂèØ‰ª•‰ΩøÁî® <code>get()</code> Âíå <code>set()</code> ÊñπÊ≥ïÊù•Ëé∑ÂèñÈªòËÆ§ÂÄºÊàñÂ∞ÜÂÖ∂ÂÄºÊõ¥Êîπ‰∏∫ÂΩìÂâçÁ∫øÁ®ãÊâÄÂ≠òÁöÑÂâØÊú¨ÁöÑÂÄºÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ</p>
<p>ThreadLocal ‰ΩúÁî®Ôºö</p>
<ul>
<li><p>Á∫øÁ®ãÂπ∂ÂèëÔºöÂ∫îÁî®Âú®Â§öÁ∫øÁ®ãÂπ∂ÂèëÁöÑÂú∫ÊôØ‰∏ã</p>
</li>
<li><p>‰º†ÈÄíÊï∞ÊçÆÔºöÈÄöËøá ThreadLocal ÂÆûÁé∞Âú®Âêå‰∏ÄÁ∫øÁ®ã‰∏çÂêåÂáΩÊï∞ÊàñÁªÑ‰ª∂‰∏≠‰º†ÈÄíÂÖ¨ÂÖ±ÂèòÈáèÔºåÂáèÂ∞ë‰º†ÈÄíÂ§çÊùÇÂ∫¶</p>
</li>
<li><p>Á∫øÁ®ãÈöîÁ¶ªÔºöÊØè‰∏™Á∫øÁ®ãÁöÑÂèòÈáèÈÉΩÊòØÁã¨Á´ãÁöÑÔºå‰∏ç‰ºö‰∫íÁõ∏ÂΩ±Âìç</p>
</li>
</ul>
<h3 id="üåüThreadLocalÂéüÁêÜÔºüThreadLocalÊòØÂ¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÈöîÁ¶ªÁöÑ"><a href="#üåüThreadLocalÂéüÁêÜÔºüThreadLocalÊòØÂ¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÈöîÁ¶ªÁöÑ" class="headerlink" title="üåüThreadLocalÂéüÁêÜÔºüThreadLocalÊòØÂ¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÈöîÁ¶ªÁöÑ?"></a>üåüThreadLocalÂéüÁêÜÔºüThreadLocalÊòØÂ¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÈöîÁ¶ªÁöÑ?</h3><p>JDK8 ‰ª•ÂêéÔºöÊØè‰∏™ Thread ÂÜÖÈÉ®Áª¥Êä§‰∏Ä‰∏™ ThreadLocalMapÔºåËøô‰∏™ Map ÁöÑ key ÊòØ ThreadLocal ÂÆû‰æãÊú¨Ë∫´Ôºåvalue ÊòØÁúüÊ≠£Ë¶ÅÂ≠òÂÇ®ÁöÑÂÄº</p>
<ul>
<li>Thread ÂÜÖÈÉ®ÁöÑ Map ÊòØÁî± ThreadLocal Áª¥Êä§ÁöÑÔºåÁî± ThreadLocal Ë¥üË¥£Âêë map Ëé∑ÂèñÂíåËÆæÁΩÆÁ∫øÁ®ãÁöÑÂèòÈáèÂÄº</li>
<li>ÂØπ‰∫é‰∏çÂêåÁöÑÁ∫øÁ®ãÔºåÊØèÊ¨°Ëé∑ÂèñÂâØÊú¨ÂÄºÊó∂ÔºåÂà´ÁöÑÁ∫øÁ®ãÂπ∂‰∏çËÉΩËé∑ÂèñÂà∞ÂΩìÂâçÁ∫øÁ®ãÁöÑÂâØÊú¨ÂÄºÔºåÂΩ¢ÊàêÂâØÊú¨ÁöÑÈöîÁ¶ªÔºå‰∫í‰∏çÂπ≤Êâ∞</li>
</ul>
<p><img src="https://img.jwt1399.top/img/202301032103152.png"></p>
<p>ÊØè‰∏™Á∫øÁ®ãÈÉΩÊúâ‰∏Ä‰∏™<code>ThreadLocalMap</code>Ôºà<code>ThreadLocal</code>ÂÜÖÈÉ®Á±ªÔºâÔºåMap‰∏≠ÂÖÉÁ¥†ÁöÑÈîÆ‰∏∫<code>ThreadLocal</code>ÔºåËÄåÂÄºÂØπÂ∫îÁ∫øÁ®ãÁöÑÂèòÈáèÂâØÊú¨„ÄÇ</p>
<p>Ë∞ÉÁî®<code>threadLocal.set()</code>‚Äì&gt;Ë∞ÉÁî®<code>getMap(Thread)</code>‚Äì&gt;ËøîÂõûÂΩìÂâçÁ∫øÁ®ãÁöÑ<code>ThreadLocalMap&lt;ThreadLocal, value&gt;</code>‚Äì&gt;<code>map.set(this, value)</code>ÔºåthisÊòØ<code>threadLocal</code>Êú¨Ë∫´„ÄÇÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-Java"><code class="language-Java">public void set(T value) {
    Thread t = Thread.currentThread();
    ThreadLocalMap map = getMap(t);
    if (map != null)
        map.set(this, value);
    else
        createMap(t, value);
}

ThreadLocalMap getMap(Thread t) {
    return t.threadLocals;
}

void createMap(Thread t, T firstValue) {
    t.threadLocals = new ThreadLocalMap(this, firstValue);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ë∞ÉÁî®<code>get()</code>‚Äì&gt;Ë∞ÉÁî®<code>getMap(Thread)</code>‚Äì&gt;ËøîÂõûÂΩìÂâçÁ∫øÁ®ãÁöÑ<code>ThreadLocalMap&lt;ThreadLocal, value&gt;</code>‚Äì&gt;<code>map.getEntry(this)</code>ÔºåËøîÂõû<code>value</code>„ÄÇÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> T <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Thread t <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ThreadLocalMap map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ThreadLocalMap<span class="token punctuation">.</span>Entry e <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
      T result <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span>e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="üåüThreadLocalÊúâÂì™‰∫õÂ∫îÁî®Âú∫ÊôØÔºü"><a href="#üåüThreadLocalÊúâÂì™‰∫õÂ∫îÁî®Âú∫ÊôØÔºü" class="headerlink" title="üåüThreadLocalÊúâÂì™‰∫õÂ∫îÁî®Âú∫ÊôØÔºü"></a>üåüThreadLocalÊúâÂì™‰∫õÂ∫îÁî®Âú∫ÊôØÔºü</h3><p><code>ThreadLocal</code>ÁöÑÂ∫îÁî®Âú∫ÊôØ‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂá†‰∏™ÊñπÈù¢Ôºö</p>
<ul>
<li><p>ÊØè‰∏™Á∫øÁ®ãÈúÄË¶ÅÊúâËá™Â∑±ÂçïÁã¨ÁöÑÂÆû‰æã</p>
</li>
<li><p>ÂÆû‰æãÈúÄË¶ÅÂú®Â§ö‰∏™ÊñπÊ≥ï‰∏≠ÂÖ±‰∫´Ôºå‰ΩÜ‰∏çÂ∏åÊúõË¢´Â§öÁ∫øÁ®ãÂÖ±‰∫´</p>
</li>
<li><p>‰øùÂ≠òÁ∫øÁ®ã‰∏ä‰∏ãÊñá‰ø°ÊÅØÔºåÂú®ÈúÄË¶ÅÁöÑÂú∞ÊñπÂèØ‰ª•Ëé∑Âèñ</p>
</li>
<li><p>Á∫øÁ®ãÈó¥Êï∞ÊçÆÈöîÁ¶ª</p>
</li>
<li><p>Êï∞ÊçÆÂ∫ìËøûÊé•</p>
</li>
<li><p>sessionÁÆ°ÁêÜ</p>
</li>
<li><p>Áî®‰∫é‰øùÂ≠òÁ∫øÁ®ã‰∏çÂÆâÂÖ®ÁöÑÂ∑•ÂÖ∑Á±ªÔºåSimpleDateFormat</p>
</li>
</ul>
<h3 id="üåüThreadLocal‰∏∫‰ªÄ‰πà‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÈú≤-Â¶Ç‰ΩïËß£ÂÜ≥"><a href="#üåüThreadLocal‰∏∫‰ªÄ‰πà‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÈú≤-Â¶Ç‰ΩïËß£ÂÜ≥" class="headerlink" title="üåüThreadLocal‰∏∫‰ªÄ‰πà‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÈú≤? Â¶Ç‰ΩïËß£ÂÜ≥"></a>üåüThreadLocal‰∏∫‰ªÄ‰πà‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÈú≤? Â¶Ç‰ΩïËß£ÂÜ≥</h3><blockquote>
<p>ThreadLocal ÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢òÊòØÊÄé‰πàÂØºËá¥ÁöÑÔºü</p>
<p>ThreadLocal ÂÜÖÂ≠òÊ≥ÑÊºèÂ¶Ç‰ΩïËß£ÂÜ≥</p>
<p>ThreadLocal ÂÜÖÈÉ®Â¶Ç‰ΩïÈò≤Ê≠¢ÂÜÖÂ≠òÊ≥ÑÊºèÔºåÂú®Âì™‰∫õÊñπÊ≥ï‰∏≠Â≠òÂú®</p>
</blockquote>
<p><code>ThreadLocalMap</code> ‰∏≠‰ΩøÁî®ÁöÑ key ‰∏∫ <code>ThreadLocal</code> ÁöÑÂº±ÂºïÁî®ÔºåËÄå value ÊòØÂº∫ÂºïÁî®„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú <code>ThreadLocal</code> Ê≤°ÊúâË¢´Â§ñÈÉ®Âº∫ÂºïÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂú®ÂûÉÂúæÂõûÊî∂ÁöÑÊó∂ÂÄôÔºåkey ‰ºöË¢´Ê∏ÖÁêÜÊéâÔºåËÄå value ‰∏ç‰ºöË¢´Ê∏ÖÁêÜÊéâ„ÄÇ</p>
<p>ËøôÊ†∑‰∏ÄÊù•Ôºå<code>ThreadLocalMap</code> ‰∏≠Â∞±‰ºöÂá∫Áé∞ key ‰∏∫ null ÁöÑ Entry„ÄÇÂÅáÂ¶ÇÊàë‰ª¨‰∏çÂÅö‰ªª‰ΩïÊé™ÊñΩÁöÑËØùÔºåvalue Ê∞∏ËøúÊó†Ê≥ïË¢´ GC ÂõûÊî∂ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØËÉΩ‰ºö‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ</p>
<p><strong>Â¶Ç‰ΩïËß£ÂÜ≥</strong></p>
<p><code>ThreadLocalMap</code> ÂÆûÁé∞‰∏≠Â∑≤ÁªèËÄÉËôë‰∫ÜËøôÁßçÊÉÖÂÜµÔºåÂú®Ë∞ÉÁî® <code>set()</code>„ÄÅ<code>get()</code>„ÄÅ<code>remove()</code> ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºö‰∏ªÂä®Ê∏ÖÁêÜÊéâ key ‰∏∫ null  ÁöÑÊó†Êïà Entry Êù•ÈÅøÂÖçÂÜÖÂ≠òÊ≥ÑÊºèÈóÆÈ¢ò„ÄÇ</p>
<p>Ë¶ÅÂΩªÂ∫ïËß£ÂÜ≥ÂÜÖÂ≠òÊ≥ÑÊºèÈóÆÈ¢òÔºöÊØèÊ¨°‰Ωø‚Ω§ÂÆå<code>ThreadLocal</code>Â∞±Ë∞É‚Ω§ÂÆÉÁöÑ<code>remove()</code>‚ΩÖÊ≥ïÔºåÊúÄÂ•ΩÊâãÂä®Â∞ÜÂØπÂ∫îÁöÑÈîÆÂÄºÂØπÂà†Èô§Ôºå‰ªé‚ΩΩÈÅøÂÖçÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇ</p>
<h3 id="üåüThreadLocal-Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ"><a href="#üåüThreadLocal-Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ" class="headerlink" title="üåüThreadLocal Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ"></a>üåüThreadLocal Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ</h3><p>ThreadLocal Â∫ïÂ±ÇÊòØÈÄöËøá ThreadLocalMap Ëøô‰∏™ÈùôÊÄÅÂÜÖÈÉ®Á±ªÊù•Â≠òÂÇ®Êï∞ÊçÆÁöÑÔºåThreadLocalMap Â∞±ÊòØ‰∏Ä‰∏™ÈîÆÂÄºÂØπÁöÑ MapÔºåÂÆÉÁöÑÂ∫ïÂ±ÇÊòØ Entry ÂØπË±°Êï∞ÁªÑÔºåEntry ÂØπË±°‰∏≠Â≠òÊîæÁöÑÈîÆÊòØ ThreadLocal ÂØπË±°ÔºåÂÄºÊòØ Object Á±ªÂûãÁöÑÂÖ∑‰ΩìÂ≠òÂÇ®ÂÜÖÂÆπ„ÄÇ</p>
<h3 id="üåüThreadLocalMap-ÁöÑÊï£ÂàóÊñπÂºè"><a href="#üåüThreadLocalMap-ÁöÑÊï£ÂàóÊñπÂºè" class="headerlink" title="üåüThreadLocalMap ÁöÑÊï£ÂàóÊñπÂºè"></a>üåüThreadLocalMap ÁöÑÊï£ÂàóÊñπÂºè</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Ëé∑ÂèñÂΩìÂâç ThreadLocal ÂØπË±°ÁöÑÊï£ÂàóÂÄº</span>
<span class="token keyword">int</span> i <span class="token operator">=</span> key<span class="token punctuation">.</span>threadLocalHashCode <span class="token operator">&amp;</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ËøôË°å‰ª£Á†ÅÂæóÂà∞ÁöÑÂÄºÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ ThreadLocal ÂØπË±°ÁöÑÊï£ÂàóÂÄºÔºåËøôÂ∞±ÊòØ ThreadLocal ÁöÑÊï£ÂàóÊñπÂºèÔºåÊàë‰ª¨Áß∞‰πã‰∏∫ <strong>ÊñêÊ≥¢ÈÇ£Â•ëÊï£Âàó</strong> „ÄÇ</p>
<p>ThreadLocal ÁöÑÊï£ÂàóÊñπÂºèÁß∞‰πã‰∏∫<strong>ÊñêÊ≥¢ÈÇ£Â•ëÊï£Âàó</strong>ÔºåÊØèÊ¨°Ëé∑ÂèñÂìàÂ∏åÂÄºÈÉΩ‰ºöÂä†‰∏ä <code>HASH_INCREMENT</code>ÔºåËøôÊ†∑ÂÅöÂèØ‰ª•Â∞ΩÈáèÈÅøÂÖç hash ÂÜ≤Á™ÅÔºåËÆ©ÂìàÂ∏åÂÄºËÉΩÂùáÂåÄÁöÑÂàÜÂ∏ÉÂú® 2 ÁöÑ n Ê¨°ÊñπÁöÑÊï∞ÁªÑ‰∏≠</p>
<ul>
<li><p>ËÆ°ÁÆó ThreadLocal ÂØπË±°ÁöÑÂìàÂ∏åÂÄºÔºö</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> threadLocalHashCode <span class="token operator">=</span> <span class="token function">nextHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">nextHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> nextHashCode<span class="token punctuation">.</span><span class="token function">getAndAdd</span><span class="token punctuation">(</span>HASH_INCREMENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>ÊØèÂàõÂª∫‰∏Ä‰∏™ ThreadLocal ÂØπË±°Â∞±‰ºö‰ΩøÁî® nextHashCode ÂàÜÈÖç‰∏Ä‰∏™ hash ÂÄºÁªôËøô‰∏™ÂØπË±°Ôºö</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> AtomicInteger nextHashCode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>ÊñêÊ≥¢ÈÇ£Â•ëÊï∞‰πüÂè´ÈªÑÈáëÂàÜÂâ≤Êï∞Ôºåhash ÁöÑ<strong>Â¢ûÈáè</strong>Â∞±ÊòØËøô‰∏™Êï∞Â≠óÔºåÂ∏¶Êù•ÁöÑÂ•ΩÂ§ÑÊòØ hash ÂàÜÂ∏ÉÈùûÂ∏∏ÂùáÂåÄÔºö</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> HASH_INCREMENT <span class="token operator">=</span> <span class="token number">0x61c88647</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ul>
<h3 id="üåüThreadLocalMap-Â¶Ç‰ΩïÂ§ÑÁêÜÂìàÂ∏åÂÜ≤Á™Å"><a href="#üåüThreadLocalMap-Â¶Ç‰ΩïÂ§ÑÁêÜÂìàÂ∏åÂÜ≤Á™Å" class="headerlink" title="üåüThreadLocalMap Â¶Ç‰ΩïÂ§ÑÁêÜÂìàÂ∏åÂÜ≤Á™Å"></a>üåüThreadLocalMap Â¶Ç‰ΩïÂ§ÑÁêÜÂìàÂ∏åÂÜ≤Á™Å</h3><p>ThreadLocalMap ‰ΩøÁî®<strong>Á∫øÊÄßÊé¢ÊµãÊ≥ïÊù•Ëß£ÂÜ≥ÂìàÂ∏åÂÜ≤Á™Å</strong>ÔºåËØ•ÊñπÊ≥ï‰ºö‰∏ÄÁõ¥Êé¢Êµã‰∏ã‰∏Ä‰∏™Âú∞ÂùÄÔºåÁõ¥Âà∞ÊúâÁ©∫ÁöÑÂú∞ÂùÄÂêéÊèíÂÖ•ÔºåËã•ÊèíÂÖ•Âêé Map Êï∞ÈáèË∂ÖËøáÈòàÂÄºÔºåÊï∞ÁªÑ‰ºöÊâ©ÂÆπ‰∏∫ÂéüÊù•ÁöÑ 2 ÂÄçÔºåÂú®Êé¢ÊµãËøáÁ®ã‰∏≠ ThreadLocal ‰ºöÂ§çÁî® key ‰∏∫ null ÁöÑËÑè Entry ÂØπË±°ÔºåÂπ∂ËøõË°åÂûÉÂúæÊ∏ÖÁêÜÔºåÈò≤Ê≠¢Âá∫Áé∞ÂÜÖÂ≠òÊ≥ÑÊºè</p>
<blockquote>
<p>ÂÅáËÆæÂΩìÂâç table ÈïøÂ∫¶‰∏∫16ÔºåËÆ°ÁÆóÂá∫Êù• key ÁöÑ hash ÂÄº‰∏∫ 14ÔºåÂ¶ÇÊûú table[14] ‰∏äÂ∑≤ÁªèÊúâÂÄºÔºåÂπ∂‰∏îÂÖ∂ key ‰∏éÂΩìÂâç key ‰∏ç‰∏ÄËá¥ÔºåÈÇ£‰πàÂ∞±ÂèëÁîü‰∫Ü hash ÂÜ≤Á™ÅÔºåËøô‰∏™Êó∂ÂÄôÂ∞Ü 14 Âä† 1 ÂæóÂà∞ 15ÔºåÂèñ table[15] ËøõË°åÂà§Êñ≠ÔºåÂ¶ÇÊûúËøòÊòØÂÜ≤Á™Å‰ºöÂõûÂà∞ 0ÔºåÂèñ table[0]Ôºå‰ª•Ê≠§Á±ªÊé®ÔºåÁõ¥Âà∞ÂèØ‰ª•ÊèíÂÖ•ÔºåÂèØ‰ª•Êää Entry[]  table ÁúãÊàê‰∏Ä‰∏™<strong>ÁéØÂΩ¢Êï∞ÁªÑ</strong></p>
</blockquote>
<h3 id="üåüThreadLocalMap-Êâ©ÂÆπÊú∫Âà∂"><a href="#üåüThreadLocalMap-Êâ©ÂÆπÊú∫Âà∂" class="headerlink" title="üåüThreadLocalMap Êâ©ÂÆπÊú∫Âà∂"></a>üåüThreadLocalMap Êâ©ÂÆπÊú∫Âà∂</h3><p>ThreadLocalMap ÁöÑÂàùÂßãÂÆπÈáèÊòØ 16</p>
<p>Âú®Êâ©ÂÆπÂâçÊúâ‰∏§‰∏™Âà§Êñ≠ÁöÑÊ≠•È™§ÔºåÈÉΩÊª°Ë∂≥ÂêéÊâç‰ºöËøõË°åÊúÄÁªàÊâ©ÂÆπ</p>
<ul>
<li><strong>ThreadLocalMap#set(ThreadLocal&lt;?&gt; key, Object value)</strong> ÊñπÊ≥ï‰∏≠ÂèØËÉΩ‰ºöËß¶ÂèëÂêØÂèëÂºèÊ∏ÖÁêÜÔºåÂú®Ê∏ÖÁêÜÊó†Êïà Entry ÂØπË±°ÂêéÔºåÂ¶ÇÊûúÊï∞ÁªÑÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫éÊï∞ÁªÑÂÆö‰πâÈïøÂ∫¶ÁöÑ 2/3ÔºåÂàôÈ¶ñÂÖàËøõË°å rehashÔºõ</li>
<li>rehash ‰ºöËß¶Âèë‰∏ÄÊ¨°ÂÖ®ÈáèÊ∏ÖÁêÜÔºåÂ¶ÇÊûúÊï∞ÁªÑÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫éÊï∞ÁªÑÂÆö‰πâÈïøÂ∫¶ÁöÑ 1/2ÔºåÂàôËøõË°å resizeÔºàÊâ©ÂÆπÔºâÔºõ</li>
</ul>
<p>ËøõË°åÊâ©ÂÆπÊó∂ÔºåEntry Êï∞ÁªÑÊâ©ÂÆπ‰∏∫ <strong>ÂéüÊù•ÁöÑ2ÂÄç</strong> ÔºåÈáçÊñ∞ËÆ°ÁÆó key ÁöÑÊï£ÂàóÂÄºÔºåÂ¶ÇÊûúÈÅáÂà∞ key ‰∏∫ NULL ÁöÑÊÉÖÂÜµÔºå‰ºöÂ∞ÜÂÖ∂ value ‰πüÁΩÆ‰∏∫ NULLÔºåÂ∏ÆÂä©ËôöÊãüÊú∫ËøõË°åGC„ÄÇ</p>
<h3 id="üåüThreadLocalÂéüÁêÜÊÄªÁªì"><a href="#üåüThreadLocalÂéüÁêÜÊÄªÁªì" class="headerlink" title="üåüThreadLocalÂéüÁêÜÊÄªÁªì"></a>üåüThreadLocalÂéüÁêÜÊÄªÁªì</h3><p>ThreadLocal Â∞ÜËá™Ë∫´‰Ωú‰∏∫keyÔºåÂíåÈúÄË¶Å‰øùÂ≠òÁöÑvalue‰∏ÄËµ∑Â≠òÂÖ•Âà∞ÂΩìÂâçÁ∫øÁ®ãÁöÑ threadlocalmap ‰∏≠„ÄÇ</p>
<p>ThreadLocalMap ÁöÑ key ÊòØ‰∏Ä‰∏™ threadLocal ÂèòÈáèÔºåThreadLocalMap ÂØπÂÆÉÁöÑÂºïÁî®ÊòØ‰∏Ä‰∏™Âº±ÂºïÁî®Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûúÈô§‰∫Ü ThreadLocalMap ‰ª•Â§ñÊ≤°ÊúâÊåáÂêë threadLocal ÁöÑÂºïÁî®ÔºåÈÇ£‰πàËøô‰∏™ threadlocal Â∞±‰ºöË¢´ÂõûÊî∂„ÄÇ</p>
<p>ThreadLocalMap Êú¨Ë¥®ÊòØÂº†ÂìàÂ∏åË°®„ÄÇ‰∏∫‰∫ÜÂ¢ûÂä†ËÆ°ÁÆóÊïàÁéáÔºåThreadLocal Á±ªÁª¥Êä§‰∫Ü‰∏Ä‰∏™ÈùôÊÄÅÂèòÈáè nextHashCodeÔºåÊØè‰∏Ä‰∏™ threadlocal ÂÆû‰æãÈÉΩ‰ºöËé∑ÂæóÂ±û‰∫éËá™Â∑±ÁöÑ hashcodeÔºåËøôÊòØÈÄöËøáÂØπ nextHashCode ‰∏çÊñ≠Âä† 0x61c88647 ÂÆûÁé∞ÁöÑ(‰∏∫Âï•ÊòØ0x61c88647 Âë¢Êàë‰πü‰∏çÁü•ÈÅìÔºåÂèØËÉΩ‰ºöÊØîËæÉÂùáÂåÄÂêß)„ÄÇThreadLocalMap ‰ΩøÁî®Á∫øÊÄßÊé¢ÊµãÊ≥ïËß£ÂÜ≥ÂìàÂ∏åÂÜ≤Á™ÅÔºöÊØè‰∏™ threadlocal Âú®ÊèíÂÖ•Êó∂‰ºöÊ£ÄÊü•Êï∞ÁªÑÁöÑÂΩìÂâç‰ΩçÁΩÆÁöÑÊÉÖÂÜµÔºåÂ¶ÇÊûú‰∏∫ null Áõ¥Êé•ÊèíÂÖ•Ôºà‰∏∫ null Ë°®Á§∫Âº±ÂºïÁî®Ë¢´ gc Êéâ‰∫ÜÔºâÔºå‰∏ç‰∏∫ null ÂàôÈ°∫Â∫èÊü•Êâæ‰∏ã‰∏Ä‰∏™ÔºåÁõ¥Âà∞ÊâæÂà∞Á©∫‰ΩçÁΩÆ‰∏∫Ê≠¢„ÄÇ</p>
<p>ÂΩì ThreadLocalMap ÂÜÖÂÖÉÁ¥†Ë∂ÖËøáÊúÄÂ§ßÂ§ßÂ∞èÁöÑ 3/4 Êó∂‰ºöËøõË°åÊâ©ÂÆπÔºåÊñ∞ map Â§ßÂ∞è‰∏∫ 2 ÂÄç„ÄÇÊâ©ÂÆπÊó∂‰ªéÁ¨¨‰∏Ä‰∏™entry ÂºÄÂßãÔºå‰æùÊ¨°ÂæÄÊñ∞ map ÈáåËøÅÁßªÔºåÂΩì‰∏≠‰ºö‰∏¢ÂºÉÊéâ key ‰∏∫ null ÁöÑ„ÄÇ</p>
<h3 id="üåüÂ¶Ç‰ΩïÂÆûÁé∞Áà∂Â≠êÁ∫øÁ®ãÈó¥Â±ÄÈÉ®ÂèòÈáèÂÖ±‰∫´"><a href="#üåüÂ¶Ç‰ΩïÂÆûÁé∞Áà∂Â≠êÁ∫øÁ®ãÈó¥Â±ÄÈÉ®ÂèòÈáèÂÖ±‰∫´" class="headerlink" title="üåüÂ¶Ç‰ΩïÂÆûÁé∞Áà∂Â≠êÁ∫øÁ®ãÈó¥Â±ÄÈÉ®ÂèòÈáèÂÖ±‰∫´"></a>üåüÂ¶Ç‰ΩïÂÆûÁé∞Áà∂Â≠êÁ∫øÁ®ãÈó¥Â±ÄÈÉ®ÂèòÈáèÂÖ±‰∫´</h3><p>ÂÆûÁé∞Áà∂Â≠êÁ∫øÁ®ãÈó¥ÁöÑÂ±ÄÈÉ®ÂèòÈáèÂÖ±‰∫´ÈúÄË¶ÅËøΩÊ∫ØÂà∞ Thread ÂØπË±°ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºöÂú®ÊúÄÁªàÊâßË°åÁöÑÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÔºåÊúâËøôÊ†∑‰∏Ä‰∏™Âà§Êñ≠ÔºöÂ¶ÇÊûúÂΩìÂâçÁà∂Á∫øÁ®ãÔºàÂàõÂª∫Â≠êÁ∫øÁ®ãÁöÑÁ∫øÁ®ãÔºâÁöÑ inheritableThreadLocals Â±ûÊÄß‰∏ç‰∏∫ NULLÔºåÂ∞±‰ºöÂ∞ÜÂΩì‰∏ãÁà∂Á∫øÁ®ãÁöÑ inheritableThreadLocals Â±ûÊÄßÂ§çÂà∂ÁªôÂ≠êÁ∫øÁ®ãÁöÑ inheritableThreadLocals Â±ûÊÄß„ÄÇ</p>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ§çÂà∂Áà∂Á∫øÁ®ãÂÖ±‰∫´ÂèòÈáèÁöÑÊó∂Êú∫ÊòØÂú®ÂàõÂª∫Â≠êÁ∫øÁ®ãÊó∂ÔºåÂ¶ÇÊûúÂú®ÂàõÂª∫Â≠êÁ∫øÁ®ãÂêéÁà∂Á∫øÁ®ãÂÜçÂæÄ InheritableThreadLocal Á±ªÂûãÁöÑÂØπË±°‰∏≠ËÆæÁΩÆÂÜÖÂÆπÔºåÂ∞Ü‰∏çÂÜçÂØπÂ≠êÁ∫øÁ®ãÂèØËßÅ„ÄÇ</p>
<h1 id="‚ë£Á∫øÁ®ãÊ±†"><a href="#‚ë£Á∫øÁ®ãÊ±†" class="headerlink" title="‚ë£Á∫øÁ®ãÊ±†"></a>‚ë£Á∫øÁ®ãÊ±†</h1><h2 id="‚ù∂Âü∫Á°Ä-1"><a href="#‚ù∂Âü∫Á°Ä-1" class="headerlink" title="‚ù∂Âü∫Á°Ä"></a>‚ù∂Âü∫Á°Ä</h2><h3 id="üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ±†Ôºü"><a href="#üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ±†Ôºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ±†Ôºü"></a>üåü‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ±†Ôºü</h3><p>Á∫øÁ®ãÊ±†Ôºö‰∏Ä‰∏™ÂÆπÁ∫≥Â§ö‰∏™Á∫øÁ®ãÁöÑÂÆπÂô®ÔºåÂÆπÂô®‰∏≠ÁöÑÁ∫øÁ®ãÂèØ‰ª•ÈáçÂ§ç‰ΩøÁî®ÔºåÁúÅÂéª‰∫ÜÈ¢ëÁπÅÂàõÂª∫ÂíåÈîÄÊØÅÁ∫øÁ®ãÂØπË±°ÁöÑÊìç‰Ωú</p>
<p>Á∫øÁ®ãÊ±†ÁöÑÊ†∏ÂøÉÊÄùÊÉ≥Ôºö<strong>Á∫øÁ®ãÂ§çÁî®</strong>ÔºåÂêå‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•Ë¢´ÈáçÂ§ç‰ΩøÁî®ÔºåÊù•Â§ÑÁêÜÂ§ö‰∏™‰ªªÂä°</p>
<p>Ê±†ÂåñÊäÄÊúØ (Pool) Ôºö‰∏ÄÁßçÁºñÁ®ãÊäÄÂ∑ßÔºåÊ†∏ÂøÉÊÄùÊÉ≥ÊòØËµÑÊ∫êÂ§çÁî®ÔºåÂú®ËØ∑Ê±ÇÈáèÂ§ßÊó∂ËÉΩ‰ºòÂåñÂ∫îÁî®ÊÄßËÉΩÔºåÈôç‰ΩéÁ≥ªÁªüÈ¢ëÁπÅÂª∫ËøûÁöÑËµÑÊ∫êÂºÄÈîÄ</p>
<h3 id="üåü‰∏∫‰ªÄ‰πàË¶ÅÁî®Á∫øÁ®ãÊ±†Ôºü"><a href="#üåü‰∏∫‰ªÄ‰πàË¶ÅÁî®Á∫øÁ®ãÊ±†Ôºü" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàË¶ÅÁî®Á∫øÁ®ãÊ±†Ôºü"></a>üåü‰∏∫‰ªÄ‰πàË¶ÅÁî®Á∫øÁ®ãÊ±†Ôºü</h3><blockquote>
<p>‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®ExecutorÁ∫øÁ®ãÊ±†Ê°ÜÊû∂Âë¢ÔºüËØ¥‰∏ãÂØπÁ∫øÁ®ãÊ±†ÁöÑÁêÜËß£Ôºü</p>
</blockquote>
<p>Á∫øÁ®ãÊ±†ËÉΩÂ§üÂØπÁ∫øÁ®ãËøõË°åÁªü‰∏ÄÂàÜÈÖçÔºåË∞É‰ºòÂíåÁõëÊéß:</p>
<ul>
<li><strong>Èôç‰ΩéËµÑÊ∫êÊ∂àËÄó</strong>„ÄÇÈÄöËøáÈáçÂ§çÂà©Áî®Â∑≤ÂàõÂª∫ÁöÑÁ∫øÁ®ãÈôç‰ΩéÁ∫øÁ®ãÂàõÂª∫ÂíåÈîÄÊØÅÈÄ†ÊàêÁöÑÊ∂àËÄó„ÄÇ</li>
<li><strong>ÊèêÈ´òÂìçÂ∫îÈÄüÂ∫¶</strong>„ÄÇÂΩì‰ªªÂä°Âà∞ËææÊó∂Ôºå‰ªªÂä°ÂèØ‰ª•‰∏çÈúÄË¶ÅÁ≠âÂà∞Á∫øÁ®ãÂàõÂª∫Â∞±ËÉΩÁ´ãÂç≥ÊâßË°å„ÄÇ</li>
<li><strong>ÊèêÈ´òÁ∫øÁ®ãÁöÑÂèØÁÆ°ÁêÜÊÄß</strong>„ÄÇÁ∫øÁ®ãÊòØÁ®ÄÁº∫ËµÑÊ∫êÔºåÂ¶ÇÊûúÊó†ÈôêÂà∂ÁöÑÂàõÂª∫Ôºå‰∏ç‰ªÖ‰ºöÊ∂àËÄóÁ≥ªÁªüËµÑÊ∫êÔºåËøò‰ºöÈôç‰ΩéÁ≥ªÁªüÁöÑÁ®≥ÂÆöÊÄßÔºå‰ΩøÁî®Á∫øÁ®ãÊ±†ÂèØ‰ª•ËøõË°åÁªü‰∏ÄÁöÑÂàÜÈÖçÔºåË∞É‰ºòÂíåÁõëÊéß„ÄÇ</li>
</ul>
<h3 id="üåüÁ∫øÁ®ãÊ±†ÂàõÂª∫ÁöÑÊñπÊ≥ï"><a href="#üåüÁ∫øÁ®ãÊ±†ÂàõÂª∫ÁöÑÊñπÊ≥ï" class="headerlink" title="üåüÁ∫øÁ®ãÊ±†ÂàõÂª∫ÁöÑÊñπÊ≥ï"></a>üåüÁ∫øÁ®ãÊ±†ÂàõÂª∫ÁöÑÊñπÊ≥ï</h3><blockquote>
<p>„ÄäÈòøÈáåÂ∑¥Â∑¥ Java ÂºÄÂèëÊâãÂÜå„Äã‰∏≠Âº∫Âà∂Á∫øÁ®ãÊ±†‰∏çÂÖÅËÆ∏‰ΩøÁî® Executors ÂéªÂàõÂª∫ÔºåËÄåÊòØÈÄöËøá ThreadPoolExecutor ÁöÑÊñπÂºèÔºåËøôÊ†∑ÁöÑÂ§ÑÁêÜÊñπÂºèËÆ©ÂÜôÁöÑÂêåÂ≠¶Êõ¥Âä†ÊòéÁ°ÆÁ∫øÁ®ãÊ±†ÁöÑËøêË°åËßÑÂàôÔºåËßÑÈÅøËµÑÊ∫êËÄóÂ∞ΩÁöÑÈ£éÈô©</p>
</blockquote>
<p>Á∫øÁ®ãÊ±†ÁöÑÂ∏∏Áî®ÂàõÂª∫ÊñπÂºè‰∏ªË¶ÅÊúâ‰∏§ÁßçÔºåÈÄöËøáÈÄöËøáThreadPoolExecutor ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂàõÂª∫ÂíåExecutorsÂ∑•ÂéÇÊñπÊ≥ïÂàõÂª∫</p>
<p>ÊñπÂºè‰∏ÄÔºöÈÄöËøá ThreadPoolExecutor ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂÆûÁé∞Ôºö</p>
<p><img src="../images/Q&A%EF%BC%9AJUC/ThreadPoolExecutor%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95.jpeg" alt="ThreadPoolExecutorÊûÑÈÄ†ÊñπÊ≥ï"></p>
<p>ÊñπÂºè‰∫åÔºöÈÄöËøá Executor Ê°ÜÊû∂ÁöÑÂ∑•ÂÖ∑Á±ª Executors Êù•ÂÆûÁé∞Ôºö</p>
<p>ÂèØ‰ª•ÂàõÂª∫‰∏âÁßçÁ±ªÂûãÁöÑ ThreadPoolExecutorÔºö</p>
<ul>
<li><strong>FixedThreadPool</strong> Ôºö<code>newFixedThreadPool</code>ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™Âõ∫ÂÆöÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†„ÄÇËØ•Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÈáèÂßãÁªà‰∏çÂèò„ÄÇÂΩìÊúâ‰∏Ä‰∏™Êñ∞ÁöÑ‰ªªÂä°Êèê‰∫§Êó∂ÔºåÁ∫øÁ®ãÊ±†‰∏≠Ëã•ÊúâÁ©∫Èó≤Á∫øÁ®ãÔºåÂàôÁ´ãÂç≥ÊâßË°å„ÄÇËã•Ê≤°ÊúâÔºåÂàôÊñ∞ÁöÑ‰ªªÂä°‰ºöË¢´ÊöÇÂ≠òÂú®‰∏Ä‰∏™‰ªªÂä°ÈòüÂàó‰∏≠ÔºåÂæÖÊúâÁ∫øÁ®ãÁ©∫Èó≤Êó∂Ôºå‰æøÂ§ÑÁêÜÂú®‰ªªÂä°ÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°„ÄÇ</li>
<li><strong>SingleThreadExecutorÔºö</strong> <code>newSingleThreadExecutor</code> ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÁöÑÁ∫øÁ®ãÊ±†„ÄÇËã•Â§ö‰Ωô‰∏Ä‰∏™‰ªªÂä°Ë¢´Êèê‰∫§Âà∞ËØ•Á∫øÁ®ãÊ±†Ôºå‰ªªÂä°‰ºöË¢´‰øùÂ≠òÂú®‰∏Ä‰∏™‰ªªÂä°ÈòüÂàó‰∏≠ÔºåÂæÖÁ∫øÁ®ãÁ©∫Èó≤ÔºåÊåâÂÖàÂÖ•ÂÖàÂá∫ÁöÑÈ°∫Â∫èÊâßË°åÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°„ÄÇ</li>
<li><strong>CachedThreadPoolÔºö</strong> <code>newCachedThreadPool</code>ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ÂèØÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµË∞ÉÊï¥Á∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†„ÄÇÁ∫øÁ®ãÊ±†ÁöÑÁ∫øÁ®ãÊï∞Èáè‰∏çÁ°ÆÂÆöÔºå‰ΩÜËã•ÊúâÁ©∫Èó≤Á∫øÁ®ãÂèØ‰ª•Â§çÁî®ÔºåÂàô‰ºö‰ºòÂÖà‰ΩøÁî®ÂèØÂ§çÁî®ÁöÑÁ∫øÁ®ã„ÄÇËã•ÊâÄÊúâÁ∫øÁ®ãÂùáÂú®Â∑•‰ΩúÔºåÂèàÊúâÊñ∞ÁöÑ‰ªªÂä°Êèê‰∫§ÔºåÂàô‰ºöÂàõÂª∫Êñ∞ÁöÑÁ∫øÁ®ãÂ§ÑÁêÜ‰ªªÂä°„ÄÇÊâÄÊúâÁ∫øÁ®ãÂú®ÂΩìÂâç‰ªªÂä°ÊâßË°åÂÆåÊØïÂêéÔºåÂ∞ÜËøîÂõûÁ∫øÁ®ãÊ±†ËøõË°åÂ§çÁî®„ÄÇ</li>
</ul>
<h3 id="üåü‰∏∫‰ªÄ‰πà‰∏çÂÖÅËÆ∏‰ΩøÁî®ExecutorsÂàõÂª∫Á∫øÁ®ãÊ±†-ÈÇ£‰πàÊé®ËçêÊÄé‰πà‰ΩøÁî®Âë¢"><a href="#üåü‰∏∫‰ªÄ‰πà‰∏çÂÖÅËÆ∏‰ΩøÁî®ExecutorsÂàõÂª∫Á∫øÁ®ãÊ±†-ÈÇ£‰πàÊé®ËçêÊÄé‰πà‰ΩøÁî®Âë¢" class="headerlink" title="üåü‰∏∫‰ªÄ‰πà‰∏çÂÖÅËÆ∏‰ΩøÁî®ExecutorsÂàõÂª∫Á∫øÁ®ãÊ±†? ÈÇ£‰πàÊé®ËçêÊÄé‰πà‰ΩøÁî®Âë¢?"></a>üåü‰∏∫‰ªÄ‰πà‰∏çÂÖÅËÆ∏‰ΩøÁî®ExecutorsÂàõÂª∫Á∫øÁ®ãÊ±†? ÈÇ£‰πàÊé®ËçêÊÄé‰πà‰ΩøÁî®Âë¢?</h3><p>„ÄäÈòøÈáåÂ∑¥Â∑¥ Java ÂºÄÂèëÊâãÂÜå„Äã‰∏≠Âº∫Âà∂Á∫øÁ®ãÊ±†‰∏çÂÖÅËÆ∏‰ΩøÁî® Executors ÂéªÂàõÂª∫ÔºåËÄåÊòØÈÄöËøá ThreadPoolExecutor ÁöÑÊñπÂºèÔºåËøôÊ†∑ÁöÑÂ§ÑÁêÜÊñπÂºèËÆ©ÂÜôÁöÑÂêåÂ≠¶Êõ¥Âä†ÊòéÁ°ÆÁ∫øÁ®ãÊ±†ÁöÑËøêË°åËßÑÂàôÔºåËßÑÈÅøËµÑÊ∫êËÄóÂ∞ΩÁöÑÈ£éÈô©</p>
<p>Executors ËøîÂõûÁ∫øÁ®ãÊ±†ÂØπË±°ÁöÑÂºäÁ´ØÂ¶Ç‰∏ãÔºö</p>
<ul>
<li><strong>FixedThreadPool Âíå SingleThreadExecutor</strong> Ôºö ÂÖÅËÆ∏ËØ∑Ê±ÇÁöÑÈòüÂàóÈïøÂ∫¶‰∏∫ Integer.MAX_VALUE ÔºåÂèØËÉΩÂ†ÜÁßØÂ§ßÈáèÁöÑËØ∑Ê±ÇÔºå‰ªéËÄåÂØºËá¥ OOM„ÄÇ</li>
<li><strong>CachedThreadPool Âíå ScheduledThreadPool</strong> Ôºö ÂÖÅËÆ∏ÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞Èáè‰∏∫ Integer.MAX_VALUE ÔºåÂèØËÉΩ‰ºöÂàõÂª∫Â§ßÈáèÁ∫øÁ®ãÔºå‰ªéËÄåÂØºËá¥ OOM„ÄÇ</li>
</ul>
<p><strong>Êé®ËçêÊñπÂºè 1</strong></p>
<p>È¶ñÂÖàÂºïÂÖ•Ôºöcommons-lang3ÂåÖ</p>
<pre class="line-numbers language-java"><code class="language-java">ScheduledExecutorService executorService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScheduledThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">BasicThreadFactory<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">namingPattern</span><span class="token punctuation">(</span><span class="token string">"example-schedule-pool-%d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">daemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>Êé®ËçêÊñπÂºè 2</strong> </p>
<p>È¶ñÂÖàÂºïÂÖ•Ôºöcom.google.guavaÂåÖ</p>
<pre class="line-numbers language-java"><code class="language-java">ThreadFactory namedThreadFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setNameFormat</span><span class="token punctuation">(</span><span class="token string">"demo-pool-%d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//Common Thread Pool</span>
ExecutorService pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> 0L<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>Runnable<span class="token operator">></span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> namedThreadFactory<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>AbortPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// excute</span>
pool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment" spellcheck="true">//gracefully shutdown</span>
pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Êé®ËçêÊñπÂºè 3</strong></p>
<p>springÈÖçÁΩÆÁ∫øÁ®ãÊ±†ÊñπÂºèÔºöËá™ÂÆö‰πâÁ∫øÁ®ãÂ∑•ÂéÇbeanÈúÄË¶ÅÂÆûÁé∞ThreadFactoryÔºåÂèØÂèÇËÄÉËØ•Êé•Âè£ÁöÑÂÖ∂ÂÆÉÈªòËÆ§ÂÆûÁé∞Á±ªÔºå‰ΩøÁî®ÊñπÂºèÁõ¥Êé•Ê≥®ÂÖ•beanË∞ÉÁî®execute(Runnable task)ÊñπÊ≥ïÂç≥ÂèØ</p>
<pre class="line-numbers language-xml"><code class="language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>userThreadPool<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>corePoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>queueCapacity<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

    &lt;property name="threadFactory" value= threadFactory />
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rejectedExecutionHandler<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">local</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rejectedExecutionHandler<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
    
    //in code
    userThreadPool.execute(thread);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="üåüThreadPoolExecutorÊûÑÈÄ†ÂáΩÊï∞ÂèÇÊï∞ÂàÜÊûê"><a href="#üåüThreadPoolExecutorÊûÑÈÄ†ÂáΩÊï∞ÂèÇÊï∞ÂàÜÊûê" class="headerlink" title="üåüThreadPoolExecutorÊûÑÈÄ†ÂáΩÊï∞ÂèÇÊï∞ÂàÜÊûê"></a>üåüThreadPoolExecutorÊûÑÈÄ†ÂáΩÊï∞ÂèÇÊï∞ÂàÜÊûê</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token function">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//Á∫øÁ®ãÊ±†ÁöÑÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Èáè</span>
                              <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//Á∫øÁ®ãÊ±†ÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞</span>
                              <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//ÂΩìÁ∫øÁ®ãÊï∞Â§ß‰∫éÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Êó∂ÔºåÂ§ö‰ΩôÁöÑÁ©∫Èó≤Á∫øÁ®ãÂ≠òÊ¥ªÁöÑÊúÄÈïøÊó∂Èó¥</span>
                              TimeUnit unit<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//Êó∂Èó¥Âçï‰Ωç</span>
                              BlockingQueue<span class="token operator">&lt;</span>Runnable<span class="token operator">></span> workQueue<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//‰ªªÂä°ÈòüÂàóÔºåÂÇ®Â≠òÁ≠âÂæÖÊâßË°å‰ªªÂä°ÁöÑÈòüÂàó</span>
                              ThreadFactory threadFactory<span class="token punctuation">,</span><span class="token comment" spellcheck="true">//Á∫øÁ®ãÂ∑•ÂéÇÔºåÁî®Êù•ÂàõÂª∫Á∫øÁ®ãÔºå‰∏ÄËà¨ÈªòËÆ§Âç≥ÂèØ</span>
                              RejectedExecutionHandler handler<span class="token comment" spellcheck="true">//ÊãíÁªùÁ≠ñÁï•ÔºåÂΩìÊèê‰∫§ÁöÑ‰ªªÂä°ËøáÂ§öËÄå‰∏çËÉΩÂèäÊó∂Â§ÑÁêÜÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÆöÂà∂Á≠ñÁï•Êù•Â§ÑÁêÜ‰ªªÂä°</span>
                               <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>corePoolSize <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;</span> corePoolSize <span class="token operator">||</span>
            keepAliveTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>workQueue <span class="token operator">==</span> null <span class="token operator">||</span> threadFactory <span class="token operator">==</span> null <span class="token operator">||</span> handler <span class="token operator">==</span> null<span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>corePoolSize <span class="token operator">=</span> corePoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maximumPoolSize <span class="token operator">=</span> maximumPoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workQueue <span class="token operator">=</span> workQueue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keepAliveTime <span class="token operator">=</span> unit<span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span>keepAliveTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>threadFactory <span class="token operator">=</span> threadFactory<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handler <span class="token operator">=</span> handler<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>  <strong><code>corePoolSizeÔºàÁ∫øÁ®ãÊ±†ÁöÑÂü∫Êú¨Â§ßÂ∞èÔºâ</code></strong> ÔºöÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºåÂÆö‰πâ‰∫ÜÊúÄÂ∞èÂèØ‰ª•ÂêåÊó∂ËøêË°åÁöÑÁ∫øÁ®ãÊï∞Èáè„ÄÇ</p>
</li>
<li><p>  <strong><code>maximumPoolSizeÔºàÁ∫øÁ®ãÊ±†ÊúÄÂ§ßÊï∞ÈáèÔºâ</code></strong> ÔºöÁ∫øÁ®ã‰∏≠ÂÖÅËÆ∏Â≠òÂú®ÁöÑÊúÄÂ§ßÂ∑•‰ΩúÁ∫øÁ®ãÊï∞Èáè</p>
</li>
<li><p>  <code>keepAliveTimeÔºàÁ∫øÁ®ãÊ¥ªÂä®‰øùÊåÅÊó∂Èó¥Ôºâ</code>ÔºöÂΩìÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÊï∞ÈáèÂ§ß‰∫éÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Êó∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊñ∞ÁöÑ‰ªªÂä°Êèê‰∫§ÔºåÊ†∏ÂøÉÁ∫øÁ®ãÂ§ñÁöÑÁ∫øÁ®ã‰∏ç‰ºöÁ´ãÂç≥ÈîÄÊØÅÔºåËÄåÊòØ‰ºöÁ≠âÂà∞Êó∂Èó¥Ë∂ÖËøá<code>keepAliveTime</code>Êó∂Êâç‰ºöË¢´ÈîÄÊØÅ„ÄÇ</p>
</li>
<li><p>  <code>unitÔºàÁ∫øÁ®ãÊ¥ªÂä®‰øùÊåÅÊó∂Èó¥ÁöÑÂçï‰ΩçÔºâ</code> Ôºö<code>keepAliveTime</code> ÂèÇÊï∞ÁöÑÊó∂Èó¥Âçï‰Ωç„ÄÇÂèØÈÄâÁöÑÂçï‰ΩçÊúâÂ§©ÔºàDAYSÔºâ„ÄÅÂ∞èÊó∂ÔºàHOURSÔºâ„ÄÅÂàÜÈíüÔºàMINUTESÔºâ„ÄÅÊØ´ÁßíÔºàMILLISECONDSÔºâ„ÄÅÂæÆÁßíÔºàMICROSECONDSÔºåÂçÉÂàÜ‰πã‰∏ÄÊØ´ÁßíÔºâÂíåÁ∫≥ÁßíÔºàNANOSECONDSÔºåÂçÉÂàÜ‰πã‰∏ÄÂæÆÁßíÔºâ„ÄÇ</p>
</li>
<li><p>  **<code>workQueueÔºà‰ªªÂä°ÈòüÂàóÔºâ</code>**ÔºöÂ≠òÊîæ‰ªªÂä°ÁöÑÈòªÂ°ûÈòüÂàó„ÄÇÊñ∞Êù•ÁöÑ‰ªªÂä°‰ºöÂÖàÂà§Êñ≠ÂΩìÂâçËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÊòØÂê¶Âà∞ËææÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºåÂ¶ÇÊûúÂà∞ËææÁöÑËØùÔºå‰ªªÂä°Â∞±‰ºöÂÖàÊîæÂà∞ÈòªÂ°ûÈòüÂàó„ÄÇ</p>
</li>
<li><p>  <code>threadFactoryÔºàÁ∫øÁ®ãÂ∑•ÂéÇÔºâ</code>Ôºö‰∏∫Á∫øÁ®ãÊ±†Êèê‰æõÂàõÂª∫Êñ∞Á∫øÁ®ãÁöÑÁ∫øÁ®ãÂ∑•ÂéÇ„ÄÇ</p>
</li>
<li><p>  <code>handlerÔºàÈ•±ÂíåÁ≠ñÁï•Ôºâ</code> ÔºöÁ∫øÁ®ãÊ±†‰ªªÂä°ÈòüÂàóË∂ÖËøá<code>maxinumPoolSize</code> ‰πãÂêéÁöÑÊãíÁªùÁ≠ñÁï•„ÄÇ</p>
</li>
</ul>
<h3 id="üåüThreadPoolExecutorÁöÑ‰ªªÂä°ÈòüÂàó"><a href="#üåüThreadPoolExecutorÁöÑ‰ªªÂä°ÈòüÂàó" class="headerlink" title="üåüThreadPoolExecutorÁöÑ‰ªªÂä°ÈòüÂàó"></a>üåüThreadPoolExecutorÁöÑ‰ªªÂä°ÈòüÂàó</h3><p>ÂèØ‰ª•ÈÄâÊã©‰ª•‰∏ãÂá†‰∏™ÈòªÂ°ûÈòüÂàóÔºöÔºàÈÉΩÊòØBlockingQueue ÁöÑÂÆûÁé∞Á±ªÔºâ</p>
<ul>
<li><p>  1ÔºâArrayBlockingQueueÔºöÊòØ‰∏Ä‰∏™Âü∫‰∫éÊï∞ÁªÑÁªìÊûÑÁöÑÊúâÁïåÈòªÂ°ûÈòüÂàóÔºåÊ≠§ÈòüÂàóÊåâ FIFOÔºàÂÖàËøõÂÖàÂá∫ÔºâÂéüÂàôÂØπÂÖÉÁ¥†ËøõË°åÊéíÂ∫è„ÄÇ</p>
</li>
<li><p>  2ÔºâLinkedBlockingQueueÔºö‰∏Ä‰∏™Âü∫‰∫éÈìæË°®ÁªìÊûÑÁöÑÈòªÂ°ûÈòüÂàóÔºåÊ≠§ÈòüÂàóÊåâ FIFO ÊéíÂ∫èÂÖÉÁ¥†ÔºåÂêûÂêêÈáèÈÄöÂ∏∏Ë¶ÅÈ´ò‰∫é ArrayBlockingQueue„ÄÇÈùôÊÄÅÂ∑•ÂéÇÊñπÊ≥ï Executors.newFixedThreadPool() ‰ΩøÁî®‰∫ÜËøô‰∏™ÈòüÂàó„ÄÇ</p>
</li>
<li><p>  3ÔºâSynchronousQueueÔºö‰∏Ä‰∏™‰∏çÂ≠òÂÇ®ÂÖÉÁ¥†ÁöÑÈòªÂ°ûÈòüÂàó„ÄÇÊØè‰∏™ÊèíÂÖ•Êìç‰ΩúÂøÖÈ°ªÁ≠âÂà∞Âè¶‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®ÁßªÈô§Êìç‰ΩúÔºåÂê¶ÂàôÊèíÂÖ•Êìç‰Ωú‰∏ÄÁõ¥Â§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅÔºåÂêûÂêêÈáèÈÄöÂ∏∏Ë¶ÅÈ´ò‰∫é LinkedBlockingQueueÔºåÈùôÊÄÅÂ∑•ÂéÇÊñπÊ≥ï Executors.newCachedThreadPool ‰ΩøÁî®‰∫ÜËøô‰∏™ÈòüÂàó„ÄÇ</p>
</li>
<li><p>  4ÔºâPriorityBlockingQueueÔºö‰∏Ä‰∏™ÂÖ∑Êúâ‰ºòÂÖàÁ∫ßÁöÑÊó†ÈôêÈòªÂ°ûÈòüÂàó„ÄÇ</p>
</li>
</ul>
<h3 id="üåüThreadPoolExecutorÁöÑÈ•±ÂíåÁ≠ñÁï•"><a href="#üåüThreadPoolExecutorÁöÑÈ•±ÂíåÁ≠ñÁï•" class="headerlink" title="üåüThreadPoolExecutorÁöÑÈ•±ÂíåÁ≠ñÁï•"></a>üåüThreadPoolExecutorÁöÑÈ•±ÂíåÁ≠ñÁï•</h3><blockquote>
<p>ËØ¥ËØ¥ThreadPoolExecutorÊúâÂì™‰∫õRejectedExecutionHandlerÁ≠ñÁï•? ÈªòËÆ§ÊòØ‰ªÄ‰πàÁ≠ñÁï•?</p>
<p>ÂΩìÈòüÂàóÊª°‰∫ÜÂπ∂‰∏îworkerÁöÑÊï∞ÈáèËææÂà∞maxSizeÁöÑÊó∂ÂÄôÔºå‰ºöÊÄé‰πàÊ†∑? ÊâßË°åÂÖ∑‰ΩìÁöÑÊãíÁªùÁ≠ñÁï•</p>
</blockquote>
<p>ÂΩìÂêåÊó∂ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèËææÂà∞ÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÈáèÂπ∂‰∏îÈòªÂ°ûÈòüÂàó‰πüÂ∑≤ÁªèÊîæÊª°‰∫Ü‰ªªÂä°Êó∂Ôºå<code>ThreadPoolExecutor</code>‰ºöÊåáÂÆö‰∏Ä‰∫õÈ•±ÂíåÁ≠ñÁï•„ÄÇ‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂõõÁßçÁ±ªÂûãÔºö</p>
<ul>
<li>  <code>AbortPolicy</code>Á≠ñÁï•ÔºöËØ•Á≠ñÁï•‰ºöÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏ÊãíÁªùÊñ∞‰ªªÂä°Ôºå<strong>ÈªòËÆ§Á≠ñÁï•</strong></li>
<li>  <code>CallerRunsPolicy</code>Á≠ñÁï•ÔºöÂè™Áî®Ë∞ÉÁî®ËÄÖÊâÄÂú®Á∫øÁ®ãÊù•ËøêË°å‰ªªÂä°„ÄÇ</li>
<li>  <code>DiscardPolicy</code>Á≠ñÁï•ÔºöÁõ¥Êé•‰∏¢ÂºÉÊñ∞‰ªªÂä°„ÄÇ</li>
<li>  <code>DiscardOleddestPolicy</code>Á≠ñÁï•Ôºö‰∏¢ÂºÉÊúÄÊó©ÁöÑÊú™Â§ÑÁêÜÁöÑ‰ªªÂä°ËØ∑Ê±Ç„ÄÇ</li>
</ul>
<p>ÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•Ê†πÊçÆÂ∫îÁî®Âú∫ÊôØÈúÄË¶ÅÊù•ÂÆûÁé∞ RejectedExecutionHandler Êé•Âè£Ëá™ÂÆö‰πâÁ≠ñÁï•„ÄÇÂ¶ÇËÆ∞ÂΩïÊó•ÂøóÊàñÊåÅ‰πÖÂåñÂ≠òÂÇ®‰∏çËÉΩÂ§ÑÁêÜÁöÑ‰ªªÂä°„ÄÇ</p>
<p>Ë°•ÂÖÖÔºöÂÖ∂‰ªñÊ°ÜÊû∂ÊãíÁªùÁ≠ñÁï•</p>
<ul>
<li>DubboÔºöÂú®ÊäõÂá∫ RejectedExecutionException ÂºÇÂ∏∏ÂâçËÆ∞ÂΩïÊó•ÂøóÔºåÂπ∂ dump Á∫øÁ®ãÊ†à‰ø°ÊÅØÔºåÊñπ‰æøÂÆö‰ΩçÈóÆÈ¢ò</li>
<li>NettyÔºöÂàõÂª∫‰∏Ä‰∏™Êñ∞Á∫øÁ®ãÊù•ÊâßË°å‰ªªÂä°</li>
<li>ActiveMQÔºöÂ∏¶Ë∂ÖÊó∂Á≠âÂæÖÔºà60sÔºâÂ∞ùËØïÊîæÂÖ•ÈòüÂàó</li>
<li>PinPointÔºöÂÆÉ‰ΩøÁî®‰∫Ü‰∏Ä‰∏™ÊãíÁªùÁ≠ñÁï•ÈìæÔºå‰ºöÈÄê‰∏ÄÂ∞ùËØïÁ≠ñÁï•Èìæ‰∏≠ÊØèÁßçÊãíÁªùÁ≠ñÁï•</li>
</ul>
<h3 id="üåüÁ∫øÁ®ãÊ±†ÁöÑËøêË°åÊµÅÁ®ã"><a href="#üåüÁ∫øÁ®ãÊ±†ÁöÑËøêË°åÊµÅÁ®ã" class="headerlink" title="üåüÁ∫øÁ®ãÊ±†ÁöÑËøêË°åÊµÅÁ®ã"></a>üåüÁ∫øÁ®ãÊ±†ÁöÑËøêË°åÊµÅÁ®ã</h3><blockquote>
<p>ÂÅáÂ¶ÇÊàëÊää corepoolsize Âíå maxpoolsize ÂàÜÂà´ËÆæÁΩÆ‰∏∫ 5 Âíå 10ÔºåÂÅáËÆæ‰ªªÂä°ËÆ°ÁÆóÊó∂Èó¥ÂæàÈïøÔºåÊàëÂæÄÈáåÈù¢ËøûÁª≠ÊîæÂÖ• 20 ‰∏™‰ªªÂä°ÔºåÊåâÊó∂Èó¥È°∫Â∫è‰ºöÂèëÁîü‰ªÄ‰πà</p>
</blockquote>
<p>ÂàõÂª∫Á∫øÁ®ãÊ±†ÂàõÂª∫ÂêéÊèê‰∫§‰ªªÂä°ÁöÑÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://img.jwt1399.top/img/202301041523688.png" alt="Á∫øÁ®ãÊ±†ÊâßË°åÊµÅÁ®ã"></p>
<p><img src="https://img.jwt1399.top/img/202301031724574.png"></p>
<ol>
<li><p>ÂàõÂª∫Á∫øÁ®ãÊ±†Êó∂ÔºåÊ≤°ÊúâÁ∫øÁ®ãÔºåÁ≠âÂæÖÊèê‰∫§ËøáÊù•ÁöÑ‰ªªÂä°ËØ∑Ê±ÇÔºà<strong>ÊáíÊÉ∞</strong>ÔºâÔºåË∞ÉÁî® execute ÊñπÊ≥ïÊâç‰ºöÂàõÂª∫Á∫øÁ®ã„Äê‚ë†„Äë</p>
</li>
<li><p>ÂΩìË∞ÉÁî® execute() ÊñπÊ≥ïÊ∑ªÂä†‰∏Ä‰∏™ËØ∑Ê±Ç‰ªªÂä°Êó∂ÔºåÁ∫øÁ®ãÊ±†‰ºöÂÅöÂ¶Ç‰∏ãÂà§Êñ≠Ôºö</p>
<ul>
<li>Â¶ÇÊûúÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèÂ∞è‰∫é corePoolSizeÔºåÈÇ£‰πàÈ©¨‰∏äÂàõÂª∫Á∫øÁ®ãËøêË°åËøô‰∏™‰ªªÂä°„Äê‚ë°„Äë</li>
<li>Â¶ÇÊûúÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèÂ§ß‰∫éÊàñÁ≠â‰∫é corePoolSizeÔºåÈÇ£‰πàÂ∞ÜËøô‰∏™‰ªªÂä°ÊîæÂÖ•ÈòüÂàó„Äê‚ë¢„Äë</li>
<li>Â¶ÇÊûúËøôÊó∂ÈòüÂàóÊª°‰∫Ü‰∏îÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèËøòÂ∞è‰∫é maximumPoolSizeÔºåÈÇ£‰πà‰ºöÂàõÂª∫ÈùûÊ†∏ÂøÉÁ∫øÁ®ã<strong>Á´ãÂàªËøêË°åËøô‰∏™‰ªªÂä°</strong>ÔºåÂØπ‰∫éÈòªÂ°ûÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°‰∏çÂÖ¨Âπ≥„ÄÇËøôÊòØÂõ†‰∏∫ÂàõÂª∫ÊØè‰∏™ WorkerÔºàÁ∫øÁ®ãÔºâÂØπË±°‰ºöÁªëÂÆö‰∏Ä‰∏™ÂàùÂßã‰ªªÂä°ÔºåÂêØÂä® Worker Êó∂‰ºö‰ºòÂÖàÊâßË°å„Äê‚ë£„Äë</li>
<li>Â¶ÇÊûúÈòüÂàóÊª°‰∫Ü‰∏îÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèÂ§ß‰∫éÊàñÁ≠â‰∫é maximumPoolSizeÔºåÈÇ£‰πàÁ∫øÁ®ãÊ±†‰ºöÂêØÂä®È•±Âíå<strong>ÊãíÁªùÁ≠ñÁï•</strong>Êù•ÊâßË°å„Äê‚ë§„Äë</li>
</ul>
</li>
<li><p>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂÆåÊàê‰ªªÂä°Êó∂Ôºå‰ºö‰ªéÈòüÂàó‰∏≠Âèñ‰∏ã‰∏Ä‰∏™‰ªªÂä°Êù•ÊâßË°å„Äêtake/poll„Äë</p>
</li>
<li><p>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãÁ©∫Èó≤Ë∂ÖËøá‰∏ÄÂÆöÁöÑÊó∂Èó¥ÔºàkeepAliveTimeÔºâÊó∂ÔºåÁ∫øÁ®ãÊ±†‰ºöÂà§Êñ≠ÔºöÂ¶ÇÊûúÂΩìÂâçËøêË°åÁöÑÁ∫øÁ®ãÊï∞Â§ß‰∫é corePoolSizeÔºåÈÇ£‰πàËøô‰∏™Á∫øÁ®ãÂ∞±Ë¢´ÂÅúÊéâÔºåÊâÄ‰ª•Á∫øÁ®ãÊ±†ÁöÑÊâÄÊúâ‰ªªÂä°ÂÆåÊàêÂêéÊúÄÁªà‰ºöÊî∂Áº©Âà∞ corePoolSize Â§ßÂ∞è</p>
</li>
</ol>
<h3 id="üåüÁÆÄË¶ÅËØ¥‰∏ãÁ∫øÁ®ãÊ±†ÁöÑ‰ªªÂä°ÊâßË°åÊú∫Âà∂"><a href="#üåüÁÆÄË¶ÅËØ¥‰∏ãÁ∫øÁ®ãÊ±†ÁöÑ‰ªªÂä°ÊâßË°åÊú∫Âà∂" class="headerlink" title="üåüÁÆÄË¶ÅËØ¥‰∏ãÁ∫øÁ®ãÊ±†ÁöÑ‰ªªÂä°ÊâßË°åÊú∫Âà∂?"></a>üåüÁÆÄË¶ÅËØ¥‰∏ãÁ∫øÁ®ãÊ±†ÁöÑ‰ªªÂä°ÊâßË°åÊú∫Âà∂?</h3><p>execute ‚Äì&gt; addWorker ‚Äì&gt;runworker (getTask)</p>
<p>Á∫øÁ®ãÊ±†ÁöÑÂ∑•‰ΩúÁ∫øÁ®ãÈÄöËøáWokerÁ±ªÂÆûÁé∞ÔºåÂú®ReentrantLockÈîÅÁöÑ‰øùËØÅ‰∏ãÔºåÊääWokerÂÆû‰æãÊèíÂÖ•Âà∞HashSetÂêéÔºåÂπ∂ÂêØÂä®Woker‰∏≠ÁöÑÁ∫øÁ®ã„ÄÇ ‰ªéWokerÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂÆûÁé∞ÂèØ‰ª•ÂèëÁé∞: Á∫øÁ®ãÂ∑•ÂéÇÂú®ÂàõÂª∫Á∫øÁ®ãthreadÊó∂ÔºåÂ∞ÜWokerÂÆû‰æãÊú¨Ë∫´this‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÔºåÂΩìÊâßË°åstartÊñπÊ≥ïÂêØÂä®Á∫øÁ®ãthreadÊó∂ÔºåÊú¨Ë¥®ÊòØÊâßË°å‰∫ÜWorkerÁöÑrunWorkerÊñπÊ≥ï„ÄÇ firstTaskÊâßË°åÂÆåÊàê‰πãÂêéÔºåÈÄöËøágetTaskÊñπÊ≥ï‰ªéÈòªÂ°ûÈòüÂàó‰∏≠Ëé∑ÂèñÁ≠âÂæÖÁöÑ‰ªªÂä°ÔºåÂ¶ÇÊûúÈòüÂàó‰∏≠Ê≤°Êúâ‰ªªÂä°ÔºågetTaskÊñπÊ≥ï‰ºöË¢´ÈòªÂ°ûÂπ∂ÊåÇËµ∑Ôºå‰∏ç‰ºöÂç†Áî®cpuËµÑÊ∫êÔºõ</p>
<h3 id="üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÊèê‰∫§ÁöÑ"><a href="#üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÊèê‰∫§ÁöÑ" class="headerlink" title="üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÊèê‰∫§ÁöÑ?"></a>üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÊèê‰∫§ÁöÑ?</h3><p>ÊñπÂºè‰∏ÄÔºöÊèê‰∫§Êó†ËøîÂõûÂÄºÁöÑ‰ªªÂä° <code>execute()</code></p>
<p>ÊñπÂºè‰∫åÔºöÊèê‰∫§ÊúâËøîÂõûÂÄºÁöÑ‰ªªÂä° <code>submit()</code></p>
<p>submit()ÔºöÊèê‰∫§‰ªªÂä°Ôºå<strong>Êää Runnable Êàñ Callable ‰ªªÂä°Â∞ÅË£ÖÊàê FutureTask ÊâßË°å</strong>ÔºåÂèØ‰ª•ÈÄöËøáÊñπÊ≥ïËøîÂõûÁöÑ‰ªªÂä°ÂØπË±°ÔºåË∞ÉÁî® get ÈòªÂ°ûËé∑Âèñ‰ªªÂä°ÊâßË°åÁöÑÁªìÊûúÊàñËÄÖÂºÇÂ∏∏</p>
<p>execute()ÔºöÊâßË°å‰ªªÂä°Ôºå<strong>‰ΩÜÊòØÊ≤°ÊúâËøîÂõûÂÄºÔºåÊ≤°ÂäûÊ≥ïËé∑Âèñ‰ªªÂä°ÊâßË°åÁªìÊûú</strong>ÔºåÂá∫Áé∞ÂºÇÂ∏∏‰ºöÁõ¥Êé•ÊäõÂá∫‰ªªÂä°ÊâßË°åÊó∂ÁöÑÂºÇÂ∏∏„ÄÇÊ†πÊçÆÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÔºåÈÄâÊã©Ê∑ªÂä†‰ªªÂä°Êó∂ÁöÑÂ§ÑÁêÜÊñπÂºè</p>
<h3 id="üåüexecute-ÊñπÊ≥ïÂíåsubmit-ÊñπÊ≥ïÁöÑÂå∫Âà´"><a href="#üåüexecute-ÊñπÊ≥ïÂíåsubmit-ÊñπÊ≥ïÁöÑÂå∫Âà´" class="headerlink" title="üåüexecute()ÊñπÊ≥ïÂíåsubmit()ÊñπÊ≥ïÁöÑÂå∫Âà´"></a>üåüexecute()ÊñπÊ≥ïÂíåsubmit()ÊñπÊ≥ïÁöÑÂå∫Âà´</h3><blockquote>
<p>Ëøô‰∏™Âú∞ÊñπÈ¶ñÂÖàË¶ÅÁü•ÈÅìRunnableÊé•Âè£ÂíåCallableÊé•Âè£ÁöÑÂå∫Âà´Ôºå‰πãÂâçÊúâÂÜôÂà∞Ëøá</p>
</blockquote>
<p><code>execute()</code>Âíå<code>submit()</code>ÁöÑÂå∫Âà´‰∏ªË¶ÅÊúâ‰∏§ÁÇπÔºö</p>
<ul>
<li>  <code>execute()</code>ÊñπÊ≥ïÂè™ËÉΩÊâßË°å<code>Runnable</code> Á±ªÂûãÁöÑ‰ªªÂä°ÔºåÊ≤°ÊúâËøîÂõûÂÄº„ÄÇ<code>submit()</code>ÊñπÊ≥ïÂèØ‰ª•ÊâßË°å<code>Runnable</code>Âíå <code>Callable</code>Á±ªÂûãÁöÑ‰ªªÂä°ÔºåÂΩì‰ªªÂä°Á±ªÂûã‰∏∫<code>Callable</code>Êó∂ÔºåËøîÂõûÂÄºÁ±ªÂûã‰∏∫<code>Future</code>Ôºå‰ΩÜÂΩì‰ªªÂä°Á±ªÂûã‰∏∫<code>Runnable</code>Êó∂ÔºåËøîÂõûÂÄº‰∏∫<code>null</code>„ÄÇ</li>
<li>  <code>execute()</code> ‰ºöÁõ¥Êé•ÊäõÂá∫‰ªªÂä°ÊâßË°åÊó∂ÁöÑÂºÇÂ∏∏Ôºå<code>submit()</code> ‰ºöÂêûÊéâÂºÇÂ∏∏ÔºåÂèØÈÄöËøá Future ÁöÑ <code>get()</code> ÊñπÊ≥ïÂ∞Ü‰ªªÂä°ÊâßË°åÊó∂ÁöÑÂºÇÂ∏∏ÈáçÊñ∞ÊäõÂá∫</li>
</ul>
<table>
<thead>
<tr>
<th align="center"><code>execute()</code>ÊñπÊ≥ï</th>
<th align="center"><code>submit()</code>ÊñπÊ≥ï</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Âú® <code>Executor</code> Êé•Âè£‰∏≠Â£∞Êòé</td>
<td align="center">Âú® <code>ExecutorService</code> Êé•Âè£‰∏≠Â£∞Êòé</td>
</tr>
<tr>
<td align="center">ÊâßË°å<code>Runnable</code> Á±ªÂûãÁöÑ‰ªªÂä°</td>
<td align="center">ÊâßË°å<code>Runnable</code>Âíå <code>Callable</code>Á±ªÂûãÁöÑ‰ªªÂä°</td>
</tr>
<tr>
<td align="center">ËøîÂõûÁ±ªÂûã‰∏∫ <code>void</code></td>
<td align="center">ËøîÂõûÁ±ªÂûã‰∏∫ <code>Future</code></td>
</tr>
<tr>
<td align="center">‰ºöÁõ¥Êé•ÊäõÂá∫‰ªªÂä°ÊâßË°åÊó∂ÁöÑÂºÇÂ∏∏</td>
<td align="center">‰ºöÂêûÊéâÂºÇÂ∏∏ÔºåÂèØÈÄöËøá Future ÁöÑ <code>get()</code> ÊñπÊ≥ïÂ∞Ü‰ªªÂä°ÊâßË°åÊó∂ÁöÑÂºÇÂ∏∏ÈáçÊñ∞ÊäõÂá∫</td>
</tr>
</tbody></table>
<h3 id="üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÂÖ≥Èó≠ÁöÑ"><a href="#üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÂÖ≥Èó≠ÁöÑ" class="headerlink" title="üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÂÖ≥Èó≠ÁöÑ?"></a>üåüÁ∫øÁ®ãÊ±†‰∏≠‰ªªÂä°ÊòØÂ¶Ç‰ΩïÂÖ≥Èó≠ÁöÑ?</h3><p>Á∫øÁ®ãÊ±†Ëá™Âä®ÂÖ≥Èó≠ÁöÑ‰∏§‰∏™Êù°‰ª∂Ôºö1„ÄÅÁ∫øÁ®ãÊ±†ÁöÑÂºïÁî®‰∏çÂèØËææÔºõ2„ÄÅÁ∫øÁ®ãÊ±†‰∏≠Ê≤°ÊúâÁ∫øÁ®ãÔºõ</p>
<p><code>shutdown()</code>ÔºöÁ∫øÁ®ãÊ±†Áä∂ÊÄÅÂèò‰∏∫ SHUTDOWNÔºåÁ≠âÂæÖ‰ªªÂä°ÊâßË°åÂÆåÂêéÂÖ≥Èó≠Á∫øÁ®ãÊ±†Ôºå‰∏ç‰ºöÊé•Êî∂Êñ∞‰ªªÂä°Ôºå‰ΩÜÂ∑≤Êèê‰∫§‰ªªÂä°‰ºöÊâßË°åÂÆåÔºåËÄå‰∏î‰πüÂèØ‰ª•Ê∑ªÂä†Á∫øÁ®ãÔºà‰∏çÁªëÂÆö‰ªªÂä°Ôºâ</p>
<p><code>shutdownNow()</code>ÔºöÁ∫øÁ®ãÊ±†Áä∂ÊÄÅÂèò‰∏∫ STOPÔºåÁî® interrupt ‰∏≠Êñ≠Ê≠£Âú®ÊâßË°åÁöÑ‰ªªÂä°ÔºåÁõ¥Êé•ÂÖ≥Èó≠Á∫øÁ®ãÊ±†Ôºå‰∏ç‰ºöÊé•Êî∂Êñ∞‰ªªÂä°Ôºå‰ºöÂ∞ÜÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°ËøîÂõû</p>
<p><img src="https://img.jwt1399.top/img/202301031912289.png"></p>
<h3 id="üåüÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁöÑÁ∫øÁ®ãÊï∞‰∏ÄËà¨ÊÄé‰πàËÆæÁΩÆÔºüÈúÄË¶ÅËÄÉËôëÂì™‰∫õÈóÆÈ¢òÔºü"><a href="#üåüÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁöÑÁ∫øÁ®ãÊï∞‰∏ÄËà¨ÊÄé‰πàËÆæÁΩÆÔºüÈúÄË¶ÅËÄÉËôëÂì™‰∫õÈóÆÈ¢òÔºü" class="headerlink" title="üåüÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁöÑÁ∫øÁ®ãÊï∞‰∏ÄËà¨ÊÄé‰πàËÆæÁΩÆÔºüÈúÄË¶ÅËÄÉËôëÂì™‰∫õÈóÆÈ¢òÔºü"></a>üåüÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁöÑÁ∫øÁ®ãÊï∞‰∏ÄËà¨ÊÄé‰πàËÆæÁΩÆÔºüÈúÄË¶ÅËÄÉËôëÂì™‰∫õÈóÆÈ¢òÔºü</h3><blockquote>
<p>ÈÖçÁΩÆÁ∫øÁ®ãÊ±†ÈúÄË¶ÅËÄÉËôëÂì™‰∫õÂõ†Á¥†?</p>
<p>Á∫øÁ®ãÊ±†ÈáåÁöÑÂÖ∑‰ΩìÁöÑÊï∞ÈáèÔºåÂ¶Ç‰ΩïÂéªÂÆö</p>
</blockquote>
<p>‰ªé‰ªªÂä°ÁöÑ‰ºòÂÖàÁ∫ßÔºå‰ªªÂä°ÁöÑÊâßË°åÊó∂Èó¥ÈïøÁü≠Ôºå‰ªªÂä°ÁöÑÊÄßË¥®(CPUÂØÜÈõÜ/ IOÂØÜÈõÜ)Ôºå‰ªªÂä°ÁöÑ‰æùËµñÂÖ≥Á≥ªËøôÂõõ‰∏™ËßíÂ∫¶Êù•ÂàÜÊûê„ÄÇÂπ∂‰∏îÂ∞ΩÂèØËÉΩÂú∞‰ΩøÁî®ÊúâÁïåÁöÑÂ∑•‰ΩúÈòüÂàó„ÄÇ</p>
<p>ÂàõÂª∫Â§öÂ§ßÂÆπÈáèÁöÑÁ∫øÁ®ãÊ±†ÂêàÈÄÇÔºü</p>
<ul>
<li><p>‰∏ÄËà¨Êù•ËØ¥Ê±†‰∏≠<strong>ÊÄªÁ∫øÁ®ãÊï∞ÊòØÊ†∏ÂøÉÊ±†Á∫øÁ®ãÊï∞Èáè‰∏§ÂÄç</strong>ÔºåÁ°Æ‰øùÂΩìÊ†∏ÂøÉÊ±†ÊúâÁ∫øÁ®ãÂÅúÊ≠¢Êó∂ÔºåÊ†∏ÂøÉÊ±†Â§ñÊúâÁ∫øÁ®ãËøõÂÖ•Ê†∏ÂøÉÊ±†</p>
</li>
<li><p>ËøáÂ∞è‰ºöÂØºËá¥Á®ãÂ∫è‰∏çËÉΩÂÖÖÂàÜÂú∞Âà©Áî®Á≥ªÁªüËµÑÊ∫ê„ÄÅÂÆπÊòìÂØºËá¥È••È•ø</p>
</li>
<li><p>ËøáÂ§ß‰ºöÂØºËá¥Êõ¥Â§öÁöÑÁ∫øÁ®ã‰∏ä‰∏ãÊñáÂàáÊç¢ÔºåÂç†Áî®Êõ¥Â§öÂÜÖÂ≠ò</p>
<p>‰∏ä‰∏ãÊñáÂàáÊç¢ÔºöÂΩìÂâç‰ªªÂä°Âú®ÊâßË°åÂÆå CPU Êó∂Èó¥ÁâáÂàáÊç¢Âà∞Âè¶‰∏Ä‰∏™‰ªªÂä°‰πãÂâç‰ºöÂÖà‰øùÂ≠òËá™Â∑±ÁöÑÁä∂ÊÄÅÔºå‰ª•‰æø‰∏ãÊ¨°ÂÜçÂàáÊç¢ÂõûËøô‰∏™‰ªªÂä°Êó∂ÔºåÂèØ‰ª•ÂÜçÂä†ËΩΩËøô‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅÔºå‰ªªÂä°‰ªé‰øùÂ≠òÂà∞ÂÜçÂä†ËΩΩÁöÑËøáÁ®ãÂ∞±ÊòØ‰∏ÄÊ¨°‰∏ä‰∏ãÊñáÂàáÊç¢</p>
</li>
</ul>
<p>ÊÄßË¥®‰∏çÂêåÁöÑ‰ªªÂä°ÂèØÁî®‰ΩøÁî®‰∏çÂêåËßÑÊ®°ÁöÑÁ∫øÁ®ãÊ±†ÂàÜÂºÄÂ§ÑÁêÜÔºöÔºàÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Â∏∏Áî®ÂÖ¨ÂºèÔºâ</p>
<ul>
<li><strong>CPU ÂØÜÈõÜÂûã‰ªªÂä°(N+1)Ôºö</strong> ËøôÁßç‰ªªÂä°Ê∂àËÄóÁöÑ‰∏ªË¶ÅÊòØ CPU ËµÑÊ∫êÔºåÂèØ‰ª•Â∞ÜÁ∫øÁ®ãÊï∞ËÆæÁΩÆ‰∏∫ NÔºàCPU Ê†∏ÂøÉÊï∞Ôºâ+1ÔºåÊØî CPU Ê†∏ÂøÉÊï∞Â§öÂá∫Êù•ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢Á∫øÁ®ãÂÅ∂ÂèëÁöÑÁº∫È°µ‰∏≠Êñ≠ÔºåÊàñËÄÖÂÖ∂ÂÆÉÂéüÂõ†ÂØºËá¥ÁöÑ‰ªªÂä°ÊöÇÂÅúËÄåÂ∏¶Êù•ÁöÑÂΩ±Âìç„ÄÇ‰∏ÄÊó¶‰ªªÂä°ÊöÇÂÅúÔºåCPU Â∞±‰ºöÂ§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÔºåËÄåÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÂ§öÂá∫Êù•ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÂ∞±ÂèØ‰ª•ÂÖÖÂàÜÂà©Áî® CPU ÁöÑÁ©∫Èó≤Êó∂Èó¥„ÄÇ</li>
<li><strong>I/O ÂØÜÈõÜÂûã‰ªªÂä°(2N)Ôºö</strong> ËøôÁßç‰ªªÂä°Â∫îÁî®Ëµ∑Êù•ÔºåÁ≥ªÁªü‰ºöÁî®Â§ßÈÉ®ÂàÜÁöÑÊó∂Èó¥Êù•Â§ÑÁêÜ I/O ‰∫§‰∫íÔºåËÄåÁ∫øÁ®ãÂú®Â§ÑÁêÜ I/O ÁöÑÊó∂Èó¥ÊÆµÂÜÖ‰∏ç‰ºöÂç†Áî® CPU Êù•Â§ÑÁêÜÔºåËøôÊó∂Â∞±ÂèØ‰ª•Â∞Ü CPU ‰∫§Âá∫ÁªôÂÖ∂ÂÆÉÁ∫øÁ®ã‰ΩøÁî®„ÄÇÂõ†Ê≠§Âú® I/O ÂØÜÈõÜÂûã‰ªªÂä°ÁöÑÂ∫îÁî®‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Â§öÈÖçÁΩÆ‰∏Ä‰∫õÁ∫øÁ®ãÔºåÂÖ∑‰ΩìÁöÑËÆ°ÁÆóÊñπÊ≥ïÊòØ 2N„ÄÇ</li>
</ul>
<p><strong>Â¶Ç‰ΩïÂà§Êñ≠ÊòØ CPU ÂØÜÈõÜ‰ªªÂä°ËøòÊòØ IO ÂØÜÈõÜ‰ªªÂä°Ôºü</strong></p>
<p>CPU ÂØÜÈõÜÂûãÁÆÄÂçïÁêÜËß£Â∞±ÊòØÂà©Áî® CPU ËÆ°ÁÆóËÉΩÂäõÁöÑ‰ªªÂä°„ÄÇÊØîÂ¶ÇÂú®ÂÜÖÂ≠ò‰∏≠ÂØπÂ§ßÈáèÊï∞ÊçÆËøõË°åÊéíÂ∫è„ÄÇ</p>
<p> IO ÂØÜÈõÜÂûãÊòØÊ∂âÂèäÂà∞ÁΩëÁªúËØªÂèñÔºåÊñá‰ª∂ËØªÂèñÁöÑËøôÁ±ª‰ªªÂä°„ÄÇËøôÁ±ª‰ªªÂä°ÁöÑÁâπÁÇπÊòØ CPU ËÆ°ÁÆóËÄóË¥πÊó∂Èó¥Áõ∏ÊØî‰∫éÁ≠âÂæÖ IO Êìç‰ΩúÂÆåÊàêÁöÑÊó∂Èó¥Êù•ËØ¥ÂæàÂ∞ëÔºåÂ§ßÈÉ®ÂàÜÊó∂Èó¥ÈÉΩËä±Âú®‰∫ÜÁ≠âÂæÖ IO Êìç‰ΩúÂÆåÊàê‰∏ä„ÄÇ</p>
<h3 id="üåüÂ¶Ç‰ΩïÁõëÊéßÁ∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅ"><a href="#üåüÂ¶Ç‰ΩïÁõëÊéßÁ∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅ" class="headerlink" title="üåüÂ¶Ç‰ΩïÁõëÊéßÁ∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅ?"></a>üåüÂ¶Ç‰ΩïÁõëÊéßÁ∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅ?</h3><p>ÂèØ‰ª•‰ΩøÁî®ThreadPoolExecutor‰ª•‰∏ãÊñπÊ≥ï:</p>
<ul>
<li><code>getTaskCount()</code> Returns the approximate total number of tasks that have ever been scheduled for execution.</li>
<li><code>getCompletedTaskCount()</code> Returns the approximate total number of tasks that have completed execution. ËøîÂõûÁªìÊûúÂ∞ë‰∫égetTaskCount()„ÄÇ</li>
<li><code>getLargestPoolSize()</code> Returns the largest number of threads that have ever simultaneously been in the pool. ËøîÂõûÁªìÊûúÂ∞è‰∫éÁ≠â‰∫émaximumPoolSize</li>
<li><code>getPoolSize()</code> Returns the current number of threads in the pool.</li>
<li><code>getActiveCount()</code> Returns the approximate number of threads that are actively executing tasks.</li>
</ul>
<h3 id="üåüJava-Ëá™Â∏¶ÁöÑÁ∫øÁ®ãÊ±†ÊúâÂì™‰∫õÔºü"><a href="#üåüJava-Ëá™Â∏¶ÁöÑÁ∫øÁ®ãÊ±†ÊúâÂì™‰∫õÔºü" class="headerlink" title="üåüJava Ëá™Â∏¶ÁöÑÁ∫øÁ®ãÊ±†ÊúâÂì™‰∫õÔºü"></a>üåüJava Ëá™Â∏¶ÁöÑÁ∫øÁ®ãÊ±†ÊúâÂì™‰∫õÔºü</h3><blockquote>
<p>‰∏∫‰ªÄ‰πà‰∏çÊé®ËçêÁî® Java È¢ÑËÆæÁöÑÁ∫øÁ®ãÊ±†</p>
</blockquote>
<p>1„ÄÅCachedThreadPoolÔºöËøôÁßçÁ∫øÁ®ãÊ±†Ê≤°ÊúâÁ≠âÂæÖÈòüÂàóÔºàÈòüÂàóÈïøÂ∫¶‰∏∫ 0ÔºâÂÜÖÈÉ®Ê≤°ÊúâÊ†∏ÂøÉÁ∫øÁ®ãÔºåÁ∫øÁ®ãÁöÑÊï∞ÈáèÊòØÊúâÊ≤°ÈôêÂà∂ÁöÑ„ÄÇ<br>2„ÄÅFixedThreadPoolÔºöËØ•Á∫øÁ®ãÊ±†ÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞Á≠â‰∫éÊ†∏ÂøÉÁ∫øÁ®ãÊï∞„ÄÇÁ≠âÂæÖÈòüÂàóÈïøÂ∫¶Êó†Èôê„ÄÇ<br>3„ÄÅSingleThreadPoolÔºöÊúâ‰∏î‰ªÖÊúâ‰∏Ä‰∏™Â∑•‰ΩúÁ∫øÁ®ãÊâßË°å‰ªªÂä°„ÄÇÁ≠âÂæÖÈòüÂàóÈïøÂ∫¶‰∏çÈôê„ÄÇ<br>4„ÄÅScheduledThreadPoolÔºöËÆæÁΩÆ‰∫ÜÊ†∏ÂøÉÁ∫øÁ®ãÊï∞„ÄÇÁ≠âÂæÖÈòüÂàóÈïøÂ∫¶Êó†ÈôêÔºå‰ºöÊåâ‰ªªÂä°ÂêØÂä®Êó∂Èó¥ÊéíÂ∫èÔºåËã•‰∏çÂà∞Êó∂Èó¥Âàô‰ºöÈòªÂ°û„ÄÇ</p>
<blockquote>
<p>‰∏çË¶Å‰ΩøÁî® Java Ëá™Â∏¶ÁöÑÁ∫øÁ®ãÊ±†„ÄÇÂõ†‰∏∫ CachedThreadPool ‰ºöÊó†ÈôêÂàõÂª∫Á∫øÁ®ãÔºåFixedThreadPool„ÄÅSingleThreadPool„ÄÅScheduledThreadPool ‰ºöÊó†ÈôêÂ¢ûÂä†ÈòüÂàóÈïøÂ∫¶Ôºå‰ºöÂØºËá¥Á∫øÁ®ãÊï∞Ê∫¢Âá∫ÊàñÂÜÖÂ≠òÊ∫¢Âá∫„ÄÇ</p>
</blockquote>
<h3 id="üåüScheduledThreadPoolExecutorË¶ÅËß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò"><a href="#üåüScheduledThreadPoolExecutorË¶ÅËß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò" class="headerlink" title="üåüScheduledThreadPoolExecutorË¶ÅËß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò?"></a>üåüScheduledThreadPoolExecutorË¶ÅËß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò?</h3><p>ScheduledThreadPoolExecutorÁªßÊâøËá™ ThreadPoolExecutorÔºå‰∏∫‰ªªÂä°Êèê‰æõÂª∂ËøüÊàñÂë®ÊúüÊâßË°åÔºåÂ±û‰∫éÁ∫øÁ®ãÊ±†ÁöÑ‰∏ÄÁßç„ÄÇ</p>
<h3 id="üåüScheduledThreadPoolExecutorÁõ∏ÊØîThreadPoolExecutorÊúâÂì™‰∫õÁâπÊÄß"><a href="#üåüScheduledThreadPoolExecutorÁõ∏ÊØîThreadPoolExecutorÊúâÂì™‰∫õÁâπÊÄß" class="headerlink" title="üåüScheduledThreadPoolExecutorÁõ∏ÊØîThreadPoolExecutorÊúâÂì™‰∫õÁâπÊÄß?"></a>üåüScheduledThreadPoolExecutorÁõ∏ÊØîThreadPoolExecutorÊúâÂì™‰∫õÁâπÊÄß?</h3><p>Âíå ThreadPoolExecutor Áõ∏ÊØîÔºåÂÆÉËøòÂÖ∑Êúâ‰ª•‰∏ãÂá†ÁßçÁâπÊÄß:</p>
<ul>
<li>‰ΩøÁî®‰∏ìÈó®ÁöÑ‰ªªÂä°Á±ªÂûã‚Äî<code>ScheduledFutureTask</code> Êù•ÊâßË°åÂë®Êúü‰ªªÂä°Ôºå‰πüÂèØ‰ª•Êé•Êî∂‰∏çÈúÄË¶ÅÊó∂Èó¥Ë∞ÉÂ∫¶ÁöÑ‰ªªÂä°(Ëøô‰∫õ‰ªªÂä°ÈÄöËøá ExecutorService Êù•ÊâßË°å)„ÄÇ</li>
<li>‰ΩøÁî®‰∏ìÈó®ÁöÑÂ≠òÂÇ®ÈòüÂàó‚Äî<code>DelayedWorkQueue</code> Êù•Â≠òÂÇ®‰ªªÂä°ÔºåDelayedWorkQueue ÊòØÊó†ÁïåÂª∂ËøüÈòüÂàóDelayQueue ÁöÑ‰∏ÄÁßç„ÄÇÁõ∏ÊØîThreadPoolExecutor‰πüÁÆÄÂåñ‰∫ÜÊâßË°åÊú∫Âà∂(delayedExecuteÊñπÊ≥ï)„ÄÇ</li>
<li>ÊîØÊåÅÂèØÈÄâÁöÑ<code>run-after-shutdown</code>ÂèÇÊï∞ÔºåÂú®Ê±†Ë¢´ÂÖ≥Èó≠(shutdown)‰πãÂêéÊîØÊåÅÂèØÈÄâÁöÑÈÄªËæëÊù•ÂÜ≥ÂÆöÊòØÂê¶ÁªßÁª≠ËøêË°åÂë®ÊúüÊàñÂª∂Ëøü‰ªªÂä°„ÄÇÂπ∂‰∏îÂΩì‰ªªÂä°(ÈáçÊñ∞)Êèê‰∫§Êìç‰Ωú‰∏é shutdown Êìç‰ΩúÈáçÂè†Êó∂ÔºåÂ§çÊü•ÈÄªËæë‰πü‰∏çÁõ∏Âêå„ÄÇ</li>
</ul>
<h3 id="üåüScheduledThreadPoolExecutorÊúâ‰ªÄ‰πàÊ†∑ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊ†∏ÂøÉÂÜÖÈÉ®Á±ªÂíåÊäΩË±°Á±ª"><a href="#üåüScheduledThreadPoolExecutorÊúâ‰ªÄ‰πàÊ†∑ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊ†∏ÂøÉÂÜÖÈÉ®Á±ªÂíåÊäΩË±°Á±ª" class="headerlink" title="üåüScheduledThreadPoolExecutorÊúâ‰ªÄ‰πàÊ†∑ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊ†∏ÂøÉÂÜÖÈÉ®Á±ªÂíåÊäΩË±°Á±ª?"></a>üåüScheduledThreadPoolExecutorÊúâ‰ªÄ‰πàÊ†∑ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊ†∏ÂøÉÂÜÖÈÉ®Á±ªÂíåÊäΩË±°Á±ª?</h3><p>ScheduledThreadPoolExecutor ÂÜÖÈÉ®ÊûÑÈÄ†‰∫Ü‰∏§‰∏™ÂÜÖÈÉ®Á±ª <code>ScheduledFutureTask</code> Âíå <code>DelayedWorkQueue</code>:</p>
<ul>
<li><code>ScheduledFutureTask</code>: ÁªßÊâø‰∫ÜFutureTaskÔºåËØ¥ÊòéÊòØ‰∏Ä‰∏™ÂºÇÊ≠•ËøêÁÆó‰ªªÂä°ÔºõÊúÄ‰∏äÂ±ÇÂàÜÂà´ÂÆûÁé∞‰∫ÜRunnable„ÄÅFuture„ÄÅDelayedÊé•Âè£ÔºåËØ¥ÊòéÂÆÉÊòØ‰∏Ä‰∏™ÂèØ‰ª•Âª∂ËøüÊâßË°åÁöÑÂºÇÊ≠•ËøêÁÆó‰ªªÂä°„ÄÇ</li>
<li><code>DelayedWorkQueue</code>: ËøôÊòØ ScheduledThreadPoolExecutor ‰∏∫Â≠òÂÇ®Âë®ÊúüÊàñÂª∂Ëøü‰ªªÂä°‰∏ìÈó®ÂÆö‰πâÁöÑ‰∏Ä‰∏™Âª∂ËøüÈòüÂàóÔºåÁªßÊâø‰∫Ü AbstractQueueÔºå‰∏∫‰∫ÜÂ•ëÂêà ThreadPoolExecutor ‰πüÂÆûÁé∞‰∫Ü BlockingQueue Êé•Âè£„ÄÇÂÆÉÂÜÖÈÉ®Âè™ÂÖÅËÆ∏Â≠òÂÇ® RunnableScheduledFuture Á±ªÂûãÁöÑ‰ªªÂä°„ÄÇ‰∏é DelayQueue ÁöÑ‰∏çÂêå‰πãÂ§ÑÂ∞±ÊòØÂÆÉÂè™ÂÖÅËÆ∏Â≠òÊîæ RunnableScheduledFuture ÂØπË±°ÔºåÂπ∂‰∏îËá™Â∑±ÂÆûÁé∞‰∫Ü‰∫åÂèâÂ†Ü(DelayQueue ÊòØÂà©Áî®‰∫Ü PriorityQueue ÁöÑ‰∫åÂèâÂ†ÜÁªìÊûÑ)„ÄÇ</li>
</ul>
<h3 id="üåüscheduleAtFixedRate-Âíå-scheduleWithFixedDelayÂå∫Âà´ÊòØ‰ªÄ‰πà"><a href="#üåüscheduleAtFixedRate-Âíå-scheduleWithFixedDelayÂå∫Âà´ÊòØ‰ªÄ‰πà" class="headerlink" title="üåüscheduleAtFixedRate Âíå scheduleWithFixedDelayÂå∫Âà´ÊòØ‰ªÄ‰πà?"></a>üåüscheduleAtFixedRate Âíå scheduleWithFixedDelayÂå∫Âà´ÊòØ‰ªÄ‰πà?</h3><ul>
<li><code>ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable/Callable&lt;V&gt;, long initialDelay, long period, TimeUnit unit)</code>ÔºöÂÆöÊó∂ÊâßË°åÂë®Êúü‰ªªÂä°Ôºå<strong>‰∏çËÄÉËôëÊâßË°åÁöÑËÄóÊó∂</strong>ÔºåÂèÇÊï∞‰∏∫ÂàùÂßãÂª∂ËøüÊó∂Èó¥„ÄÅÈó¥ÈöîÊó∂Èó¥„ÄÅÂçï‰Ωç„ÄÇ‰∏ÄÊ¨°‰ªªÂä°ÁöÑ<strong>ÂêØÂä®</strong>Âà∞‰∏ã‰∏ÄÊ¨°‰ªªÂä°ÁöÑÂêØÂä®‰πãÈó¥Âè™Ë¶Å<strong>Á≠â‰∫éÈó¥ÈöîÊó∂Èó¥</strong>ÔºåÊä¢Âç†Âà∞ CPU Â∞±‰ºöÁ´ãÂç≥ÊâßË°å</li>
<li><code>ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable/Callable&lt;V&gt;, long initialDelay, long delay, TimeUnit unit)</code>ÔºöÂÆöÊó∂ÊâßË°åÂë®Êúü‰ªªÂä°Ôºå<strong>ËÄÉËôëÊâßË°åÁöÑËÄóÊó∂</strong>ÔºåÂèÇÊï∞‰∏∫ÂàùÂßãÂª∂ËøüÊó∂Èó¥„ÄÅÈó¥ÈöîÊó∂Èó¥„ÄÅÂçï‰Ωç„ÄÇ‰∏ÄÊ¨°‰ªªÂä°ÁöÑ<strong>ÁªìÊùü</strong>Âà∞‰∏ã‰∏ÄÊ¨°‰ªªÂä°ÁöÑÂêØÂä®‰πãÈó¥<strong>Á≠â‰∫éÈó¥ÈöîÊó∂Èó¥</strong>ÔºåÊä¢Âç†Âà∞ CPU Â∞±‰ºöÁ´ãÂç≥ÊâßË°åÔºåËøô‰∏™ÊñπÊ≥ïÊâçÊòØÁúüÊ≠£ÁöÑËÆæÁΩÆ‰∏§‰∏™‰ªªÂä°‰πãÈó¥ÁöÑÈó¥Èöî</li>
</ul>
<h3 id="üåü‰∏∫‰ªÄ‰πàThreadPoolExecutor-ÁöÑË∞ÉÊï¥Á≠ñÁï•Âç¥‰∏çÈÄÇÁî®‰∫é-ScheduledThreadPoolExecutor"><a href="#üåü‰∏∫‰ªÄ‰πàThreadPoolExecutor-ÁöÑË∞ÉÊï¥Á≠ñÁï•Âç¥‰∏çÈÄÇÁî®‰∫é-ScheduledThreadPoolExecutor" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàThreadPoolExecutor ÁöÑË∞ÉÊï¥Á≠ñÁï•Âç¥‰∏çÈÄÇÁî®‰∫é ScheduledThreadPoolExecutor?"></a>üåü‰∏∫‰ªÄ‰πàThreadPoolExecutor ÁöÑË∞ÉÊï¥Á≠ñÁï•Âç¥‰∏çÈÄÇÁî®‰∫é ScheduledThreadPoolExecutor?</h3><p>‰æãÂ¶Ç: Áî±‰∫é ScheduledThreadPoolExecutor ÊòØ‰∏Ä‰∏™Âõ∫ÂÆöÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Â§ßÂ∞èÁöÑÁ∫øÁ®ãÊ±†ÔºåÂπ∂‰∏î‰ΩøÁî®‰∫Ü‰∏Ä‰∏™Êó†ÁïåÈòüÂàóÔºåÊâÄ‰ª•Ë∞ÉÊï¥maximumPoolSizeÂØπÂÖ∂Ê≤°Êúâ‰ªª‰ΩïÂΩ±Âìç(ÊâÄ‰ª• ScheduledThreadPoolExecutor Ê≤°ÊúâÊèê‰æõÂèØ‰ª•Ë∞ÉÊï¥ÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÈªòËÆ§ÊúÄÂ§ßÁ∫øÁ®ãÊï∞Âõ∫ÂÆö‰∏∫Integer.MAX_VALUE)„ÄÇÊ≠§Â§ñÔºåËÆæÁΩÆcorePoolSize‰∏∫0ÊàñËÄÖËÆæÁΩÆÊ†∏ÂøÉÁ∫øÁ®ãÁ©∫Èó≤ÂêéÊ∏ÖÈô§(allowCoreThreadTimeOut)ÂêåÊ†∑‰πü‰∏çÊòØ‰∏Ä‰∏™Â•ΩÁöÑÁ≠ñÁï•ÔºåÂõ†‰∏∫‰∏ÄÊó¶Âë®Êúü‰ªªÂä°Âà∞ËææÊüê‰∏ÄÊ¨°ËøêË°åÂë®ÊúüÊó∂ÔºåÂèØËÉΩÂØºËá¥Á∫øÁ®ãÊ±†ÂÜÖÊ≤°ÊúâÁ∫øÁ®ãÂéªÂ§ÑÁêÜËøô‰∫õ‰ªªÂä°„ÄÇ</p>
<h3 id="üåüExecutors-Êèê‰æõ‰∫ÜÂá†ÁßçÊñπÊ≥ïÊù•ÊûÑÈÄ†-ScheduledThreadPoolExecutor"><a href="#üåüExecutors-Êèê‰æõ‰∫ÜÂá†ÁßçÊñπÊ≥ïÊù•ÊûÑÈÄ†-ScheduledThreadPoolExecutor" class="headerlink" title="üåüExecutors Êèê‰æõ‰∫ÜÂá†ÁßçÊñπÊ≥ïÊù•ÊûÑÈÄ† ScheduledThreadPoolExecutor?"></a>üåüExecutors Êèê‰æõ‰∫ÜÂá†ÁßçÊñπÊ≥ïÊù•ÊûÑÈÄ† ScheduledThreadPoolExecutor?</h3><ul>
<li><p>newScheduledThreadPool: ÂèØÊåáÂÆöÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÁöÑÁ∫øÁ®ãÊ±†„ÄÇ</p>
</li>
<li><p>newSingleThreadScheduledExecutor: Âè™Êúâ‰∏Ä‰∏™Â∑•‰ΩúÁ∫øÁ®ãÁöÑÁ∫øÁ®ãÊ±†„ÄÇÂ¶ÇÊûúÂÜÖÈÉ®Â∑•‰ΩúÁ∫øÁ®ãÁî±‰∫éÊâßË°åÂë®Êúü‰ªªÂä°ÂºÇÂ∏∏ËÄåË¢´ÁªàÊ≠¢ÔºåÂàô‰ºöÊñ∞Âª∫‰∏Ä‰∏™Á∫øÁ®ãÊõø‰ª£ÂÆÉÁöÑ‰ΩçÁΩÆ„ÄÇ</p>
</li>
</ul>
<h2 id="‚ù∑Fork-Join"><a href="#‚ù∑Fork-Join" class="headerlink" title="‚ù∑Fork/Join"></a>‚ù∑Fork/Join</h2><h3 id="üåüËØ¥‰∏ãÂØπ-ForkÂíåJoin-Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ÁöÑÁêÜËß£Ôºü"><a href="#üåüËØ¥‰∏ãÂØπ-ForkÂíåJoin-Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ÁöÑÁêÜËß£Ôºü" class="headerlink" title="üåüËØ¥‰∏ãÂØπ ForkÂíåJoin Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ÁöÑÁêÜËß£Ôºü"></a>üåüËØ¥‰∏ãÂØπ ForkÂíåJoin Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ÁöÑÁêÜËß£Ôºü</h3><p>Fork/Join Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÊòØÂàÜÊ≤ª‰ªªÂä°„ÄÇÂàÜÊ≤ªÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØ‚ÄúÂàÜËÄåÊ≤ª‰πã‚ÄùÔºöÂ∞Ü‰∏Ä‰∏™Â§ßÁöÑ‰ªªÂä°ÊãÜÂàÜÊàêÂ∞èÁöÑÂ≠ê‰ªªÂä°ÁöÑÁªìÊûúËÅöÂêàËµ∑Êù•‰ªéËÄåÂæóÂà∞ÊúÄÁªàÁªìÊûú„ÄÇ</p>
<p>Fork/Join Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ÁöÑÊ†∏ÂøÉÁªÑ‰ª∂ÊòØ ForkJoinPool„ÄÇForkJoinPool ÊîØÊåÅ‰ªªÂä°Á™ÉÂèñÊú∫Âà∂ÔºåËÉΩÂ§üËÆ©ÊâÄÊúâÁöÑÁ∫øÁ®ãÁöÑÂ∑•‰ΩúÈáèÂü∫Êú¨ÂùáË°°Ôºå‰∏ç‰ºöÂá∫Áé∞ÊúâÁöÑÁ∫øÁ®ãÂæàÂøôÔºåËÄåÊúâÁöÑÁ∫øÁ®ãÂæàÈó≤ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•ÊÄßËÉΩÂæàÂ•Ω„ÄÇ</p>
<p>ForkJoinPool ‰∏≠ÁöÑ‰ªªÂä°ÈòüÂàóÈááÁî®ÁöÑÊòØÂèåÁ´ØÈòüÂàóÔºåÂ∑•‰ΩúÁ∫øÁ®ãÊ≠£Â∏∏Ëé∑Âèñ‰ªªÂä°Âíå‚ÄúÁ™ÉÂèñ‰ªªÂä°‚ÄùÂàÜÂà´ÊòØ‰ªé‰ªªÂä°ÈòüÂàó‰∏çÂêåÁöÑÁ´ØÊ∂àË¥πÔºåËøôÊ†∑ËÉΩÈÅøÂÖçÂæàÂ§ö‰∏çÂøÖË¶ÅÁöÑÊï∞ÊçÆÁ´û‰∫â„ÄÇ</p>
<h3 id="üåüFork-Join‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò"><a href="#üåüFork-Join‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò" class="headerlink" title="üåüFork/Join‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò?"></a>üåüFork/Join‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥‰ªÄ‰πàÊ†∑ÁöÑÈóÆÈ¢ò?</h3><p>Fork/JoinÊ°ÜÊû∂ÊòØJavaÂπ∂ÂèëÂ∑•ÂÖ∑ÂåÖ‰∏≠ÁöÑ‰∏ÄÁßçÂèØ‰ª•Â∞Ü‰∏Ä‰∏™Â§ß‰ªªÂä°ÊãÜÂàÜ‰∏∫ÂæàÂ§öÂ∞è‰ªªÂä°Êù•ÂºÇÊ≠•ÊâßË°åÁöÑÂ∑•ÂÖ∑ÔºåËá™JDK1.7ÂºïÂÖ•„ÄÇ</p>
<p>Fork/JoinÔºöÁ∫øÁ®ãÊ±†ÁöÑÂÆûÁé∞Ôºå‰ΩìÁé∞ÊòØÂàÜÊ≤ªÊÄùÊÉ≥ÔºåÈÄÇÁî®‰∫éËÉΩÂ§üËøõË°å‰ªªÂä°ÊãÜÂàÜÁöÑ CPU ÂØÜÈõÜÂûãËøêÁÆóÔºåÁî®‰∫é<strong>Âπ∂Ë°åËÆ°ÁÆó</strong></p>
<h3 id="üåüFork-JoinÊ°ÜÊû∂‰∏ªË¶ÅÂåÖÂê´Âì™‰∏â‰∏™Ê®°Âùó-Ê®°Âùó‰πãÈó¥ÁöÑÂÖ≥Á≥ªÊòØÊÄé‰πàÊ†∑ÁöÑ"><a href="#üåüFork-JoinÊ°ÜÊû∂‰∏ªË¶ÅÂåÖÂê´Âì™‰∏â‰∏™Ê®°Âùó-Ê®°Âùó‰πãÈó¥ÁöÑÂÖ≥Á≥ªÊòØÊÄé‰πàÊ†∑ÁöÑ" class="headerlink" title="üåüFork/JoinÊ°ÜÊû∂‰∏ªË¶ÅÂåÖÂê´Âì™‰∏â‰∏™Ê®°Âùó? Ê®°Âùó‰πãÈó¥ÁöÑÂÖ≥Á≥ªÊòØÊÄé‰πàÊ†∑ÁöÑ?"></a>üåüFork/JoinÊ°ÜÊû∂‰∏ªË¶ÅÂåÖÂê´Âì™‰∏â‰∏™Ê®°Âùó? Ê®°Âùó‰πãÈó¥ÁöÑÂÖ≥Á≥ªÊòØÊÄé‰πàÊ†∑ÁöÑ?</h3><ul>
<li>‰ªªÂä°ÂØπË±°: <code>ForkJoinTask</code> (ÂåÖÊã¨<code>RecursiveTask</code>„ÄÅ<code>RecursiveAction</code> Âíå <code>CountedCompleter</code>)</li>
<li>ÊâßË°åFork/Join‰ªªÂä°ÁöÑÁ∫øÁ®ã: <code>ForkJoinWorkerThread</code></li>
<li>Á∫øÁ®ãÊ±†: <code>ForkJoinPool</code></li>
</ul>
<p>Ëøô‰∏âËÄÖÁöÑÂÖ≥Á≥ªÊòØ: ForkJoinPoolÂèØ‰ª•ÈÄöËøáÊ±†‰∏≠ÁöÑForkJoinWorkerThreadÊù•Â§ÑÁêÜForkJoinTask‰ªªÂä°„ÄÇ</p>
<h3 id="üåüÊúâÂì™‰∫õJDKÊ∫êÁ†Å‰∏≠‰ΩøÁî®‰∫ÜFork-JoinÊÄùÊÉ≥"><a href="#üåüÊúâÂì™‰∫õJDKÊ∫êÁ†Å‰∏≠‰ΩøÁî®‰∫ÜFork-JoinÊÄùÊÉ≥" class="headerlink" title="üåüÊúâÂì™‰∫õJDKÊ∫êÁ†Å‰∏≠‰ΩøÁî®‰∫ÜFork/JoinÊÄùÊÉ≥?"></a>üåüÊúâÂì™‰∫õJDKÊ∫êÁ†Å‰∏≠‰ΩøÁî®‰∫ÜFork/JoinÊÄùÊÉ≥?</h3><p>Êàë‰ª¨Â∏∏Áî®ÁöÑÊï∞ÁªÑÂ∑•ÂÖ∑Á±ª Arrays Âú®JDK 8‰πãÂêéÊñ∞Â¢ûÁöÑÂπ∂Ë°åÊéíÂ∫èÊñπÊ≥ï(parallelSort)Â∞±ËøêÁî®‰∫Ü ForkJoinPool ÁöÑÁâπÊÄßÔºåËøòÊúâ ConcurrentHashMap Âú®JDK 8‰πãÂêéÊ∑ªÂä†ÁöÑÂáΩÊï∞ÂºèÊñπÊ≥ï(Â¶ÇforEachÁ≠â)‰πüÊúâËøêÁî®„ÄÇ</p>
<h3 id="üåüÂÜô‰∏Ä‰∏™‰æãÂ≠ê-Áî®ForkJoinÊñπÂºèÂÆûÁé∞1-2-3-‚Ä¶-100000"><a href="#üåüÂÜô‰∏Ä‰∏™‰æãÂ≠ê-Áî®ForkJoinÊñπÂºèÂÆûÁé∞1-2-3-‚Ä¶-100000" class="headerlink" title="üåüÂÜô‰∏Ä‰∏™‰æãÂ≠ê: Áî®ForkJoinÊñπÂºèÂÆûÁé∞1+2+3+‚Ä¶+100000?"></a>üåüÂÜô‰∏Ä‰∏™‰æãÂ≠ê: Áî®ForkJoinÊñπÂºèÂÆûÁé∞1+2+3+‚Ä¶+100000?</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SumTask</span> <span class="token keyword">extends</span> <span class="token class-name">RecursiveTask</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>
        
        <span class="token keyword">final</span> <span class="token keyword">int</span> start<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ÂºÄÂßãËÆ°ÁÆóÁöÑÊï∞</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> end<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ÊúÄÂêéËÆ°ÁÆóÁöÑÊï∞</span>
        
        <span class="token function">SumTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> start<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> end<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> Integer <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//Â¶ÇÊûúËÆ°ÁÆóÈáèÂ∞è‰∫é1000ÔºåÈÇ£‰πàÂàÜÈÖç‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åif‰∏≠ÁöÑ‰ª£Á†ÅÂùóÔºåÂπ∂ËøîÂõûÊâßË°åÁªìÊûú</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ÂºÄÂßãÊâßË°å: "</span> <span class="token operator">+</span> start <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>
                <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">//Â¶ÇÊûúËÆ°ÁÆóÈáèÂ§ß‰∫é1000ÔºåÈÇ£‰πàÊãÜÂàÜ‰∏∫‰∏§‰∏™‰ªªÂä°</span>
            SumTask task1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> end<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            SumTask task2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span><span class="token punctuation">(</span>start <span class="token operator">+</span> end<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//ÊâßË°å‰ªªÂä°</span>
            task1<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            task2<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//Ëé∑Âèñ‰ªªÂä°ÊâßË°åÁöÑÁªìÊûú</span>
            <span class="token keyword">return</span> task1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> task2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException<span class="token punctuation">,</span> ExecutionException <span class="token punctuation">{</span>
        ForkJoinPool pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ForkJoinTask<span class="token operator">&lt;</span>Integer<span class="token operator">></span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SumTask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
ForkJoinPool-1-worker-1 ÂºÄÂßãÊâßË°å: 1-625
ForkJoinPool-1-worker-7 ÂºÄÂßãÊâßË°å: 6251-6875
ForkJoinPool-1-worker-6 ÂºÄÂßãÊâßË°å: 5626-6250
ForkJoinPool-1-worker-10 ÂºÄÂßãÊâßË°å: 3751-4375
ForkJoinPool-1-worker-13 ÂºÄÂßãÊâßË°å: 2501-3125
ForkJoinPool-1-worker-8 ÂºÄÂßãÊâßË°å: 626-1250
ForkJoinPool-1-worker-11 ÂºÄÂßãÊâßË°å: 5001-5625
ForkJoinPool-1-worker-3 ÂºÄÂßãÊâßË°å: 7501-8125
ForkJoinPool-1-worker-14 ÂºÄÂßãÊâßË°å: 1251-1875
ForkJoinPool-1-worker-4 ÂºÄÂßãÊâßË°å: 9376-10000
ForkJoinPool-1-worker-8 ÂºÄÂßãÊâßË°å: 8126-8750
ForkJoinPool-1-worker-0 ÂºÄÂßãÊâßË°å: 1876-2500
ForkJoinPool-1-worker-12 ÂºÄÂßãÊâßË°å: 4376-5000
ForkJoinPool-1-worker-5 ÂºÄÂßãÊâßË°å: 8751-9375
ForkJoinPool-1-worker-7 ÂºÄÂßãÊâßË°å: 6876-7500
ForkJoinPool-1-worker-1 ÂºÄÂßãÊâßË°å: 3126-3750
50005000
**/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="‚ë§JUCÈîÅ"><a href="#‚ë§JUCÈîÅ" class="headerlink" title="‚ë§JUCÈîÅ"></a>‚ë§JUCÈîÅ</h1><p><img src="https://img.jwt1399.top/img/202301051556064.png"></p>
<h2 id="‚ù∂AQS"><a href="#‚ù∂AQS" class="headerlink" title="‚ù∂AQS"></a>‚ù∂AQS</h2><h3 id="üåüAQS-ÊòØ‰ªÄ‰πàÔºü"><a href="#üåüAQS-ÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüAQS ÊòØ‰ªÄ‰πàÔºü"></a>üåüAQS ÊòØ‰ªÄ‰πàÔºü</h3><blockquote>
<p>ËØ¥‰∏ãÂØπÂêåÊ≠•Âô® AQS ÁöÑÁêÜËß£Ôºü</p>
</blockquote>
<p>AQS ÁöÑÂÖ®Áß∞‰∏∫ <code>AbstractQueuedSynchronizer</code> ÔºåÊäΩË±°ÈòüÂàóÂêåÊ≠•Âô®„ÄÇËøô‰∏™Á±ªÂú® <code>java.util.concurrent.locks</code> ÂåÖ‰∏ãÈù¢„ÄÇÊòØ‰∏Ä‰∏™Áî®Êù•ÊûÑÂª∫ÈîÅÂíåÂêåÊ≠•Âô®ÁöÑÊ°ÜÊû∂ÔºåÂÉèReentrantLockÔºåSemaphoreÔºåFutureTaskÔºåReentrantReadWriteLockÔºåSynchronousQueueÈÉΩÊòØÂü∫‰∫éAQSÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>ÁÆÄÂçïÊù•ËØ¥ÔºåAQSÂ∞±ÊòØÁª¥Êä§‰∫Ü‰∏Ä‰∏™ÂÖ±‰∫´ËµÑÊ∫êÔºåÁÑ∂Âêé‰ΩøÁî®ÈòüÂàóÊù•‰øùËØÅÁ∫øÁ®ãÊéíÈòüËé∑ÂèñËµÑÊ∫êÁöÑ‰∏Ä‰∏™ËøáÁ®ã„ÄÇ</p>
<h3 id="üåüAQS-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"><a href="#üåüAQS-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüAQS ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"></a>üåüAQS ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü</h3><p>AQS Ê†∏ÂøÉÊÄùÊÉ≥</p>
<ul>
<li><p>Â¶ÇÊûúË¢´ËØ∑Ê±ÇÁöÑÂÖ±‰∫´ËµÑÊ∫êÁ©∫Èó≤ÔºåÂàôÂ∞ÜÂΩìÂâçËØ∑Ê±ÇËµÑÊ∫êÁöÑÁ∫øÁ®ãËÆæÁΩÆ‰∏∫ÊúâÊïàÁöÑÂ∑•‰ΩúÁ∫øÁ®ãÔºåÂπ∂Â∞ÜÂÖ±‰∫´ËµÑÊ∫êËÆæÁΩÆÈîÅÂÆöÁä∂ÊÄÅ</p>
</li>
<li><p>Â¶ÇÊûúËØ∑Ê±ÇÁöÑÂÖ±‰∫´ËµÑÊ∫êË¢´Âç†Áî®ÔºåAQS Áî® <strong>CLH ÈòüÂàóÈîÅ</strong> ÂÆûÁé∞‰∫ÜÁ∫øÁ®ãÈòªÂ°ûÁ≠âÂæÖ‰ª•ÂèäË¢´Âî§ÈÜíÊó∂ÈîÅÂàÜÈÖçÁöÑÊú∫Âà∂ÔºåÂ∞ÜÊöÇÊó∂Ëé∑Âèñ‰∏çÂà∞ÈîÅÁöÑÁ∫øÁ®ãÂä†ÂÖ•Âà∞ÈòüÂàó‰∏≠</p>
</li>
</ul>
<p><img src="https://img.jwt1399.top/img/202301041734275.png" alt="AQSÂéüÁêÜÂõæ"></p>
<p>AQS ÊòØÁª¥Êä§‰∫Ü‰∏Ä‰∏™ÂÖ±‰∫´ËµÑÊ∫êÂíå‰∏Ä‰∏™ FIFO ÁöÑÁ∫øÁ®ãÁ≠âÂæÖÈòüÂàó</p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">private</span> volatile int state<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//Áî®‰∫éÂ±ïÁ§∫ÂΩìÂâç‰∏¥ÁïåËµÑÊ∫êÁöÑËé∑ÈîÅÊÉÖÂÜµ</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÈÄöËøá<code>volatile</code>Êù•‰øùËØÅ state ÁöÑÁ∫øÁ®ãÂèØËßÅÊÄßÔºåstate ÁöÑËÆøÈóÆÊñπÂºè‰∏ªË¶ÅÊúâ‰∏âÁßçÔºåÂ¶Ç‰∏ã</p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">protected</span> final int <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token comment" spellcheck="true">//Ëé∑ÂèñstateÁöÑÂÄº</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">protected</span> final <span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span>int newState<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//ËÆæÁΩÆstateÁöÑÂÄº</span>
    state <span class="token operator">=</span> newState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//‰ΩøÁî® volatile ‰øÆÈ•∞ÈÖçÂêà casÔºå‰øùËØÅ‰øÆÊîπÊó∂ÁöÑÂéüÂ≠êÊÄß</span>
<span class="token keyword">protected</span> final boolean <span class="token function">compareAndSetState</span><span class="token punctuation">(</span>int expect<span class="token punctuation">,</span> int update<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//ÈÄöËøáCASÊìç‰ΩúÊõ¥Êñ∞stateÁöÑÂÄº</span>
    <span class="token keyword">return</span> unsafe<span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> stateOffset<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="üåüAQSÁöÑËµÑÊ∫êÂÖ±‰∫´ÊñπÂºèÊúâÂì™‰∫õÔºü"><a href="#üåüAQSÁöÑËµÑÊ∫êÂÖ±‰∫´ÊñπÂºèÊúâÂì™‰∫õÔºü" class="headerlink" title="üåüAQSÁöÑËµÑÊ∫êÂÖ±‰∫´ÊñπÂºèÊúâÂì™‰∫õÔºü"></a>üåüAQSÁöÑËµÑÊ∫êÂÖ±‰∫´ÊñπÂºèÊúâÂì™‰∫õÔºü</h3><ul>
<li>  ExclusiveÔºöÁã¨Âç†ÔºåÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÊâßË°åÔºå‰æãÂ¶ÇReentrantLockÔºåÂèàÂèØÂàÜ‰∏∫ÂÖ¨Âπ≥ÈîÅÂíåÈùûÂÖ¨Âπ≥ÈîÅ</li>
<li>  ShareÔºöÂÖ±‰∫´ÔºåÂ§ö‰∏™Á∫øÁ®ãÂèØÂêåÊó∂ÊâßË°åÔºåÂ¶ÇÔºöCountDownLatch„ÄÅSemaphore„ÄÅCountDownLatch„ÄÅ CyclicBarrier„ÄÅReadWriteLock„ÄÇ</li>
</ul>
<h3 id="üåüAQSÂ∫ïÂ±Ç‰ΩøÁî®‰∫Ü‰ªÄ‰πàÊ†∑ÁöÑËÆæËÆ°Ê®°Âºè"><a href="#üåüAQSÂ∫ïÂ±Ç‰ΩøÁî®‰∫Ü‰ªÄ‰πàÊ†∑ÁöÑËÆæËÆ°Ê®°Âºè" class="headerlink" title="üåüAQSÂ∫ïÂ±Ç‰ΩøÁî®‰∫Ü‰ªÄ‰πàÊ†∑ÁöÑËÆæËÆ°Ê®°Âºè?"></a>üåüAQSÂ∫ïÂ±Ç‰ΩøÁî®‰∫Ü‰ªÄ‰πàÊ†∑ÁöÑËÆæËÆ°Ê®°Âºè?</h3><p>Ê®°ÊùøÔºå ÂÖ±‰∫´ÈîÅÂíåÁã¨Âç†ÈîÅÂú®‰∏Ä‰∏™Êé•Âè£Á±ª‰∏≠„ÄÇ</p>
<h3 id="üåüÂ¶Ç‰Ωï‰ΩøÁî®AQSËá™ÂÆö‰πâÂêåÊ≠•Âô®Ôºü"><a href="#üåüÂ¶Ç‰Ωï‰ΩøÁî®AQSËá™ÂÆö‰πâÂêåÊ≠•Âô®Ôºü" class="headerlink" title="üåüÂ¶Ç‰Ωï‰ΩøÁî®AQSËá™ÂÆö‰πâÂêåÊ≠•Âô®Ôºü"></a>üåüÂ¶Ç‰Ωï‰ΩøÁî®AQSËá™ÂÆö‰πâÂêåÊ≠•Âô®Ôºü</h3><blockquote>
<p>AQS Â∫ïÂ±Ç‰ΩøÁî®‰∫ÜÊ®°ÊùøÊñπÊ≥ïÊ®°ÂºèÔºå‰Ω†ËÉΩËØ¥Âá∫Âá†‰∏™ÈúÄË¶ÅÈáçÂÜôÁöÑÊñπÊ≥ïÂêóÔºü</p>
</blockquote>
<p>AQSÁöÑÂ∫ïÂ±Ç‰ΩøÁî®‰∫ÜÊ®°ÊùøÊñπÊ≥ïÊ®°ÂºèÔºåËá™ÂÆö‰πâÂêåÊ≠•Âô®Âè™ÈúÄË¶Å‰∏§Ê≠•Ôºö</p>
<p>Á¨¨‰∏ÄÔºåÁªßÊâø<code>AbstractQueuedSynchronizer</code></p>
<p>Á¨¨‰∫åÔºåÈáçÂÜô‰ª•‰∏ãÂá†ÁßçÊñπÊ≥ïÔºö</p>
<ol>
<li><p> isHeldExclusively() ÔºöËØ•Á∫øÁ®ãÊòØÂê¶Ê≠£Âú®Áã¨Âç†ËµÑÊ∫ê„ÄÇÂè™ÊúâÁî®Âà∞ condition ÊâçÈúÄË¶ÅÂéªÂÆûÁé∞ÂÆÉ„ÄÇ</p>
</li>
<li><p> tryAcquire(int) ÔºöÁã¨Âç†ÊñπÂºè„ÄÇÂ∞ùËØïËé∑ÂèñËµÑÊ∫êÔºåÊàêÂäüÂàôËøîÂõû trueÔºåÂ§±Ë¥•ÂàôËøîÂõû false„ÄÇ</p>
</li>
<li><p> tryRelease(int) ÔºöÁã¨Âç†ÊñπÂºè„ÄÇÂ∞ùËØïÈáäÊîæËµÑÊ∫êÔºåÊàêÂäüÂàôËøîÂõû trueÔºåÂ§±Ë¥•ÂàôËøîÂõû false„ÄÇ</p>
</li>
<li><p> tryAcquireShared(int) ÔºöÂÖ±‰∫´ÊñπÂºè„ÄÇÂ∞ùËØïËé∑ÂèñËµÑÊ∫ê„ÄÇË¥üÊï∞Ë°®Á§∫Â§±Ë¥•Ôºõ0 Ë°®Á§∫ÊàêÂäüÔºå‰ΩÜÊ≤°ÊúâÂâ©‰ΩôÂèØÁî®ËµÑÊ∫êÔºõÊ≠£Êï∞Ë°®Á§∫ÊàêÂäüÔºå‰∏îÊúâÂâ©‰ΩôËµÑÊ∫ê„ÄÇ</p>
</li>
<li><p> tryReleaseShared(int) ÔºöÂÖ±‰∫´ÊñπÂºè„ÄÇÂ∞ùËØïÈáäÊîæËµÑÊ∫êÔºåÊàêÂäüÂàôËøîÂõû trueÔºåÂ§±Ë¥•ÂàôËøîÂõû false„ÄÇ</p>
</li>
</ol>
<h3 id="üåüAQS-ÂÖ±‰∫´ÈîÅÂíåÁã¨Âç†ÈîÅÁöÑÂå∫Âà´Ôºü"><a href="#üåüAQS-ÂÖ±‰∫´ÈîÅÂíåÁã¨Âç†ÈîÅÁöÑÂå∫Âà´Ôºü" class="headerlink" title="üåüAQS ÂÖ±‰∫´ÈîÅÂíåÁã¨Âç†ÈîÅÁöÑÂå∫Âà´Ôºü"></a>üåüAQS ÂÖ±‰∫´ÈîÅÂíåÁã¨Âç†ÈîÅÁöÑÂå∫Âà´Ôºü</h3><p>ÂÖ±‰∫´Âºè‰∏éÁã¨Âç†ÂºèÁöÑÊúÄ‰∏ªË¶Å<strong>Âå∫Âà´</strong>Âú®‰∫éÔºö</p>
<ul>
<li>Áã¨Âç†ÂºèÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩÊúâ<strong>‰∏Ä‰∏™Á∫øÁ®ã</strong>Ëé∑ÂèñÂêåÊ≠•Áä∂ÊÄÅ</li>
<li>ÂÖ±‰∫´ÂºèÂêå‰∏ÄÊó∂ÂàªÂèØ‰ª•ÊúâÂ§ö‰∏™Á∫øÁ®ãËé∑ÂèñÂêåÊ≠•Áä∂ÊÄÅ</li>
</ul>
<p>‰æãÂ¶ÇËØªÊìç‰ΩúÂèØ‰ª•ÊúâÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ËøõË°åÔºåËÄåÂÜôÊìç‰ΩúÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãËøõË°åÂÜôÊìç‰ΩúÔºåÂÖ∂‰ªñÊìç‰ΩúÈÉΩ‰ºöË¢´ÈòªÂ°û„ÄÇ</p>
<p>acquire Âíå acquireShared ÁöÑÂå∫Âà´ÔºöacquireShared Âú®Ëé∑ÂèñÈîÅÂêé‰ºöË∞ÉÁî® doReleaseShared() Âî§ÈÜí‰∏ã‰∏Ä‰∏™ËäÇÁÇπÔºõacquire ‰∏ç‰ºöÔºåÂè™‰ºöÂî§ÈÜí‰∏Ä‰∏™<br>release Âíå releaseShared ÁöÑÂå∫Âà´ÔºöreleaseSharedÈúÄË¶ÅÁ°Æ‰øùÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂõ†‰∏∫ÂèØËÉΩ‰ºöÊúâÂá†‰∏™Á∫øÁ®ãÂêåÊó∂ÈáäÊîæÔºõrelease‰∏çÈúÄË¶Å‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂõ†‰∏∫‰∏ÄÂÆöÊòØÁã¨Âç†ÁöÑ</p>
<h2 id="‚ù∑ReentrantLock"><a href="#‚ù∑ReentrantLock" class="headerlink" title="‚ù∑ReentrantLock"></a>‚ù∑ReentrantLock</h2><h3 id="üåüReentrantLock-ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØÈáçÂÖ•ÊÄßÁöÑ"><a href="#üåüReentrantLock-ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØÈáçÂÖ•ÊÄßÁöÑ" class="headerlink" title="üåüReentrantLock ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØÈáçÂÖ•ÊÄßÁöÑ?"></a>üåüReentrantLock ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂèØÈáçÂÖ•ÊÄßÁöÑ?</h3><p><code>ReentrantLock</code>ÂÜÖÈÉ®Ëá™ÂÆö‰πâ‰∫ÜÂêåÊ≠•Âô®syncÔºåÂú®Âä†ÈîÅÁöÑÊó∂ÂÄôÈÄöËøáCASÁÆóÊ≥ïÔºåÂ∞ÜÁ∫øÁ®ãÂØπË±°ÊîæÂà∞‰∏Ä‰∏™ÂèåÂêëÈìæË°®‰∏≠ÔºåÊØèÊ¨°Ëé∑ÂèñÈîÅÁöÑÊó∂ÂÄôÔºåÊ£ÄÊü•ÂΩìÂâçÁª¥Êä§ÁöÑÈÇ£‰∏™Á∫øÁ®ãIDÂíåÂΩìÂâçËØ∑Ê±ÇÁöÑÁ∫øÁ®ãIDÊòØÂê¶ ‰∏ÄËá¥ÔºåÂ¶ÇÊûú‰∏ÄËá¥ÔºåÂêåÊ≠•Áä∂ÊÄÅÂä†1ÔºåË°®Á§∫ÈîÅË¢´ÂΩìÂâçÁ∫øÁ®ãËé∑Âèñ‰∫ÜÂ§öÊ¨°„ÄÇ</p>
<h3 id="üåüReentrantLockÁöÑÊ†∏ÂøÉÊòØAQSÔºåÈÇ£‰πàÂÆÉÊÄé‰πàÊù•ÂÆûÁé∞ÁöÑ-ÁªßÊâø"><a href="#üåüReentrantLockÁöÑÊ†∏ÂøÉÊòØAQSÔºåÈÇ£‰πàÂÆÉÊÄé‰πàÊù•ÂÆûÁé∞ÁöÑ-ÁªßÊâø" class="headerlink" title="üåüReentrantLockÁöÑÊ†∏ÂøÉÊòØAQSÔºåÈÇ£‰πàÂÆÉÊÄé‰πàÊù•ÂÆûÁé∞ÁöÑ? ÁªßÊâø"></a>üåüReentrantLockÁöÑÊ†∏ÂøÉÊòØAQSÔºåÈÇ£‰πàÂÆÉÊÄé‰πàÊù•ÂÆûÁé∞ÁöÑ? ÁªßÊâø</h3><p>ÈÄöËøáÂàÜÊûêReentrantLockÁöÑÊ∫êÁ†ÅÔºåÂèØÁü•ÂØπÂÖ∂Êìç‰ΩúÈÉΩËΩ¨Âåñ‰∏∫ÂØπSyncÂØπË±°ÁöÑÊìç‰ΩúÔºåÁî±‰∫éSyncÁªßÊâø‰∫ÜAQSÔºåÊâÄ‰ª•Âü∫Êú¨‰∏äÈÉΩÂèØ‰ª•ËΩ¨Âåñ‰∏∫ÂØπAQSÁöÑÊìç‰Ωú„ÄÇÂ¶ÇÂ∞ÜReentrantLockÁöÑlockÂáΩÊï∞ËΩ¨Âåñ‰∏∫ÂØπSyncÁöÑlockÂáΩÊï∞ÁöÑË∞ÉÁî®ÔºåËÄåÂÖ∑‰Ωì‰ºöÊ†πÊçÆÈááÁî®ÁöÑÁ≠ñÁï•(Â¶ÇÂÖ¨Âπ≥Á≠ñÁï•ÊàñËÄÖÈùûÂÖ¨Âπ≥Á≠ñÁï•)ÁöÑ‰∏çÂêåËÄåË∞ÉÁî®Âà∞SyncÁöÑ‰∏çÂêåÂ≠êÁ±ª„ÄÇ</p>
<p>ÊâÄ‰ª•ÂèØÁü•ÔºåÂú®ReentrantLockÁöÑËÉåÂêéÔºåÊòØAQSÂØπÂÖ∂ÊúçÂä°Êèê‰æõ‰∫ÜÊîØÊåÅ„ÄÇ</p>
<p>ReentrantLockÊÄªÂÖ±Êúâ‰∏â‰∏™ÂÜÖÈÉ®Á±ªÔºåÂπ∂‰∏î‰∏â‰∏™ÂÜÖÈÉ®Á±ªÊòØÁ¥ßÂØÜÁõ∏ÂÖ≥ÁöÑÔºå‰∏ãÈù¢ÂÖàÁúã‰∏â‰∏™Á±ªÁöÑÂÖ≥Á≥ª„ÄÇ</p>
<p><img src="../images/Q&A%EF%BC%9AJUC/java-thread-x-juc-reentrantlock-1.png"></p>
<ul>
<li>ReentrantLockÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂÖ¨Âπ≥ÈîÅÁöÑ? FairSync</li>
<li>ReentrantLockÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÈùûÂÖ¨Âπ≥ÈîÅÁöÑ? UnFairSync</li>
<li>ReentrantLockÈªòËÆ§ÂÆûÁé∞ÁöÑÊòØÂÖ¨Âπ≥ËøòÊòØÈùûÂÖ¨Âπ≥ÈîÅ?ÈùûÂÖ¨Âπ≥ÈîÅ</li>
</ul>
<h3 id="üåü‰∏∫‰∫ÜÊúâ‰∫ÜReentrantLockËøòÈúÄË¶ÅReentrantReadWriteLock"><a href="#üåü‰∏∫‰∫ÜÊúâ‰∫ÜReentrantLockËøòÈúÄË¶ÅReentrantReadWriteLock" class="headerlink" title="üåü‰∏∫‰∫ÜÊúâ‰∫ÜReentrantLockËøòÈúÄË¶ÅReentrantReadWriteLock?"></a>üåü‰∏∫‰∫ÜÊúâ‰∫ÜReentrantLockËøòÈúÄË¶ÅReentrantReadWriteLock?</h3><p>ËØªÈîÅÂíåÂÜôÈîÅÂàÜÁ¶ªÔºöReentrantReadWriteLockË°®Á§∫ÂèØÈáçÂÖ•ËØªÂÜôÈîÅÔºåReentrantReadWriteLock‰∏≠ÂåÖÂê´‰∫Ü‰∏§ÁßçÈîÅÔºåËØªÈîÅReadLockÂíåÂÜôÈîÅWriteLockÔºåÂèØ‰ª•ÈÄöËøáËøô‰∏§ÁßçÈîÅÂÆûÁé∞Á∫øÁ®ãÈó¥ÁöÑÂêåÊ≠•„ÄÇ</p>
<p>ReentrantReadWriteLock ÂÖ∂<strong>ËØªÈîÅÊòØÂÖ±‰∫´ÈîÅÔºåÂÜôÈîÅÊòØÁã¨Âç†ÈîÅ</strong></p>
<p>ÂèØÂÆûÁé∞ËØªËØªÂÖ±‰∫´ÔºåËØªÂÜô‰∫íÊñ•ÔºåÂÜôÂÜô‰∫íÊñ•</p>
<h3 id="üåüReentrantReadWriteLockÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ"><a href="#üåüReentrantReadWriteLockÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ" class="headerlink" title="üåüReentrantReadWriteLockÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ?"></a>üåüReentrantReadWriteLockÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ?</h3><p>Âü∫‰∫éAQSÂíåLockÂÆûÁé∞</p>
<p>ReentrantReadWriteLockÊúâ‰∫î‰∏™ÂÜÖÈÉ®Á±ªÔºå‰∫î‰∏™ÂÜÖÈÉ®Á±ª‰πãÈó¥‰πüÊòØÁõ∏‰∫íÂÖ≥ËÅîÁöÑ„ÄÇÂÜÖÈÉ®Á±ªÁöÑÂÖ≥Á≥ªÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ</p>
<p><img src="../images/Q&A%EF%BC%9AJUC/java-thread-x-readwritelock-1.png"></p>
<p>SyncÁªßÊâøËá™AQS„ÄÅNonfairSyncÁªßÊâøËá™SyncÁ±ª„ÄÅFairSyncÁªßÊâøËá™SyncÁ±ªÔºõReadLockÂÆûÁé∞‰∫ÜLockÊé•Âè£„ÄÅWriteLock‰πüÂÆûÁé∞‰∫ÜLockÊé•Âè£„ÄÇ</p>
<h3 id="üåüReentrantReadWriteLockÂ∫ïÂ±ÇËØªÂÜôÁä∂ÊÄÅÂ¶Ç‰ΩïËÆæËÆ°ÁöÑ"><a href="#üåüReentrantReadWriteLockÂ∫ïÂ±ÇËØªÂÜôÁä∂ÊÄÅÂ¶Ç‰ΩïËÆæËÆ°ÁöÑ" class="headerlink" title="üåüReentrantReadWriteLockÂ∫ïÂ±ÇËØªÂÜôÁä∂ÊÄÅÂ¶Ç‰ΩïËÆæËÆ°ÁöÑ?"></a>üåüReentrantReadWriteLockÂ∫ïÂ±ÇËØªÂÜôÁä∂ÊÄÅÂ¶Ç‰ΩïËÆæËÆ°ÁöÑ?</h3><p>È´ò16‰Ωç‰∏∫ËØªÈîÅÔºå‰Ωé16‰Ωç‰∏∫ÂÜôÈîÅ</p>
<ul>
<li><p>ËØªÈîÅÂíåÂÜôÈîÅÁöÑÊúÄÂ§ßÊï∞ÈáèÊòØÂ§öÂ∞ë?  2ÁöÑ16Ê¨°Êñπ-1</p>
</li>
<li><p>Êú¨Âú∞Á∫øÁ®ãËÆ°Êï∞Âô®ThreadLocalHoldCounterÊòØÁî®Êù•ÂÅö‰ªÄ‰πàÁöÑ?Êú¨Âú∞Á∫øÁ®ãËÆ°Êï∞Âô®Ôºå‰∏éÂØπË±°ÁªëÂÆöÔºàÁ∫øÁ®ã-„ÄãÁ∫øÁ®ãÈáçÂÖ•ÁöÑÊ¨°Êï∞Ôºâ</p>
</li>
<li><p>ÂÜôÈîÅÁöÑËé∑Âèñ‰∏éÈáäÊîæÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ?  tryAcquire/tryRelease</p>
</li>
<li><p>ËØªÈîÅÁöÑËé∑Âèñ‰∏éÈáäÊîæÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ?  tryAcquireShared/tryReleaseShared</p>
</li>
</ul>
<h2 id="‚ù∏Semaphore"><a href="#‚ù∏Semaphore" class="headerlink" title="‚ù∏Semaphore"></a>‚ù∏Semaphore</h2><h3 id="üåüSemaphore-Êúâ‰ªÄ‰πàÁî®Ôºü"><a href="#üåüSemaphore-Êúâ‰ªÄ‰πàÁî®Ôºü" class="headerlink" title="üåüSemaphore Êúâ‰ªÄ‰πàÁî®Ôºü"></a>üåüSemaphore Êúâ‰ªÄ‰πàÁî®Ôºü</h3><p><code>synchronized</code> Âíå <code>ReentrantLock</code> ÈÉΩÊòØ‰∏ÄÊ¨°Âè™ÂÖÅËÆ∏‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÊüê‰∏™ËµÑÊ∫êÔºåËÄå<code>Semaphore</code>(‰ø°Âè∑Èáè)ÂèØ‰ª•Áî®Êù•ÊéßÂà∂ÂêåÊó∂ËÆøÈóÆÁâπÂÆöËµÑÊ∫êÁöÑÁ∫øÁ®ãÊï∞Èáè„ÄÇ</p>
<p>ÊâßË°å acquire ÊñπÊ≥ïÈòªÂ°ûÔºåÁõ¥Âà∞Êúâ‰∏Ä‰∏™ËÆ∏ÂèØËØÅÂèØ‰ª•Ëé∑ÂæóÁÑ∂ÂêéÊãøËµ∞‰∏Ä‰∏™ËÆ∏ÂèØËØÅÔºõ</p>
<p>ÊØè‰∏™ release ÊñπÊ≥ïÂ¢ûÂä†‰∏Ä‰∏™ËÆ∏ÂèØËØÅÔºåËøôÂèØËÉΩ‰ºöÈáäÊîæ‰∏Ä‰∏™ÈòªÂ°ûÁöÑ acquire ÊñπÊ≥ï„ÄÇ</p>
<p>ÁÑ∂ËÄåÔºåÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâÂÆûÈôÖÁöÑËÆ∏ÂèØËØÅËøô‰∏™ÂØπË±°ÔºåSemaphore Âè™ÊòØÁª¥ÊåÅ‰∫Ü‰∏Ä‰∏™ÂèØËé∑ÂæóËÆ∏ÂèØËØÅÁöÑÊï∞Èáè„ÄÇ</p>
<p>Semaphore ÁªèÂ∏∏Áî®‰∫éÈôêÂà∂Ëé∑ÂèñÊüêÁßçËµÑÊ∫êÁöÑÁ∫øÁ®ãÊï∞Èáè„ÄÇÂΩìÁÑ∂‰∏ÄÊ¨°‰πüÂèØ‰ª•‰∏ÄÊ¨°ÊãøÂèñÂíåÈáäÊîæÂ§ö‰∏™ËÆ∏ÂèØËØÅÔºå‰∏çËøá‰∏ÄËà¨Ê≤°ÊúâÂøÖË¶ÅËøôÊ†∑ÂÅö„ÄÇÈô§‰∫Ü acquireÊñπÊ≥ïÔºàÈòªÂ°ûÔºâ‰πãÂ§ñÔºåÂè¶‰∏Ä‰∏™ÊØîËæÉÂ∏∏Áî®ÁöÑ‰∏é‰πãÂØπÂ∫îÁöÑÊñπÊ≥ïÊòØ tryAcquire ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÂ¶ÇÊûúËé∑Âèñ‰∏çÂà∞ËÆ∏ÂèØÂ∞±Á´ãÂç≥ËøîÂõû false„ÄÇ</p>
<p><code>Semaphore</code> ÈÄöÂ∏∏Áî®‰∫éÈÇ£‰∫õËµÑÊ∫êÊúâÊòéÁ°ÆËÆøÈóÆÊï∞ÈáèÈôêÂà∂ÁöÑÂú∫ÊôØÊØîÂ¶ÇÈôêÊµÅÔºà‰ªÖÈôê‰∫éÂçïÊú∫Ê®°ÂºèÔºåÂÆûÈôÖÈ°πÁõÆ‰∏≠Êé®Ëçê‰ΩøÁî® Redis +Lua Êù•ÂÅöÈôêÊµÅÔºâ„ÄÇ</p>
<h3 id="üåüSemaphore-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"><a href="#üåüSemaphore-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüSemaphore ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"></a>üåüSemaphore ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü</h3><p><code>Semaphore</code> ÊòØÂÖ±‰∫´ÈîÅÁöÑ‰∏ÄÁßçÂÆûÁé∞ÔºåÂÆÉÈªòËÆ§ÊûÑÈÄ† AQS ÁöÑ <code>state</code> ÂÄº‰∏∫ <code>permits</code>Ôºå‰Ω†ÂèØ‰ª•Â∞Ü <code>permits</code> ÁöÑÂÄºÁêÜËß£‰∏∫ËÆ∏ÂèØËØÅÁöÑÊï∞ÈáèÔºåÂè™ÊúâÊãøÂà∞ËÆ∏ÂèØËØÅÁöÑÁ∫øÁ®ãÊâçËÉΩÊâßË°å„ÄÇ</p>
<p>Ë∞ÉÁî®<code>semaphore.acquire()</code> ÔºåÁ∫øÁ®ãÂ∞ùËØïËé∑ÂèñËÆ∏ÂèØËØÅÔºåÂ¶ÇÊûú <code>state&gt;=0</code> ÁöÑËØùÔºåÂàôË°®Á§∫ÂèØ‰ª•Ëé∑ÂèñÊàêÂäü„ÄÇÂ¶ÇÊûúËé∑ÂèñÊàêÂäüÁöÑËØùÔºå‰ΩøÁî® CAS Êìç‰ΩúÂéª‰øÆÊîπ <code>state</code> ÁöÑÂÄº <code>state=state-1</code>„ÄÇÂ¶ÇÊûú <code>state&lt;0</code> ÁöÑËØùÔºåÂàôË°®Á§∫ËÆ∏ÂèØËØÅÊï∞Èáè‰∏çË∂≥„ÄÇÊ≠§Êó∂‰ºöÂàõÂª∫‰∏Ä‰∏™ <code>Node</code> ËäÇÁÇπÂä†ÂÖ•ÈòªÂ°ûÈòüÂàóÔºåÊåÇËµ∑ÂΩìÂâçÁ∫øÁ®ã„ÄÇ</p>
<p>Ë∞ÉÁî®<code>semaphore.release()</code> ÔºåÁ∫øÁ®ãÂ∞ùËØïÈáäÊîæËÆ∏ÂèØËØÅÔºåÂπ∂‰ΩøÁî® CAS Êìç‰ΩúÂéª‰øÆÊîπ <code>state</code> ÁöÑÂÄº <code>state=state+1</code>„ÄÇÈáäÊîæËÆ∏ÂèØËØÅÊàêÂäü‰πãÂêéÔºåÂêåÊó∂‰ºöÂî§ÈÜíÂêåÊ≠•ÈòüÂàó‰∏≠ÁöÑ‰∏Ä‰∏™Á∫øÁ®ã„ÄÇË¢´Âî§ÈÜíÁöÑÁ∫øÁ®ã‰ºöÈáçÊñ∞Â∞ùËØïÂéª‰øÆÊîπ <code>state</code> ÁöÑÂÄº <code>state=state-1</code> ÔºåÂ¶ÇÊûú <code>state&gt;=0</code> ÂàôËé∑Âèñ‰ª§ÁâåÊàêÂäüÔºåÂê¶ÂàôÈáçÊñ∞ËøõÂÖ•ÈòªÂ°ûÈòüÂàóÔºåÊåÇËµ∑Á∫øÁ®ã„ÄÇ</p>
<h4 id="üåüSemaphoreÂ∏∏Áî®ÊñπÊ≥ïÊúâÂì™‰∫õ-Â¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•Âíå‰∫íÊñ•ÁöÑ"><a href="#üåüSemaphoreÂ∏∏Áî®ÊñπÊ≥ïÊúâÂì™‰∫õ-Â¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•Âíå‰∫íÊñ•ÁöÑ" class="headerlink" title="üåüSemaphoreÂ∏∏Áî®ÊñπÊ≥ïÊúâÂì™‰∫õ? Â¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•Âíå‰∫íÊñ•ÁöÑ?"></a>üåüSemaphoreÂ∏∏Áî®ÊñπÊ≥ïÊúâÂì™‰∫õ? Â¶Ç‰ΩïÂÆûÁé∞Á∫øÁ®ãÂêåÊ≠•Âíå‰∫íÊñ•ÁöÑ?</h4><p>acquireÂáΩÊï∞</p>
<p>releaseÂáΩÊï∞</p>
<h3 id="üåüSemaphoreÂú∫ÊôØÈóÆÈ¢ò"><a href="#üåüSemaphoreÂú∫ÊôØÈóÆÈ¢ò" class="headerlink" title="üåüSemaphoreÂú∫ÊôØÈóÆÈ¢ò"></a>üåüSemaphoreÂú∫ÊôØÈóÆÈ¢ò</h3><ul>
<li>SemaphoreÂàùÂßãÂåñÊúâ10‰∏™‰ª§ÁâåÔºå11‰∏™Á∫øÁ®ãÂêåÊó∂ÂêÑË∞ÉÁî®1Ê¨°acquireÊñπÊ≥ïÔºå‰ºöÂèëÁîü‰ªÄ‰πà?</li>
</ul>
<p>Êãø‰∏çÂà∞‰ª§ÁâåÁöÑÁ∫øÁ®ãÈòªÂ°ûÔºå‰∏ç‰ºöÁªßÁª≠ÂæÄ‰∏ãËøêË°å„ÄÇ</p>
<ul>
<li>SemaphoreÂàùÂßãÂåñÊúâ10‰∏™‰ª§ÁâåÔºå‰∏Ä‰∏™Á∫øÁ®ãÈáçÂ§çË∞ÉÁî®11Ê¨°acquireÊñπÊ≥ïÔºå‰ºöÂèëÁîü‰ªÄ‰πà?</li>
</ul>
<p>Á∫øÁ®ãÈòªÂ°ûÔºå‰∏ç‰ºöÁªßÁª≠ÂæÄ‰∏ãËøêË°å„ÄÇÂèØËÉΩ‰Ω†‰ºöËÄÉËôëÁ±ª‰ºº‰∫éÈîÅÁöÑÈáçÂÖ•ÁöÑÈóÆÈ¢òÔºåÂæàÂ•ΩÔºå‰ΩÜÊòØÔºå‰ª§ÁâåÊ≤°ÊúâÈáçÂÖ•ÁöÑÊ¶ÇÂøµ„ÄÇ‰Ω†Âè™Ë¶ÅË∞ÉÁî®‰∏ÄÊ¨°acquireÊñπÊ≥ïÔºåÂ∞±ÈúÄË¶ÅÊúâ‰∏Ä‰∏™‰ª§ÁâåÊâçËÉΩÁªßÁª≠ËøêË°å„ÄÇ</p>
<ul>
<li>SemaphoreÂàùÂßãÂåñÊúâ1‰∏™‰ª§ÁâåÔºå1‰∏™Á∫øÁ®ãË∞ÉÁî®‰∏ÄÊ¨°acquireÊñπÊ≥ïÔºåÁÑ∂ÂêéË∞ÉÁî®‰∏§Ê¨°releaseÊñπÊ≥ïÔºå‰πãÂêéÂè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®acquire(2)ÊñπÊ≥ïÔºåÊ≠§Á∫øÁ®ãËÉΩÂ§üËé∑ÂèñÂà∞Ë∂≥Â§üÁöÑ‰ª§ÁâåÂπ∂ÁªßÁª≠ËøêË°åÂêó?</li>
</ul>
<p>ËÉΩÔºåÂéüÂõ†ÊòØreleaseÊñπÊ≥ï‰ºöÊ∑ªÂä†‰ª§ÁâåÔºåÂπ∂‰∏ç‰ºö‰ª•ÂàùÂßãÂåñÁöÑÂ§ßÂ∞è‰∏∫ÂáÜ„ÄÇ</p>
<ul>
<li>SemaphoreÂàùÂßãÂåñÊúâ2‰∏™‰ª§ÁâåÔºå‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®1Ê¨°releaseÊñπÊ≥ïÔºåÁÑ∂Âêé‰∏ÄÊ¨°ÊÄßËé∑Âèñ3‰∏™‰ª§ÁâåÔºå‰ºöËé∑ÂèñÂà∞Âêó?</li>
</ul>
<p>ËÉΩÔºåÂéüÂõ†ÊòØrelease‰ºöÊ∑ªÂä†‰ª§ÁâåÔºåÂπ∂‰∏ç‰ºö‰ª•ÂàùÂßãÂåñÁöÑÂ§ßÂ∞è‰∏∫ÂáÜ„ÄÇSemaphore‰∏≠releaseÊñπÊ≥ïÁöÑË∞ÉÁî®Âπ∂Ê≤°ÊúâÈôêÂà∂Ë¶ÅÂú®acquireÂêéË∞ÉÁî®„ÄÇ</p>
<h2 id="‚ùπLockSupport"><a href="#‚ùπLockSupport" class="headerlink" title="‚ùπLockSupport"></a>‚ùπLockSupport</h2><p>LockSupportÁî®Êù•ÂàõÂª∫ÈîÅÂíåÂÖ∂‰ªñÂêåÊ≠•Á±ªÁöÑÂü∫Êú¨Á∫øÁ®ãÈòªÂ°ûÂéüËØ≠„ÄÇÁÆÄËÄåË®Ä‰πãÔºåÂΩìË∞ÉÁî®LockSupport.parkÊó∂ÔºåË°®Á§∫ÂΩìÂâçÁ∫øÁ®ãÂ∞Ü‰ºöÁ≠âÂæÖÔºåÁõ¥Ëá≥Ëé∑ÂæóËÆ∏ÂèØÔºåÂΩìË∞ÉÁî®LockSupport.unparkÊó∂ÔºåÂøÖÈ°ªÊääÁ≠âÂæÖËé∑ÂæóËÆ∏ÂèØÁöÑÁ∫øÁ®ã‰Ωú‰∏∫ÂèÇÊï∞ËøõË°å‰º†ÈÄíÔºåÂ•ΩËÆ©Ê≠§Á∫øÁ®ãÁªßÁª≠ËøêË°å„ÄÇ</p>
<h3 id="üåü‰∏∫‰ªÄ‰πàLockSupport‰πüÊòØÊ†∏ÂøÉÂü∫Á°ÄÁ±ª"><a href="#üåü‰∏∫‰ªÄ‰πàLockSupport‰πüÊòØÊ†∏ÂøÉÂü∫Á°ÄÁ±ª" class="headerlink" title="üåü‰∏∫‰ªÄ‰πàLockSupport‰πüÊòØÊ†∏ÂøÉÂü∫Á°ÄÁ±ª?"></a>üåü‰∏∫‰ªÄ‰πàLockSupport‰πüÊòØÊ†∏ÂøÉÂü∫Á°ÄÁ±ª?</h3><p>AQSÊ°ÜÊû∂ÂÄüÂä©‰∫é‰∏§‰∏™Á±ªÔºöUnsafe(Êèê‰æõCASÊìç‰Ωú)ÂíåLockSupport(Êèê‰æõpark/unparkÊìç‰Ωú)</p>
<h3 id="üåüÈÄöËøáwait-notifyÂÆûÁé∞ÂêåÊ≠•"><a href="#üåüÈÄöËøáwait-notifyÂÆûÁé∞ÂêåÊ≠•" class="headerlink" title="üåüÈÄöËøáwait/notifyÂÆûÁé∞ÂêåÊ≠•"></a>üåüÈÄöËøáwait/notifyÂÆûÁé∞ÂêåÊ≠•</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ÊåÇËµ∑Á∫øÁ®ã</span>
<span class="token keyword">synchronized</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">while</span><span class="token punctuation">(</span>Êù°‰ª∂ÊàêÁ´ã<span class="token punctuation">)</span><span class="token punctuation">{</span>
          lock<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
      <span class="token comment" spellcheck="true">// Â∑•‰Ωú‰ª£Á†Å</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//Âî§ÈÜíÁ∫øÁ®ã</span>
<span class="token keyword">synchronized</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span class="token punctuation">{</span>
  lock<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰ΩøÁî®wait/notifyÂÆûÁé∞ÂêåÊ≠•Êó∂ÔºåÂøÖÈ°ªÂÖàË∞ÉÁî®waitÔºåÂêéË∞ÉÁî®notifyÔºåÂ¶ÇÊûúÂÖàË∞ÉÁî®notifyÔºåÂÜçË∞ÉÁî®waitÔºåÂ∞ÜËµ∑‰∏ç‰∫Ü‰ΩúÁî®„ÄÇ</p>
<h3 id="üåüÈÄöËøápark-unparkÂÆûÁé∞ÂêåÊ≠•"><a href="#üåüÈÄöËøápark-unparkÂÆûÁé∞ÂêåÊ≠•" class="headerlink" title="üåüÈÄöËøápark/unparkÂÆûÁé∞ÂêåÊ≠•"></a>üåüÈÄöËøápark/unparkÂÆûÁé∞ÂêåÊ≠•</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/**
 *ÂÖà park ÂÜç unpark
**/</span>
<span class="token comment" spellcheck="true">//ÊåÇËµ∑Á∫øÁ®ã</span>
Thread t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LockSupport<span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// Â∑•‰Ωú‰ª£Á†Å</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//Âî§ÈÜíÁ∫øÁ®ã</span>
LockSupport<span class="token punctuation">.</span><span class="token function">unpark</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 *ÂÖà unpark ÂÜç park
**/</span>
<span class="token comment" spellcheck="true">//ÊåÇËµ∑Á∫øÁ®ã</span>
Thread t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    LockSupport<span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// Â∑•‰Ωú‰ª£Á†Å</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//Âî§ÈÜíÁ∫øÁ®ã</span>
LockSupport<span class="token punctuation">.</span><span class="token function">unpark</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰ΩøÁî®park/unparkÂÆûÁé∞ÂêåÊ≠•Êó∂ÔºåÂèØ‰ª•ÂÖàË∞ÉÁî®unparkÔºåÂÜçË∞ÉÁî®parkÔºå‰∏ç‰ºöÈÄ†ÊàêÁî±wait/notifyË∞ÉÁî®È°∫Â∫è‰∏çÂΩìÊâÄÂºïËµ∑ÁöÑÈòªÂ°û„ÄÇÂõ†Ê≠§park/unparkÁõ∏ÊØîwait/notifyÊõ¥Âä†ÁöÑÁÅµÊ¥ª„ÄÇ</p>
<h3 id="üåüObject-wait-ÂíåCondition-await-ÁöÑÂå∫Âà´"><a href="#üåüObject-wait-ÂíåCondition-await-ÁöÑÂå∫Âà´" class="headerlink" title="üåüObject.wait()ÂíåCondition.await()ÁöÑÂå∫Âà´"></a>üåüObject.wait()ÂíåCondition.await()ÁöÑÂå∫Âà´</h3><p><code>Object.wait()</code>Âíå<code>Condition.await()</code>ÁöÑÂéüÁêÜÊòØÂü∫Êú¨‰∏ÄËá¥ÁöÑÔºå‰∏çÂêåÁöÑÊòØ<code>Condition.await()</code>Â∫ïÂ±ÇÊòØË∞ÉÁî®<code>LockSupport.park()</code>Êù•ÂÆûÁé∞ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÁöÑ„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÔºåÂÆÉÂú®ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã‰πãÂâçËøòÂπ≤‰∫Ü‰∏§‰ª∂‰∫ãÔºå‰∏ÄÊòØÊääÂΩìÂâçÁ∫øÁ®ãÊ∑ªÂä†Âà∞Êù°‰ª∂ÈòüÂàó‰∏≠Ôºå‰∫åÊòØ‚ÄúÂÆåÂÖ®‚ÄùÈáäÊîæÈîÅÔºå‰πüÂ∞±ÊòØËÆ©stateÁä∂ÊÄÅÂèòÈáèÂèò‰∏∫0ÔºåÁÑ∂ÂêéÊâçÊòØË∞ÉÁî®<code>LockSupport.park()</code>ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã„ÄÇ</p>
<h3 id="üåüThread-sleep-ÂíåLockSupport-park-ÁöÑÂå∫Âà´"><a href="#üåüThread-sleep-ÂíåLockSupport-park-ÁöÑÂå∫Âà´" class="headerlink" title="üåüThread.sleep()ÂíåLockSupport.park()ÁöÑÂå∫Âà´"></a>üåüThread.sleep()ÂíåLockSupport.park()ÁöÑÂå∫Âà´</h3><blockquote>
<p>LockSupport.park()ËøòÊúâÂá†‰∏™ÂÖÑÂºüÊñπÊ≥ïÔºöparkNanos()„ÄÅparkUtil()Á≠âÔºåÊàë‰ª¨ËøôÈáåËØ¥ÁöÑpark()ÊñπÊ≥ïÁªüÁß∞Ëøô‰∏ÄÁ±ªÊñπÊ≥ï„ÄÇ</p>
</blockquote>
<p>Áõ∏ÂêåÁÇπÔºöÈÉΩÊòØÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÁöÑÊâßË°åÔºå‰∏îÈÉΩ‰∏ç‰ºöÈáäÊîæÂΩìÂâçÁ∫øÁ®ãÂç†ÊúâÁöÑÈîÅËµÑÊ∫êÔºõ</p>
<p>Âå∫Âà´Ôºö</p>
<ul>
<li><code>Thread.sleep()</code>Ê≤°Ê≥ï‰ªéÂ§ñÈÉ®Âî§ÈÜíÔºåÂè™ËÉΩËá™Â∑±ÈÜíËøáÊù•Ôºõ</li>
<li><code>LockSupport.park()</code>ÊñπÊ≥ïÂèØ‰ª•Ë¢´Âè¶‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®LockSupport.unpark()ÊñπÊ≥ïÂî§ÈÜíÔºõ</li>
<li><code>Thread.sleep()</code>ÊñπÊ≥ïÂ£∞Êòé‰∏äÊäõÂá∫‰∫Ü<code>InterruptedException</code>‰∏≠Êñ≠ÂºÇÂ∏∏ÔºåÊâÄ‰ª•Ë∞ÉÁî®ËÄÖÈúÄË¶ÅÊçïËé∑Ëøô‰∏™ÂºÇÂ∏∏ÊàñËÄÖÂÜçÊäõÂá∫Ôºõ</li>
<li><code>LockSupport.park()</code>ÊñπÊ≥ï‰∏çÈúÄË¶ÅÊçïËé∑‰∏≠Êñ≠ÂºÇÂ∏∏Ôºõ</li>
<li><code>Thread.sleep()</code>Êú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™<code>native</code>ÊñπÊ≥ïÔºõ</li>
<li><code>LockSupport.park()</code>Â∫ïÂ±ÇÊòØË∞ÉÁî®ÁöÑ<code>Unsafe</code>ÁöÑ<code>native</code>ÊñπÊ≥ïÔºõ</li>
</ul>
<h3 id="üåüObject-wait-ÂíåLockSupport-park-ÁöÑÂå∫Âà´"><a href="#üåüObject-wait-ÂíåLockSupport-park-ÁöÑÂå∫Âà´" class="headerlink" title="üåüObject.wait()ÂíåLockSupport.park()ÁöÑÂå∫Âà´"></a>üåüObject.wait()ÂíåLockSupport.park()ÁöÑÂå∫Âà´</h3><p>Áõ∏ÂêåÁÇπÔºö‰∫åËÄÖÈÉΩ‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÁöÑËøêË°å</p>
<p>Âå∫Âà´Ôºö</p>
<ul>
<li><code>wait()</code>ÊñπÊ≥ïÈúÄË¶ÅÂú®<code>synchronized</code>Âùó‰∏≠ÊâßË°åÔºõ<code>park()</code>ÂèØ‰ª•Âú®‰ªªÊÑèÂú∞ÊñπÊâßË°åÔºõ</li>
</ul>
<ul>
<li>park Ôºåunpark <strong>‰ª•Á∫øÁ®ã‰∏∫Âçï‰Ωç</strong>Êù•ÈòªÂ°ûÂíåÂî§ÈÜíÁ∫øÁ®ãÔºåËÄå notify Âè™ËÉΩÈöèÊú∫Âî§ÈÜí‰∏Ä‰∏™Á≠âÂæÖÁ∫øÁ®ãÔºånotifyAll ÊòØÂî§ÈÜíÊâÄÊúâÁ≠âÂæÖÁ∫øÁ®ã</li>
<li>park Ôºåunpark ÂèØ‰ª•ÂÖà unparkÔºåËÄå wait &amp; notify ‰∏çËÉΩÂÖà notify„ÄÇ</li>
<li>wait ‰ºöÈáäÊîæÈîÅËµÑÊ∫êËøõÂÖ•Á≠âÂæÖÈòüÂàóÔºå<strong>park ‰∏ç‰ºöÈáäÊîæÈîÅËµÑÊ∫ê</strong>ÔºåÂè™Ë¥üË¥£ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºå‰ºöÈáäÊîæ CPU</li>
</ul>
<ul>
<li><code>wait()</code>ÊñπÊ≥ïÂ£∞ÊòéÊäõÂá∫‰∫Ü‰∏≠Êñ≠ÂºÇÂ∏∏ÔºåË∞ÉÁî®ËÄÖÈúÄË¶ÅÊçïËé∑ÊàñËÄÖÂÜçÊäõÂá∫Ôºõ<code>park()</code>‰∏çÈúÄË¶ÅÊçïËé∑‰∏≠Êñ≠ÂºÇÂ∏∏Ôºõ</li>
</ul>
<p>park()/unpark()Â∫ïÂ±ÇÁöÑÂéüÁêÜÊòØ‚Äú‰∫åÂÖÉ‰ø°Âè∑Èáè‚ÄùÔºå‰Ω†ÂèØ‰ª•ÊääÂÆÉÁõ∏ÂÉèÊàêÂè™Êúâ‰∏Ä‰∏™ËÆ∏ÂèØËØÅÁöÑSemaphoreÔºåÂè™‰∏çËøáËøô‰∏™‰ø°Âè∑ÈáèÂú®ÈáçÂ§çÊâßË°åunpark()ÁöÑÊó∂ÂÄô‰πü‰∏ç‰ºöÂÜçÂ¢ûÂä†ËÆ∏ÂèØËØÅÔºåÊúÄÂ§öÂè™Êúâ‰∏Ä‰∏™ËÆ∏ÂèØËØÅ„ÄÇ</p>
<h3 id="üåüÂ¶ÇÊûúÂú®wait-‰πãÂâçÊâßË°å‰∫Ünotify-‰ºöÊÄéÊ†∑"><a href="#üåüÂ¶ÇÊûúÂú®wait-‰πãÂâçÊâßË°å‰∫Ünotify-‰ºöÊÄéÊ†∑" class="headerlink" title="üåüÂ¶ÇÊûúÂú®wait()‰πãÂâçÊâßË°å‰∫Ünotify()‰ºöÊÄéÊ†∑?"></a>üåüÂ¶ÇÊûúÂú®wait()‰πãÂâçÊâßË°å‰∫Ünotify()‰ºöÊÄéÊ†∑?</h3><ul>
<li><p>Â¶ÇÊûúÂΩìÂâçÁöÑÁ∫øÁ®ã‰∏çÊòØÊ≠§ÂØπË±°ÈîÅÁöÑÊâÄÊúâËÄÖÔºåÂç¥Ë∞ÉÁî®ËØ•ÂØπË±°ÁöÑnotify()Êàñwait()ÊñπÊ≥ïÊó∂ÊäõÂá∫<code>IllegalMonitorStateException</code>ÂºÇÂ∏∏Ôºõ</p>
</li>
<li><p>Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊòØÊ≠§ÂØπË±°ÈîÅÁöÑÊâÄÊúâËÄÖÔºåwait()Â∞Ü‰∏ÄÁõ¥ÈòªÂ°ûÔºåÂõ†‰∏∫ÂêéÁª≠Â∞ÜÊ≤°ÊúâÂÖ∂ÂÆÉnotify()Âî§ÈÜíÂÆÉ„ÄÇ</p>
</li>
</ul>
<p>ÁªìËÆ∫Ôºöwait &amp; notify ‰∏çËÉΩÂÖà notify</p>
<h3 id="üåüÂ¶ÇÊûúÂú®park-‰πãÂâçÊâßË°å‰∫Üunpark-‰ºöÊÄéÊ†∑"><a href="#üåüÂ¶ÇÊûúÂú®park-‰πãÂâçÊâßË°å‰∫Üunpark-‰ºöÊÄéÊ†∑" class="headerlink" title="üåüÂ¶ÇÊûúÂú®park()‰πãÂâçÊâßË°å‰∫Üunpark()‰ºöÊÄéÊ†∑?"></a>üåüÂ¶ÇÊûúÂú®park()‰πãÂâçÊâßË°å‰∫Üunpark()‰ºöÊÄéÊ†∑?</h3><p>Á∫øÁ®ã‰∏ç‰ºöË¢´ÈòªÂ°ûÔºåÁõ¥Êé•Ë∑≥Ëøápark()ÔºåÁªßÁª≠ÊâßË°åÂêéÁª≠ÂÜÖÂÆπ</p>
<p>ÁªìËÆ∫ÔºöÂÖà park ÂÜç unpark ÂíåÂÖà unpark ÂÜç park ÊïàÊûú‰∏ÄÊ†∑ÔºåÈÉΩ‰ºöÁõ¥Êé•ÊÅ¢Â§çÁ∫øÁ®ãÁöÑËøêË°å</p>
<h3 id="üåüLockSupport-park-‰ºöÈáäÊîæÈîÅËµÑÊ∫êÂêó"><a href="#üåüLockSupport-park-‰ºöÈáäÊîæÈîÅËµÑÊ∫êÂêó" class="headerlink" title="üåüLockSupport.park()‰ºöÈáäÊîæÈîÅËµÑÊ∫êÂêó?"></a>üåüLockSupport.park()‰ºöÈáäÊîæÈîÅËµÑÊ∫êÂêó?</h3><p>‰∏ç‰ºöÔºåÂÆÉÂè™Ë¥üË¥£ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºåÈáäÊîæÈîÅËµÑÊ∫êÂÆûÈôÖ‰∏äÊòØÂú®ConditionÁöÑawait()ÊñπÊ≥ï‰∏≠ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<h1 id="‚ë•JUCÂ∑•ÂÖ∑Á±ª"><a href="#‚ë•JUCÂ∑•ÂÖ∑Á±ª" class="headerlink" title="‚ë•JUCÂ∑•ÂÖ∑Á±ª"></a>‚ë•JUCÂ∑•ÂÖ∑Á±ª</h1><h2 id="‚ù∂CountDownLatch"><a href="#‚ù∂CountDownLatch" class="headerlink" title="‚ù∂CountDownLatch"></a>‚ù∂CountDownLatch</h2><h3 id="üåü‰ªÄ‰πàÊòØCountDownLatch"><a href="#üåü‰ªÄ‰πàÊòØCountDownLatch" class="headerlink" title="üåü‰ªÄ‰πàÊòØCountDownLatch?"></a>üåü‰ªÄ‰πàÊòØCountDownLatch?</h3><blockquote>
<p>CountDownLatch Êúâ‰ªÄ‰πàÁî®Ôºü</p>
</blockquote>
<p>CountDownLatchÔºåËÆ°Êï∞Âô®ÔºåÂ∫ïÂ±Ç‰πüÊòØÁî±AQSÔºåÁî®Êù•ËøõË°åÁ∫øÁ®ãÂêåÊ≠•Âçè‰ΩúÔºåÁ≠âÂæÖÊâÄÊúâÁ∫øÁ®ãÂÆåÊàê</p>
<p>CountDownLatch ÂÖÅËÆ∏ <code>count</code> ‰∏™Á∫øÁ®ãÈòªÂ°ûÂú®‰∏Ä‰∏™Âú∞ÊñπÔºåÁõ¥Ëá≥ÊâÄÊúâÁ∫øÁ®ãÁöÑ‰ªªÂä°ÈÉΩÊâßË°åÂÆåÊØï„ÄÇ</p>
<p><code>CountDownLatch</code> ÊòØ‰∏ÄÊ¨°ÊÄßÁöÑÔºåËÆ°Êï∞Âô®ÁöÑÂÄºÂè™ËÉΩÂú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÂàùÂßãÂåñ‰∏ÄÊ¨°Ôºå‰πãÂêéÊ≤°Êúâ‰ªª‰ΩïÊú∫Âà∂ÂÜçÊ¨°ÂØπÂÖ∂ËÆæÁΩÆÂÄºÔºåÂΩì <code>CountDownLatch</code> ‰ΩøÁî®ÂÆåÊØïÂêéÔºåÂÆÉ‰∏çËÉΩÂÜçÊ¨°Ë¢´‰ΩøÁî®„ÄÇ</p>
<p>CountDownLatch‰∏ÄÊ¨°ÂèØ‰ª•Âî§ÈÜíÂá†‰∏™‰ªªÂä°? Â§ö‰∏™</p>
<h3 id="üåüCountDownLatchÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ"><a href="#üåüCountDownLatchÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ" class="headerlink" title="üåüCountDownLatchÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ?"></a>üåüCountDownLatchÂ∫ïÂ±ÇÂÆûÁé∞ÂéüÁêÜ?</h3><p>ÂÖ∂Â∫ïÂ±ÇÊòØÁî±AQSÊèê‰æõÊîØÊåÅÔºåÊâÄ‰ª•ÂÖ∂Êï∞ÊçÆÁªìÊûÑÂèØ‰ª•ÂèÇËÄÉAQSÁöÑÊï∞ÊçÆÁªìÊûÑÔºåËÄåAQSÁöÑÊï∞ÊçÆÁªìÊûÑÊ†∏ÂøÉÂ∞±ÊòØ‰∏§‰∏™ËôöÊãüÈòüÂàó: ÂêåÊ≠•ÈòüÂàósync queue ÂíåÊù°‰ª∂ÈòüÂàócondition queueÔºå‰∏çÂêåÁöÑÊù°‰ª∂‰ºöÊúâ‰∏çÂêåÁöÑÊù°‰ª∂ÈòüÂàó„ÄÇCountDownLatchÂÖ∏ÂûãÁöÑÁî®Ê≥ïÊòØÂ∞Ü‰∏Ä‰∏™Á®ãÂ∫èÂàÜ‰∏∫n‰∏™‰∫íÁõ∏Áã¨Á´ãÁöÑÂèØËß£ÂÜ≥‰ªªÂä°ÔºåÂπ∂ÂàõÂª∫ÂÄº‰∏∫nÁöÑCountDownLatch„ÄÇÂΩìÊØè‰∏Ä‰∏™‰ªªÂä°ÂÆåÊàêÊó∂ÔºåÈÉΩ‰ºöÂú®Ëøô‰∏™ÈîÅÂ≠òÂô®‰∏äË∞ÉÁî®countDownÔºåÁ≠âÂæÖÈóÆÈ¢òË¢´Ëß£ÂÜ≥ÁöÑ‰ªªÂä°Ë∞ÉÁî®Ëøô‰∏™ÈîÅÂ≠òÂô®ÁöÑawaitÔºåÂ∞Ü‰ªñ‰ª¨Ëá™Â∑±Êã¶‰ΩèÔºåÁõ¥Ëá≥ÈîÅÂ≠òÂô®ËÆ°Êï∞ÁªìÊùü„ÄÇ</p>
<p><code>CountDownLatch</code> ÊòØÂÖ±‰∫´ÈîÅÁöÑ‰∏ÄÁßçÂÆûÁé∞ÔºåÂÆÉÈªòËÆ§ÊûÑÈÄ† AQS ÁöÑ <code>state</code> ÂÄº‰∏∫ <code>count</code>„ÄÇÂΩìÁ∫øÁ®ã‰ΩøÁî® <code>countDown()</code> ÊñπÊ≥ïÊó∂ÔºåÂÖ∂ÂÆû‰ΩøÁî®‰∫Ü<code>tryReleaseShared</code>ÊñπÊ≥ï‰ª• CAS ÁöÑÊìç‰ΩúÊù•ÂáèÂ∞ë <code>state</code>ÔºåÁõ¥Ëá≥ <code>state</code> ‰∏∫ 0 „ÄÇÂΩìË∞ÉÁî® <code>await()</code> ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûú <code>state</code> ‰∏ç‰∏∫ 0ÔºåÈÇ£Â∞±ËØÅÊòé‰ªªÂä°ËøòÊ≤°ÊúâÊâßË°åÂÆåÊØïÔºå<code>await()</code> ÊñπÊ≥ïÂ∞±‰ºö‰∏ÄÁõ¥ÈòªÂ°ûÔºå‰πüÂ∞±ÊòØËØ¥ <code>await()</code> ÊñπÊ≥ï‰πãÂêéÁöÑËØ≠Âè•‰∏ç‰ºöË¢´ÊâßË°å„ÄÇÁÑ∂ÂêéÔºå<code>CountDownLatch</code> ‰ºöËá™Êóã CAS Âà§Êñ≠ <code>state == 0</code>ÔºåÂ¶ÇÊûú <code>state == 0</code> ÁöÑËØùÔºåÂ∞±‰ºöÈáäÊîæÊâÄÊúâÁ≠âÂæÖÁöÑÁ∫øÁ®ãÔºå<code>await()</code> ÊñπÊ≥ï‰πãÂêéÁöÑËØ≠Âè•ÂæóÂà∞ÊâßË°å„ÄÇ</p>
<h3 id="üåüCountDownLatchÊúâÂì™‰∫õ‰∏ªË¶ÅÊñπÊ≥ï"><a href="#üåüCountDownLatchÊúâÂì™‰∫õ‰∏ªË¶ÅÊñπÊ≥ï" class="headerlink" title="üåüCountDownLatchÊúâÂì™‰∫õ‰∏ªË¶ÅÊñπÊ≥ï?"></a>üåüCountDownLatchÊúâÂì™‰∫õ‰∏ªË¶ÅÊñπÊ≥ï?</h3><p><code>CountDownLatch(int count)</code>ÔºöÊûÑÈÄ†ÊñπÊ≥ïÔºåÂàùÂßãÂåñÂî§ÈÜíÈúÄË¶Å down Âá†Ê≠•</p>
<p><code>await()</code>ÔºöÊ≠§ÂáΩÊï∞Â∞Ü‰ºö‰ΩøÂΩìÂâçÁ∫øÁ®ãÂú®ËÆ°Êï∞Âô®ÂÄíËÆ°Ëá≥Èõ∂‰πãÂâç‰∏ÄÁõ¥Á≠âÂæÖÔºåÈô§ÈùûÁ∫øÁ®ãË¢´‰∏≠Êñ≠„ÄÇ</p>
<p><code>countDown()</code>ÔºöÊ≠§ÂáΩÂ∞ÜËÆ°Êï∞Âô®ËøõË°åÂáè 1ÔºåÂ¶ÇÊûúËÆ°Êï∞Âà∞ËææÈõ∂ÔºåÂàôÈáäÊîæÊâÄÊúâÁ≠âÂæÖÁöÑÁ∫øÁ®ã</p>
<h3 id="üåüÁî®Ëøá-CountDownLatch-‰πàÔºü‰ªÄ‰πàÂú∫ÊôØ‰∏ãÁî®ÁöÑÔºü"><a href="#üåüÁî®Ëøá-CountDownLatch-‰πàÔºü‰ªÄ‰πàÂú∫ÊôØ‰∏ãÁî®ÁöÑÔºü" class="headerlink" title="üåüÁî®Ëøá CountDownLatch ‰πàÔºü‰ªÄ‰πàÂú∫ÊôØ‰∏ãÁî®ÁöÑÔºü"></a>üåüÁî®Ëøá CountDownLatch ‰πàÔºü‰ªÄ‰πàÂú∫ÊôØ‰∏ãÁî®ÁöÑÔºü</h3><p><code>CountDownLatch</code> ÁöÑ‰ΩúÁî®Â∞±ÊòØ ÂÖÅËÆ∏ count ‰∏™Á∫øÁ®ãÈòªÂ°ûÂú®‰∏Ä‰∏™Âú∞ÊñπÔºåÁõ¥Ëá≥ÊâÄÊúâÁ∫øÁ®ãÁöÑ‰ªªÂä°ÈÉΩÊâßË°åÂÆåÊØï„ÄÇ‰πãÂâçÂú®È°πÁõÆ‰∏≠ÔºåÊúâ‰∏Ä‰∏™‰ΩøÁî®Â§öÁ∫øÁ®ãËØªÂèñÂ§ö‰∏™Êñá‰ª∂Â§ÑÁêÜÁöÑÂú∫ÊôØÔºåÊàëÁî®Âà∞‰∫Ü <code>CountDownLatch</code> „ÄÇÂÖ∑‰ΩìÂú∫ÊôØÊòØ‰∏ãÈù¢ËøôÊ†∑ÁöÑÔºö</p>
<p>Êàë‰ª¨Ë¶ÅËØªÂèñÂ§ÑÁêÜ 6 ‰∏™Êñá‰ª∂ÔºåËøô 6 ‰∏™‰ªªÂä°ÈÉΩÊòØÊ≤°ÊúâÊâßË°åÈ°∫Â∫è‰æùËµñÁöÑ‰ªªÂä°Ôºå‰ΩÜÊòØÊàë‰ª¨ÈúÄË¶ÅËøîÂõûÁªôÁî®Êà∑ÁöÑÊó∂ÂÄôÂ∞ÜËøôÂá†‰∏™Êñá‰ª∂ÁöÑÂ§ÑÁêÜÁöÑÁªìÊûúËøõË°åÁªüËÆ°Êï¥ÁêÜ„ÄÇ</p>
<p>‰∏∫Ê≠§Êàë‰ª¨ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÊ±†Âíå count ‰∏∫ 6 ÁöÑ<code>CountDownLatch</code>ÂØπË±° „ÄÇ‰ΩøÁî®Á∫øÁ®ãÊ±†Â§ÑÁêÜËØªÂèñ‰ªªÂä°ÔºåÊØè‰∏Ä‰∏™Á∫øÁ®ãÂ§ÑÁêÜÂÆå‰πãÂêéÂ∞±Â∞Ü count-1ÔºåË∞ÉÁî®<code>CountDownLatch</code>ÂØπË±°ÁöÑ <code>await()</code>ÊñπÊ≥ïÔºåÁõ¥Âà∞ÊâÄÊúâÊñá‰ª∂ËØªÂèñÂÆå‰πãÂêéÔºåÊâç‰ºöÊé•ÁùÄÊâßË°åÂêéÈù¢ÁöÑÈÄªËæë„ÄÇ</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountDownLatchExample1</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Â§ÑÁêÜÊñá‰ª∂ÁöÑÊï∞Èáè</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> threadCount <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ÂàõÂª∫‰∏Ä‰∏™ÂÖ∑ÊúâÂõ∫ÂÆöÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†ÂØπË±°ÔºàÊé®Ëçê‰ΩøÁî®ÊûÑÈÄ†ÊñπÊ≥ïÂàõÂª∫Ôºâ</span>
        ExecutorService threadPool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> CountDownLatch countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span>threadCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threadCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token keyword">int</span> threadnum <span class="token operator">=</span> i<span class="token punctuation">;</span>
            threadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">//Â§ÑÁêÜÊñá‰ª∂ÁöÑ‰∏öÂä°Êìç‰Ωú</span>
                    <span class="token comment" spellcheck="true">//......</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">//Ë°®Á§∫‰∏Ä‰∏™Êñá‰ª∂Â∑≤ÁªèË¢´ÂÆåÊàê</span>
                    countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        threadPool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"finish"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>ÊúâÊ≤°ÊúâÂèØ‰ª•ÊîπËøõÁöÑÂú∞ÊñπÂë¢Ôºü</strong></p>
<p>ÂèØ‰ª•‰ΩøÁî® <code>CompletableFuture</code> Á±ªÊù•ÊîπËøõÔºÅJava8 ÁöÑ <code>CompletableFuture</code> Êèê‰æõ‰∫ÜÂæàÂ§öÂØπÂ§öÁ∫øÁ®ãÂèãÂ•ΩÁöÑÊñπÊ≥ïÔºå‰ΩøÁî®ÂÆÉÂèØ‰ª•ÂæàÊñπ‰æøÂú∞‰∏∫Êàë‰ª¨ÁºñÂÜôÂ§öÁ∫øÁ®ãÁ®ãÂ∫èÔºå‰ªÄ‰πàÂºÇÊ≠•„ÄÅ‰∏≤Ë°å„ÄÅÂπ∂Ë°åÊàñËÄÖÁ≠âÂæÖÊâÄÊúâÁ∫øÁ®ãÊâßË°åÂÆå‰ªªÂä°‰ªÄ‰πàÁöÑÈÉΩÈùûÂ∏∏Êñπ‰æø„ÄÇ</p>
<h3 id="üåüÊúâÂõõ‰∏™Á∫øÁ®ãA„ÄÅB„ÄÅC„ÄÅD„ÄÅEÔºåÁé∞Âú®ÈúÄË¶Å-EÁ∫øÁ®ãÂú®-ABCDÂõõ‰∏™Á∫øÁ®ãÁªìÊùü‰πãÂêéÂÜçÊâßË°å"><a href="#üåüÊúâÂõõ‰∏™Á∫øÁ®ãA„ÄÅB„ÄÅC„ÄÅD„ÄÅEÔºåÁé∞Âú®ÈúÄË¶Å-EÁ∫øÁ®ãÂú®-ABCDÂõõ‰∏™Á∫øÁ®ãÁªìÊùü‰πãÂêéÂÜçÊâßË°å" class="headerlink" title="üåüÊúâÂõõ‰∏™Á∫øÁ®ãA„ÄÅB„ÄÅC„ÄÅD„ÄÅEÔºåÁé∞Âú®ÈúÄË¶Å EÁ∫øÁ®ãÂú® ABCDÂõõ‰∏™Á∫øÁ®ãÁªìÊùü‰πãÂêéÂÜçÊâßË°å"></a>üåüÊúâÂõõ‰∏™Á∫øÁ®ãA„ÄÅB„ÄÅC„ÄÅD„ÄÅEÔºåÁé∞Âú®ÈúÄË¶Å EÁ∫øÁ®ãÂú® ABCDÂõõ‰∏™Á∫øÁ®ãÁªìÊùü‰πãÂêéÂÜçÊâßË°å</h3><ol>
<li><p>join ËÆ©‰∏ªÁ∫øÁ®ãÁ≠âÂæÖÂ≠êÁ∫øÁ®ãËøêË°åÁªìÊùüÂêéÂÜçÁªßÁª≠ËøêË°åÔºöjoinÊñπÊ≥ï‰∏≠Â¶ÇÊûú‰º†ÂÖ•ÂèÇÊï∞ÔºåÂàôË°®Á§∫ËøôÊ†∑ÁöÑÊÑèÊÄùÔºöÂ¶ÇÊûúÁ∫øÁ®ãA ‰∏≠ÊéâÁî®Á∫øÁ®ãBÁöÑ join(10)ÔºåÂàôË°®Á§∫Á∫øÁ®ãA ‰ºöÁ≠âÂæÖÁ∫øÁ®ãB ÊâßË°å10ÊØ´ÁßíÔºå10ÊØ´ÁßíËøáÂêéÔºåA„ÄÅBÁ∫øÁ®ãÂπ∂Ë°åÊâßË°å„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåjdkËßÑÂÆöÔºåjoin(0)ÁöÑÊÑèÊÄù‰∏çÊòØ Á∫øÁ®ãAÁ≠âÂæÖÁ∫øÁ®ãB 0ÁßíÔºåËÄåÊòØÁ∫øÁ®ãA Á≠âÂæÖÁ∫øÁ®ãB Êó†ÈôêÊó∂Èó¥ÔºåÁõ¥Âà∞Á∫øÁ®ãB ÊâßË°åÂÆåÊØïÔºåÂç≥join(0)Á≠â‰ª∑‰∫éjoin()„ÄÇ(ÂÖ∂ÂÆûjoin()‰∏≠Ë∞ÉÁî®ÁöÑÊòØjoin(0))</p>
</li>
<li><p>Âà©Áî®Âπ∂ÂèëÂåÖÈáåÁöÑ ExcutorsÁöÑ newSingleThreadExecutor‰∫ßÁîü‰∏Ä‰∏™ÂçïÁ∫øÁ®ãÁöÑÁ∫øÁ®ãÊ±†ÔºåËÄåËøô‰∏™Á∫øÁ®ãÊ±†ÁöÑÂ∫ïÂ±ÇÂéüÁêÜÂ∞±ÊòØ‰∏Ä‰∏™ÂÖàËøõÂÖàÂá∫ÔºàFIFOÔºâÁöÑÈòüÂàó„ÄÇ‰ª£Á†Å‰∏≠ executor.submit‰æùÊ¨°Ê∑ªÂä†‰∫Ü123Á∫øÁ®ãÔºåÊåâÁÖß FIFOÁöÑÁâπÊÄßÔºåÊâßË°åÈ°∫Â∫è‰πüÂ∞±ÊòØ123ÁöÑÊâßË°åÁªìÊûúÔºå‰ªéËÄå‰øùËØÅ‰∫ÜÊâßË°åÈ°∫Â∫è„ÄÇ</p>
</li>
<li><p>‰ΩøÁî® CountDownLatch ÊéßÂà∂Â§ö‰∏™Á∫øÁ®ãÊâßË°åÈ°∫Â∫è cutDown()ÊñπÊ≥ïÂíå await()ÊñπÊ≥ïÔºöÂèØ‰ª•ÈÄöËøáË∞ÉÁî®CounDownLatchÂØπË±°ÁöÑcutDown()ÊñπÊ≥ïÔºåÊù•‰ΩøËÆ°Êï∞Âáè1ÔºõÂ¶ÇÊûúË∞ÉÁî®ÂØπË±°‰∏äÁöÑawait()ÊñπÊ≥ïÔºåÈÇ£‰πàË∞ÉÁî®ËÄÖÂ∞±‰ºö‰∏ÄÁõ¥ÈòªÂ°ûÂú®ËøôÈáåÔºåÁõ¥Âà∞Âà´‰∫∫ÈÄöËøácutDownÊñπÊ≥ïÔºåÂ∞ÜËÆ°Êï∞ÂáèÂà∞0ÔºåÊâçÂèØ‰ª•ÁªßÁª≠ÊâßË°å„ÄÇ</p>
</li>
</ol>
<h3 id="üåüCountDownLatch‰ª£Á†ÅÈ¢ò"><a href="#üåüCountDownLatch‰ª£Á†ÅÈ¢ò" class="headerlink" title="üåüCountDownLatch‰ª£Á†ÅÈ¢ò"></a>üåüCountDownLatch‰ª£Á†ÅÈ¢ò</h3><blockquote>
<p>ÂÆûÁé∞‰∏Ä‰∏™ÂÆπÂô®ÔºåÊèê‰æõ‰∏§‰∏™ÊñπÊ≥ïÔºåaddÔºåsize ÔºõÂÜô‰∏§‰∏™Á∫øÁ®ãÔºåÁ∫øÁ®ã1Ê∑ªÂä†10‰∏™ÂÖÉÁ¥†Âà∞ÂÆπÂô®‰∏≠ÔºåÁ∫øÁ®ã2ÂÆûÁé∞ÁõëÊéßÂÖÉÁ¥†ÁöÑ‰∏™Êï∞ÔºåÂΩì‰∏™Êï∞Âà∞5‰∏™Êó∂ÔºåÁ∫øÁ®ã2ÁªôÂá∫ÊèêÁ§∫Âπ∂ÁªìÊùü.</p>
</blockquote>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CountDownLatch<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * ‰ΩøÁî®CountDownLatch ‰ª£Êõøwait notify Â•ΩÂ§ÑÊòØÈÄöËÆØÊñπÂºèÁÆÄÂçïÔºå‰∏çÊ∂âÂèäÈîÅÂÆö  Count ÂÄº‰∏∫0Êó∂ÂΩìÂâçÁ∫øÁ®ãÁªßÁª≠ÊâßË°åÔºå
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>

   <span class="token keyword">volatile</span> List list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Demo t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        CountDownLatch countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t2 start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
               <span class="token keyword">try</span> <span class="token punctuation">{</span>
                   countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t2 end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"t2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t1 start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
               t<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
               System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                   System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"countdown is open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t1 end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="‚ù∑CyclicBarrier"><a href="#‚ù∑CyclicBarrier" class="headerlink" title="‚ù∑CyclicBarrier"></a>‚ù∑CyclicBarrier</h2><h3 id="üåüCyclicBarrier-Êúâ‰ªÄ‰πàÁî®Ôºü"><a href="#üåüCyclicBarrier-Êúâ‰ªÄ‰πàÁî®Ôºü" class="headerlink" title="üåüCyclicBarrier Êúâ‰ªÄ‰πàÁî®Ôºü"></a>üåüCyclicBarrier Êúâ‰ªÄ‰πàÁî®Ôºü</h3><blockquote>
<p><code>CountDownLatch</code> ÁöÑÂÆûÁé∞ÊòØÂü∫‰∫é AQS ÁöÑÔºåËÄå <code>CycliBarrier</code> ÊòØÂü∫‰∫é <code>ReentrantLock</code>(<code>ReentrantLock</code> ‰πüÂ±û‰∫é AQS ÂêåÊ≠•Âô®)Âíå <code>Condition</code> ÁöÑ„ÄÇ</p>
</blockquote>
<p><code>CyclicBarrier</code>ÔºöÂæ™ÁéØÂ±èÈöúÔºåÁî®Êù•ËøõË°åÁ∫øÁ®ãÂçè‰ΩúÔºåÁ≠âÂæÖÁ∫øÁ®ãÊª°Ë∂≥Êüê‰∏™ËÆ°Êï∞ÔºåÊâçËÉΩËß¶ÂèëËá™Â∑±ÊâßË°å</p>
<ul>
<li>ÂØπ‰∫é<code>CountDownLatch</code>ÔºåÂÖ∂‰ªñÁ∫øÁ®ã‰∏∫Ê∏∏ÊàèÁé©ÂÆ∂ÔºåÊØîÂ¶ÇËã±ÈõÑËÅîÁõüÔºå‰∏ªÁ∫øÁ®ã‰∏∫ÊéßÂà∂Ê∏∏ÊàèÂºÄÂßãÁöÑÁ∫øÁ®ã„ÄÇÂú®ÊâÄÊúâÁöÑÁé©ÂÆ∂ÈÉΩÂáÜÂ§áÂ•Ω‰πãÂâçÔºå‰∏ªÁ∫øÁ®ãÊòØÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÁöÑÔºå‰πüÂ∞±ÊòØÊ∏∏Êàè‰∏çËÉΩÂºÄÂßã„ÄÇÂΩìÊâÄÊúâÁöÑÁé©ÂÆ∂ÂáÜÂ§áÂ•Ω‰πãÂêéÔºå‰∏ã‰∏ÄÊ≠•ÁöÑÂä®‰ΩúÂÆûÊñΩËÄÖ‰∏∫‰∏ªÁ∫øÁ®ãÔºåÂç≥ÂºÄÂßãÊ∏∏Êàè„ÄÇ</li>
<li>ÂØπ‰∫é<code>CyclicBarrier</code>ÔºåÂÅáËÆæÊúâ‰∏ÄÂÆ∂ÂÖ¨Âè∏Ë¶ÅÂÖ®‰ΩìÂëòÂ∑•ËøõË°åÂõ¢Âª∫Ê¥ªÂä®ÔºåÊ¥ªÂä®ÂÜÖÂÆπ‰∏∫ÁøªË∂ä‰∏â‰∏™ÈöúÁ¢çÁâ©ÔºåÊØè‰∏Ä‰∏™‰∫∫ÁøªË∂äÈöúÁ¢çÁâ©ÊâÄÁî®ÁöÑÊó∂Èó¥ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇ‰ΩÜÊòØÂÖ¨Âè∏Ë¶ÅÊ±ÇÊâÄÊúâ‰∫∫Âú®ÁøªË∂äÂΩìÂâçÈöúÁ¢çÁâ©‰πãÂêéÂÜçÂºÄÂßãÁøªË∂ä‰∏ã‰∏Ä‰∏™ÈöúÁ¢çÁâ©Ôºå‰πüÂ∞±ÊòØÊâÄÊúâ‰∫∫ÁøªË∂äÁ¨¨‰∏Ä‰∏™ÈöúÁ¢çÁâ©‰πãÂêéÔºåÊâçÂºÄÂßãÁøªË∂äÁ¨¨‰∫å‰∏™Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇÁ±ªÊØîÂú∞ÔºåÊØè‰∏Ä‰∏™ÂëòÂ∑•ÈÉΩÊòØ‰∏Ä‰∏™‚ÄúÂÖ∂‰ªñÁ∫øÁ®ã‚Äù„ÄÇÂΩìÊâÄÊúâ‰∫∫ÈÉΩÁøªË∂äÁöÑÊâÄÊúâÁöÑÈöúÁ¢çÁâ©‰πãÂêéÔºåÁ®ãÂ∫èÊâçÁªìÊùü„ÄÇËÄå‰∏ªÁ∫øÁ®ãÂèØËÉΩÊó©Â∞±ÁªìÊùü‰∫ÜÔºåËøôÈáåÊàë‰ª¨‰∏çÁî®ÁÆ°‰∏ªÁ∫øÁ®ã„ÄÇ</li>
</ul>
<h3 id="üåüCyclicBarrier-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"><a href="#üåüCyclicBarrier-ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü" class="headerlink" title="üåüCyclicBarrier ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü"></a>üåüCyclicBarrier ÁöÑÂéüÁêÜÊòØ‰ªÄ‰πàÔºü</h3><p><code>CyclicBarrier</code> ÂÜÖÈÉ®ÈÄöËøá‰∏Ä‰∏™ <code>count</code> ÂèòÈáè‰Ωú‰∏∫ËÆ°Êï∞Âô®Ôºå<code>count</code> ÁöÑÂàùÂßãÂÄº‰∏∫ <code>parties</code> Â±ûÊÄßÁöÑÂàùÂßãÂåñÂÄºÔºåÊØèÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂà∞‰∫ÜÊ†ÖÊ†èËøôÈáå‰∫ÜÔºåÈÇ£‰πàÂ∞±Â∞ÜËÆ°Êï∞Âô®Âáè 1„ÄÇÂ¶ÇÊûú count ÂÄº‰∏∫ 0 ‰∫ÜÔºåË°®Á§∫ËøôÊòØËøô‰∏Ä‰ª£ÊúÄÂêé‰∏Ä‰∏™Á∫øÁ®ãÂà∞ËææÊ†ÖÊ†èÔºåÂ∞±Â∞ùËØïÊâßË°åÊàë‰ª¨ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ËæìÂÖ•ÁöÑ‰ªªÂä°„ÄÇ</p>
<h3 id="üåüCountDownLatch-Âíå-CyclicBarrier-Êúâ‰ªÄ‰πàÂå∫Âà´Ôºü"><a href="#üåüCountDownLatch-Âíå-CyclicBarrier-Êúâ‰ªÄ‰πàÂå∫Âà´Ôºü" class="headerlink" title="üåüCountDownLatch Âíå CyclicBarrier Êúâ‰ªÄ‰πàÂå∫Âà´Ôºü"></a>üåüCountDownLatch Âíå CyclicBarrier Êúâ‰ªÄ‰πàÂå∫Âà´Ôºü</h3><p>CountDownLatch ÊòØËÆ°Êï∞Âô®ÔºåÂè™ËÉΩ‰ΩøÁî®‰∏ÄÊ¨°ÔºåËÄå CyclicBarrier ÁöÑËÆ°Êï∞Âô®Êèê‰æõ reset ÂäüËÉΩÔºåÂèØ‰ª•Â§öÊ¨°‰ΩøÁî®„ÄÇ</p>
<p>ÂØπ‰∫é CountDownLatch Êù•ËØ¥ÔºåÈáçÁÇπÊòØ‚Äú‰∏Ä‰∏™Á∫øÁ®ãÔºàÂ§ö‰∏™Á∫øÁ®ãÔºâÁ≠âÂæÖ‚ÄùÔºåËÄåÂÖ∂‰ªñÁöÑ N ‰∏™Á∫øÁ®ãÂú®ÂÆåÊàê‚ÄúÊüê‰ª∂‰∫ãÊÉÖ‚Äù‰πãÂêéÔºåÂèØ‰ª•ÁªàÊ≠¢Ôºå‰πüÂèØ‰ª•Á≠âÂæÖ„ÄÇËÄåÂØπ‰∫é CyclicBarrierÔºåÈáçÁÇπÊòØÂ§ö‰∏™Á∫øÁ®ãÔºåÂú®‰ªªÊÑè‰∏Ä‰∏™Á∫øÁ®ãÊ≤°ÊúâÂÆåÊàêÔºåÊâÄÊúâÁöÑÁ∫øÁ®ãÈÉΩÂøÖÈ°ªÁ≠âÂæÖ„ÄÇ</p>
<p>CountDownLatch ÊòØËÆ°Êï∞Âô®ÔºåÁ∫øÁ®ãÂÆåÊàê‰∏Ä‰∏™ËÆ∞ÂΩï‰∏Ä‰∏™ÔºåÂè™‰∏çËøáËÆ°Êï∞‰∏çÊòØÈÄíÂ¢ûËÄåÊòØÈÄíÂáèÔºåËÄå CyclicBarrier Êõ¥ÂÉèÊòØ‰∏Ä‰∏™ÈòÄÈó®ÔºåÈúÄË¶ÅÊâÄÊúâÁ∫øÁ®ãÈÉΩÂà∞ËææÔºåÈòÄÈó®ÊâçËÉΩÊâìÂºÄÔºåÁÑ∂ÂêéÁªßÁª≠ÊâßË°å„ÄÇ</p>
<p><strong>CountDownLatch Â∫îÁî®Âú∫ÊôØÔºö</strong></p>
<p>1„ÄÅÊüê‰∏ÄÁ∫øÁ®ãÂú®ÂºÄÂßãËøêË°åÂâçÁ≠âÂæÖ n ‰∏™Á∫øÁ®ãÊâßË°åÂÆåÊØïÔºöÂêØÂä®‰∏Ä‰∏™ÊúçÂä°Êó∂Ôºå‰∏ªÁ∫øÁ®ãÈúÄË¶ÅÁ≠âÂæÖÂ§ö‰∏™ÁªÑ‰ª∂Âä†ËΩΩÂÆåÊØïÔºå‰πãÂêéÂÜçÁªßÁª≠ÊâßË°å„ÄÇ</p>
<p>2„ÄÅÂÆûÁé∞Â§ö‰∏™Á∫øÁ®ãÂºÄÂßãÊâßË°å‰ªªÂä°ÁöÑÊúÄÂ§ßÂπ∂Ë°åÊÄß„ÄÇÊ≥®ÊÑèÊòØÂπ∂Ë°åÊÄßÔºå‰∏çÊòØÂπ∂ÂèëÔºåÂº∫Ë∞ÉÁöÑÊòØÂ§ö‰∏™Á∫øÁ®ãÂú®Êüê‰∏ÄÊó∂ÂàªÂêåÊó∂ÂºÄÂßãÊâßË°å„ÄÇÁ±ª‰ºº‰∫éËµõË∑ëÔºåÂ∞ÜÂ§ö‰∏™Á∫øÁ®ãÊîæÂà∞Ëµ∑ÁÇπÔºåÁ≠âÂæÖÂèë‰ª§Êû™ÂìçÔºåÁÑ∂ÂêéÂêåÊó∂ÂºÄË∑ë„ÄÇ</p>
<p>3„ÄÅÊ≠ªÈîÅÊ£ÄÊµãÔºö‰∏Ä‰∏™ÈùûÂ∏∏Êñπ‰æøÁöÑ‰ΩøÁî®Âú∫ÊôØÊòØÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî® n ‰∏™Á∫øÁ®ãËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÔºåÂú®ÊØèÊ¨°ÊµãËØïÈò∂ÊÆµÁöÑÁ∫øÁ®ãÊï∞ÁõÆÊòØ‰∏çÂêåÁöÑÔºåÂπ∂Â∞ùËØï‰∫ßÁîüÊ≠ªÈîÅ„ÄÇ</p>
<p><strong>CyclicBarrier Â∫îÁî®Âú∫ÊôØÔºö</strong></p>
<p>CyclicBarrier ÂèØ‰ª•Áî®‰∫éÂ§öÁ∫øÁ®ãËÆ°ÁÆóÊï∞ÊçÆÔºåÊúÄÂêéÂêàÂπ∂ËÆ°ÁÆóÁªìÊûúÁöÑÂ∫îÁî®Âú∫ÊôØ„ÄÇÊØîÂ¶ÇÔºöÊàë‰ª¨Áî®‰∏Ä‰∏™ Excel ‰øùÂ≠ò‰∫ÜÁî®Êà∑ÊâÄÊúâÈì∂Ë°åÊµÅÊ∞¥ÔºåÊØè‰∏™ Sheet ‰øùÂ≠ò‰∏Ä‰∏™Â∏êÊà∑Ëøë‰∏ÄÂπ¥ÁöÑÊØèÁ¨îÈì∂Ë°åÊµÅÊ∞¥ÔºåÁé∞Âú®ÈúÄË¶ÅÁªüËÆ°Áî®Êà∑ÁöÑÊó•ÂùáÈì∂Ë°åÊµÅÊ∞¥ÔºåÂÖàÁî®Â§öÁ∫øÁ®ãÂ§ÑÁêÜÊØè‰∏™ sheet ÈáåÁöÑÈì∂Ë°åÊµÅÊ∞¥ÔºåÈÉΩÊâßË°åÂÆå‰πãÂêéÔºåÂæóÂà∞ÊØè‰∏™ sheet ÁöÑÊó•ÂùáÈì∂Ë°åÊµÅÊ∞¥ÔºåÊúÄÂêéÔºåÂÜçÁî® barrierAction Áî®Ëøô‰∫õÁ∫øÁ®ãÁöÑËÆ°ÁÆóÁªìÊûúÔºåËÆ°ÁÆóÂá∫Êï¥‰∏™ Excel ÁöÑÊó•ÂùáÈì∂Ë°åÊµÅÊ∞¥„ÄÇ</p>
<h2 id="‚ù∏Exchanger"><a href="#‚ù∏Exchanger" class="headerlink" title="‚ù∏Exchanger"></a>‚ù∏Exchanger</h2><h3 id="üåüExchanger‰∏ªË¶ÅËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢ò"><a href="#üåüExchanger‰∏ªË¶ÅËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢ò" class="headerlink" title="üåüExchanger‰∏ªË¶ÅËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢ò?"></a>üåüExchanger‰∏ªË¶ÅËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢ò?</h3><p>ExchangerÁî®‰∫éËøõË°å‰∏§‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÊï∞ÊçÆ‰∫§Êç¢„ÄÇÂÆÉÊèê‰æõ‰∏Ä‰∏™ÂêåÊ≠•ÁÇπÔºåÂú®Ëøô‰∏™ÂêåÊ≠•ÁÇπÔºå‰∏§‰∏™Á∫øÁ®ãÂèØ‰ª•‰∫§Êç¢ÂΩºÊ≠§ÁöÑÊï∞ÊçÆ„ÄÇËøô‰∏§‰∏™Á∫øÁ®ãÈÄöËøáexchange()ÊñπÊ≥ï‰∫§Êç¢Êï∞ÊçÆÔºåÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂÖàÊâßË°åexchange()ÊñπÊ≥ïÂêéÔºåÂÆÉ‰ºö‰∏ÄÁõ¥Á≠âÂæÖÁ¨¨‰∫å‰∏™Á∫øÁ®ã‰πüÊâßË°åexchange()ÊñπÊ≥ïÔºåÂΩìËøô‰∏§‰∏™Á∫øÁ®ãÂà∞ËææÂêåÊ≠•ÁÇπÊó∂ÔºåËøô‰∏§‰∏™Á∫øÁ®ãÂ∞±ÂèØ‰ª•‰∫§Êç¢Êï∞ÊçÆ‰∫Ü„ÄÇ</p>
<h3 id="üåüÂØπÊØîSynchronousQueueÔºå‰∏∫‰ªÄ‰πàËØ¥ExchangerÂèØË¢´ËßÜ‰∏∫-SynchronousQueue-ÁöÑÂèåÂêëÂΩ¢Âºè"><a href="#üåüÂØπÊØîSynchronousQueueÔºå‰∏∫‰ªÄ‰πàËØ¥ExchangerÂèØË¢´ËßÜ‰∏∫-SynchronousQueue-ÁöÑÂèåÂêëÂΩ¢Âºè" class="headerlink" title="üåüÂØπÊØîSynchronousQueueÔºå‰∏∫‰ªÄ‰πàËØ¥ExchangerÂèØË¢´ËßÜ‰∏∫ SynchronousQueue ÁöÑÂèåÂêëÂΩ¢Âºè?"></a>üåüÂØπÊØîSynchronousQueueÔºå‰∏∫‰ªÄ‰πàËØ¥ExchangerÂèØË¢´ËßÜ‰∏∫ SynchronousQueue ÁöÑÂèåÂêëÂΩ¢Âºè?</h3><p>ExchangerÊòØ‰∏ÄÁßçÁ∫øÁ®ãÈó¥ÂÆâÂÖ®‰∫§Êç¢Êï∞ÊçÆÁöÑÊú∫Âà∂„ÄÇÂèØ‰ª•Âíå‰πãÂâçÂàÜÊûêËøáÁöÑSynchronousQueueÂØπÊØî‰∏Ä‰∏ãÔºöÁ∫øÁ®ãAÈÄöËøáSynchronousQueueÂ∞ÜÊï∞ÊçÆa‰∫§ÁªôÁ∫øÁ®ãBÔºõÁ∫øÁ®ãAÈÄöËøáExchangerÂíåÁ∫øÁ®ãB‰∫§Êç¢Êï∞ÊçÆÔºåÁ∫øÁ®ãAÊääÊï∞ÊçÆa‰∫§ÁªôÁ∫øÁ®ãBÔºåÂêåÊó∂Á∫øÁ®ãBÊääÊï∞ÊçÆb‰∫§ÁªôÁ∫øÁ®ãA„ÄÇÂèØËßÅÔºåSynchronousQueueÊòØ‰∫§Áªô‰∏Ä‰∏™Êï∞ÊçÆÔºåExchangerÊòØ‰∫§Êç¢‰∏§‰∏™Êï∞ÊçÆ„ÄÇ</p>
<h3 id="üåüExchangerÂú®‰∏çÂêåÁöÑJDKÁâàÊú¨‰∏≠ÂÆûÁé∞Êúâ‰ªÄ‰πàÂ∑ÆÂà´"><a href="#üåüExchangerÂú®‰∏çÂêåÁöÑJDKÁâàÊú¨‰∏≠ÂÆûÁé∞Êúâ‰ªÄ‰πàÂ∑ÆÂà´" class="headerlink" title="üåüExchangerÂú®‰∏çÂêåÁöÑJDKÁâàÊú¨‰∏≠ÂÆûÁé∞Êúâ‰ªÄ‰πàÂ∑ÆÂà´?"></a>üåüExchangerÂú®‰∏çÂêåÁöÑJDKÁâàÊú¨‰∏≠ÂÆûÁé∞Êúâ‰ªÄ‰πàÂ∑ÆÂà´?</h3><ul>
<li>Âú®JDK5‰∏≠ExchangerË¢´ËÆæËÆ°Êàê‰∏Ä‰∏™ÂÆπÈáè‰∏∫1ÁöÑÂÆπÂô®ÔºåÂ≠òÊîæ‰∏Ä‰∏™Á≠âÂæÖÁ∫øÁ®ãÔºåÁõ¥Âà∞ÊúâÂè¶Â§ñÁ∫øÁ®ãÂà∞Êù•Â∞±‰ºöÂèëÁîüÊï∞ÊçÆ‰∫§Êç¢ÔºåÁÑ∂ÂêéÊ∏ÖÁ©∫ÂÆπÂô®ÔºåÁ≠âÂà∞‰∏ã‰∏Ä‰∏™Âà∞Êù•ÁöÑÁ∫øÁ®ã„ÄÇ</li>
<li>‰ªéJDK6ÂºÄÂßãÔºåExchangerÁî®‰∫ÜÁ±ª‰ººConcurrentMapÁöÑÂàÜÊÆµÊÄùÊÉ≥ÔºåÊèê‰æõ‰∫ÜÂ§ö‰∏™slotÔºåÂ¢ûÂä†‰∫ÜÂπ∂ÂèëÊâßË°åÊó∂ÁöÑÂêûÂêêÈáè„ÄÇ</li>
</ul>
<h1 id="‚ë¶Âπ∂ÂèëÂÆπÂô®"><a href="#‚ë¶Âπ∂ÂèëÂÆπÂô®" class="headerlink" title="‚ë¶Âπ∂ÂèëÂÆπÂô®"></a>‚ë¶Âπ∂ÂèëÂÆπÂô®</h1><p>JDK Êèê‰æõÁöÑËøô‰∫õÂÆπÂô®Â§ßÈÉ®ÂàÜÂú® <code>java.util.concurrent</code> ÂåÖ‰∏≠„ÄÇ</p>
<ul>
<li><strong><code>ConcurrentHashMap</code></strong> : Á∫øÁ®ãÂÆâÂÖ®ÁöÑ <code>HashMap</code></li>
<li><strong><code>CopyOnWriteArrayList</code></strong> : Á∫øÁ®ãÂÆâÂÖ®ÁöÑ <code>List</code>ÔºåÂú®ËØªÂ§öÂÜôÂ∞ëÁöÑÂú∫ÂêàÊÄßËÉΩÈùûÂ∏∏Â•ΩÔºåËøúËøúÂ•Ω‰∫é <code>Vector</code>„ÄÇ</li>
<li><strong><code>ConcurrentLinkedQueue</code></strong> : È´òÊïàÁöÑÂπ∂ÂèëÈòüÂàóÔºå‰ΩøÁî®ÈìæË°®ÂÆûÁé∞„ÄÇÂèØ‰ª•ÁúãÂÅö‰∏Ä‰∏™Á∫øÁ®ãÂÆâÂÖ®ÁöÑ <code>LinkedList</code>ÔºåËøôÊòØ‰∏Ä‰∏™ÈùûÈòªÂ°ûÈòüÂàó„ÄÇ</li>
<li><strong><code>BlockingQueue</code></strong> : ËøôÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåJDK ÂÜÖÈÉ®ÈÄöËøáÈìæË°®„ÄÅÊï∞ÁªÑÁ≠âÊñπÂºèÂÆûÁé∞‰∫ÜËøô‰∏™Êé•Âè£„ÄÇË°®Á§∫ÈòªÂ°ûÈòüÂàóÔºåÈùûÂ∏∏ÈÄÇÂêàÁî®‰∫é‰Ωú‰∏∫Êï∞ÊçÆÂÖ±‰∫´ÁöÑÈÄöÈÅì„ÄÇ</li>
<li><strong><code>ConcurrentSkipListMap</code></strong> : Ë∑≥Ë°®ÁöÑÂÆûÁé∞„ÄÇËøôÊòØ‰∏Ä‰∏™ MapÔºå‰ΩøÁî®Ë∑≥Ë°®ÁöÑÊï∞ÊçÆÁªìÊûÑËøõË°åÂø´ÈÄüÊü•Êâæ„ÄÇ</li>
</ul>
<h2 id="‚ù∂ConcurrentHashMap"><a href="#‚ù∂ConcurrentHashMap" class="headerlink" title="‚ù∂ConcurrentHashMap"></a>‚ù∂ConcurrentHashMap</h2><h3 id="üåü‰ªÄ‰πàÊòØConcurrentHashMapÔºüÁõ∏ÊØî‰∫éHashMapÂíåHashTableÊúâ‰ªÄ‰πà‰ºòÂäøÔºü"><a href="#üåü‰ªÄ‰πàÊòØConcurrentHashMapÔºüÁõ∏ÊØî‰∫éHashMapÂíåHashTableÊúâ‰ªÄ‰πà‰ºòÂäøÔºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØConcurrentHashMapÔºüÁõ∏ÊØî‰∫éHashMapÂíåHashTableÊúâ‰ªÄ‰πà‰ºòÂäøÔºü"></a>üåü‰ªÄ‰πàÊòØConcurrentHashMapÔºüÁõ∏ÊØî‰∫éHashMapÂíåHashTableÊúâ‰ªÄ‰πà‰ºòÂäøÔºü</h3><blockquote>
<p>Âú®Âπ∂ÂèëÂú∫ÊôØ‰∏ãÂ¶ÇÊûúË¶Å‰øùËØÅ‰∏ÄÁßçÂèØË°åÁöÑÊñπÂºèÊòØ‰ΩøÁî® <code>Collections.synchronizedMap()</code> ÊñπÊ≥ïÊù•ÂåÖË£ÖÊàë‰ª¨ÁöÑ <code>HashMap</code>„ÄÇ‰ΩÜËøôÊòØÈÄöËøá‰ΩøÁî®‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÈîÅÊù•ÂêåÊ≠•‰∏çÂêåÁ∫øÁ®ãÈó¥ÁöÑÂπ∂ÂèëËÆøÈóÆÔºåÂõ†Ê≠§‰ºöÂ∏¶Êù•‰∏çÂèØÂøΩËßÜÁöÑÊÄßËÉΩÈóÆÈ¢ò„ÄÇ</p>
</blockquote>
<p><code>CocurrentHashMap</code>ÂèØ‰ª•Áúã‰Ωú<strong>Á∫øÁ®ãÂÆâÂÖ®‰∏îÈ´òÊïà</strong>ÁöÑ<code>HashMap</code>ÔºåÁõ∏ÊØî‰∫é<code>HashMap</code>ÂÖ∑ÊúâÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ‰ºòÂäøÔºåÁõ∏ÊØî‰∫é<code>HashTable</code>ÂÖ∑ÊúâÊïàÁéáÈ´òÁöÑ‰ºòÂäø„ÄÇ</p>
<p>Âú® <code>ConcurrentHashMap</code> ‰∏≠ÔºåÊó†ËÆ∫ÊòØËØªÊìç‰ΩúËøòÊòØÂÜôÊìç‰ΩúÈÉΩËÉΩ‰øùËØÅÂæàÈ´òÁöÑÊÄßËÉΩÔºöÂú®ËøõË°åËØªÊìç‰ΩúÊó∂(Âá†‰πé)‰∏çÈúÄË¶ÅÂä†ÈîÅÔºåËÄåÂú®ÂÜôÊìç‰ΩúÊó∂ÈÄöËøáÈîÅÂàÜÊÆµÊäÄÊúØÂè™ÂØπÊâÄÊìç‰ΩúÁöÑÊÆµÂä†ÈîÅËÄå‰∏çÂΩ±ÂìçÂÆ¢Êà∑Á´ØÂØπÂÖ∂ÂÆÉÊÆµÁöÑËÆøÈóÆ„ÄÇ</p>
<h3 id="üåüConcurrentHashMapÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü"><a href="#üåüConcurrentHashMapÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü" class="headerlink" title="üåüConcurrentHashMapÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü"></a>üåüConcurrentHashMapÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü</h3><p><strong>JDK1.7</strong></p>
<p>Âú®JDK1.7ÁâàÊú¨‰∏≠Ôºå<code>ConcurrentHashMap</code>ÁöÑÊï∞ÊçÆÁªìÊûÑÊòØÁî±‰∏Ä‰∏™<code>Segment</code>Êï∞ÁªÑÂíåÂ§ö‰∏™<code>HashEntry</code>Êï∞ÁªÑÁªÑÊàêÔºå<code>Segment</code>Â≠òÂÇ®ÁöÑÊòØÈìæË°®Êï∞ÁªÑÁöÑÂΩ¢Âºè„ÄÇ</p>
<p><img src="https://img.jwt1399.top/img/202301071551771.png" alt="concurrentHashMap-jdk1.7"></p>
<p>‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂá∫Ôºå<code>ConcurrentHashMap</code>ÂÆö‰Ωç‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑËøáÁ®ãÈúÄË¶Å‰∏§Ê¨°HashÁöÑËøáÁ®ãÔºåÁ¨¨‰∏ÄÊ¨°HashÁöÑÁõÆÁöÑÊòØÂÆö‰ΩçÂà∞SegmentÔºåÁ¨¨‰∫åÊ¨°HashÁöÑÁõÆÁöÑÊòØÂÆö‰ΩçÂà∞ÈìæË°®ÁöÑÂ§¥ÈÉ®„ÄÇ‰∏§Ê¨°HashÊâÄ‰ΩøÁî®ÁöÑÊó∂Èó¥ÊØî‰∏ÄÊ¨°HashÁöÑÊó∂Èó¥Ë¶ÅÈïøÔºå‰ΩÜËøôÊ†∑ÂÅöÂèØ‰ª•Âú®ÂÜôÊìç‰ΩúÊó∂ÔºåÂè™ÂØπÂÖÉÁ¥†ÊâÄÂú®ÁöÑsegmentÊû∑ÈîÅÔºå‰∏ç‰ºöÂΩ±ÂìçÂà∞ÂÖ∂‰ªñsegmentÔºåËøôÊ†∑ÂèØ‰ª•Â§ßÂ§ßÊèêÈ´òÂπ∂ÂèëËÉΩÂäõ„ÄÇ</p>
<p><strong>JDK1.8</strong></p>
<p>JDK1.8‰∏çÂú®ÈááÁî®segmentÁöÑÁªìÊûÑÔºåËÄåÊòØ‰ΩøÁî®NodeÊï∞ÁªÑ+ÈìæË°®/Á∫¢ÈªëÊ†ëÁöÑÊï∞ÊçÆÁªìÊûÑÊù•ÂÆûÁé∞ÁöÑÔºàÂíå<code>HashMap</code>‰∏ÄÊ†∑ÔºåÈìæË°®ËäÇÁÇπ‰∏™Êï∞Â§ß‰∫é8ÔºåÈìæË°®‰ºöËΩ¨Êç¢‰∏∫Á∫¢ÈªëÊ†ëÔºâ</p>
<p><img src="https://img.jwt1399.top/img/202301071551735.png" alt=" concurrentHashMap-jdk1.8"></p>
<p>‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂá∫ÔºåÂØπ‰∫é<code>ConcurrentHashMap</code>ÁöÑÂÆûÁé∞ÔºåJDK1.8ÁöÑÂÆûÁé∞ÊñπÂºèÂèØ‰ª•Èôç‰ΩéÈîÅÁöÑÁ≤íÂ∫¶ÔºåÂõ†‰∏∫JDLK1.7ÊâÄÂÆûÁé∞ÁöÑ<code>ConcurrentHashMap</code>ÁöÑÈîÅÁöÑÁ≤íÂ∫¶ÊòØÂü∫‰∫éSegmentÔºåËÄå‰∏Ä‰∏™SegmentÂåÖÂê´Â§ö‰∏™HashEntry„ÄÇ</p>
<h3 id="üåüConcurrentHashMapÁªìÊûÑ‰∏≠ÂèòÈáè‰ΩøÁî®volatileÂíåfinal‰øÆÈ•∞Êúâ‰ªÄ‰πà‰ΩúÁî®Ôºü"><a href="#üåüConcurrentHashMapÁªìÊûÑ‰∏≠ÂèòÈáè‰ΩøÁî®volatileÂíåfinal‰øÆÈ•∞Êúâ‰ªÄ‰πà‰ΩúÁî®Ôºü" class="headerlink" title="üåüConcurrentHashMapÁªìÊûÑ‰∏≠ÂèòÈáè‰ΩøÁî®volatileÂíåfinal‰øÆÈ•∞Êúâ‰ªÄ‰πà‰ΩúÁî®Ôºü"></a>üåüConcurrentHashMapÁªìÊûÑ‰∏≠ÂèòÈáè‰ΩøÁî®volatileÂíåfinal‰øÆÈ•∞Êúâ‰ªÄ‰πà‰ΩúÁî®Ôºü</h3><p><code>final</code>‰øÆÈ•∞ÂèòÈáèÂèØ‰ª•‰øùËØÅÂèòÈáè‰∏çÈúÄË¶ÅÂêåÊ≠•Â∞±ÂèØ‰ª•Ë¢´ËÆøÈóÆÂíåÂÖ±‰∫´Ôºå<code>volatile</code>ÂèØ‰ª•‰øùËØÅÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÔºåÈÖçÂêàCASÊìç‰ΩúÂèØ‰ª•Âú®‰∏çÂä†ÈîÅÁöÑÂâçÊèêÊîØÊåÅÂπ∂Âèë„ÄÇ</p>
<h3 id="üåüConcurrentHashMapÊúâ‰ªÄ‰πàÁº∫ÁÇπÔºü"><a href="#üåüConcurrentHashMapÊúâ‰ªÄ‰πàÁº∫ÁÇπÔºü" class="headerlink" title="üåüConcurrentHashMapÊúâ‰ªÄ‰πàÁº∫ÁÇπÔºü"></a>üåüConcurrentHashMapÊúâ‰ªÄ‰πàÁº∫ÁÇπÔºü</h3><p>Âõ†‰∏∫<code>ConcurrentHashMap</code>Âú®Êõ¥Êñ∞Êï∞ÊçÆÊó∂Âè™‰ºöÈîÅ‰ΩèÈÉ®ÂàÜÊï∞ÊçÆÔºåÂπ∂‰∏ç‰ºöÂ∞ÜÊï¥‰∏™Ë°®ÈîÅ‰ΩèÔºåËØªÂèñÁöÑÊó∂ÂÄô‰πüÂπ∂‰∏çËÉΩ‰øùËØÅËØªÂèñÂà∞ÊúÄËøëÁöÑÊõ¥Êñ∞ÔºåÂè™ËÉΩ‰øùËØÅËØªÂèñÂà∞Â∑≤ÁªèÈ°∫Âà©ÊèíÂÖ•ÁöÑÊï∞ÊçÆ„ÄÇ</p>
<h3 id="üåüConcurrentHashMapÈªòËÆ§ÂàùÂßãÂÆπÈáèÊòØÂ§öÂ∞ëÔºüÊØèÊ¨°Êâ©ÂÆπ‰∏∫ÂéüÊù•ÁöÑÂá†ÂÄçÔºü"><a href="#üåüConcurrentHashMapÈªòËÆ§ÂàùÂßãÂÆπÈáèÊòØÂ§öÂ∞ëÔºüÊØèÊ¨°Êâ©ÂÆπ‰∏∫ÂéüÊù•ÁöÑÂá†ÂÄçÔºü" class="headerlink" title="üåüConcurrentHashMapÈªòËÆ§ÂàùÂßãÂÆπÈáèÊòØÂ§öÂ∞ëÔºüÊØèÊ¨°Êâ©ÂÆπ‰∏∫ÂéüÊù•ÁöÑÂá†ÂÄçÔºü"></a>üåüConcurrentHashMapÈªòËÆ§ÂàùÂßãÂÆπÈáèÊòØÂ§öÂ∞ëÔºüÊØèÊ¨°Êâ©ÂÆπ‰∏∫ÂéüÊù•ÁöÑÂá†ÂÄçÔºü</h3><p>ConcurrentHashMapÈªòËÆ§ÁöÑÂàùÂßãÂÆπÈáè‰∏∫16ÔºåÊØèÊ¨°Êâ©ÂÆπ‰∏∫‰πãÂâçÁöÑ‰∏§ÂÄç„ÄÇ</p>
<p>ConCurrentHashmapÂú®JDK1.8‰∏≠Ôºå‰ªÄ‰πàÊÉÖÂÜµ‰∏ãÈìæË°®‰ºöËΩ¨Âåñ‰∏∫Á∫¢ÈªëÊ†ëÔºüÂΩìÈìæË°®ÈïøÂ∫¶Â§ß‰∫é8ÔºåNodeÊï∞ÁªÑÊï∞Â§ß‰∫é64Êó∂„ÄÇ</p>
<h3 id="üåüConCurrentHashMapÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºüHashMap‰∏≠ÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºü"><a href="#üåüConCurrentHashMapÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºüHashMap‰∏≠ÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºü" class="headerlink" title="üåüConCurrentHashMapÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºüHashMap‰∏≠ÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºü"></a>üåüConCurrentHashMapÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºüHashMap‰∏≠ÁöÑkeyÔºåvalueÊòØÂê¶ÂèØ‰ª•‰∏∫nullÔºü</h3><p><code>ConCurrentHashMap</code>‰∏≠ÁöÑ<code>key</code>Âíå<code>value</code>‰∏∫<code>null</code>‰ºöÂá∫Áé∞Á©∫ÊåáÈíàÂºÇÂ∏∏ÔºåËÄå<code>HashMap</code>‰∏≠ÁöÑ<code>key</code>Âíå<code>value</code>ÂÄºÊòØÂèØ‰ª•‰∏∫<code>null</code>ÁöÑ„ÄÇ</p>
<p>ÂéüÂõ†Â¶Ç‰∏ãÔºö<code>ConCurrentHashMap</code>ÊòØÂú®Â§öÁ∫øÁ®ãÂú∫ÊôØ‰∏ã‰ΩøÁî®ÁöÑÔºåÂ¶ÇÊûú<code>ConcurrentHashMap.get(key)</code>ÁöÑÂÄº‰∏∫<code>null</code>ÔºåÈÇ£‰πàÊó†Ê≥ïÂà§Êñ≠Âà∞Â∫ïÊòØ<code>key</code>ÂØπÂ∫îÁöÑ<code>value</code>ÁöÑÂÄº‰∏∫<code>null</code>ËøòÊòØ‰∏çÂ≠òÂú®ÂØπÂ∫îÁöÑ<code>key</code>ÂÄº„ÄÇËÄåÂú®ÂçïÁ∫øÁ®ãÂú∫ÊôØ‰∏ãÁöÑ<code>HashMap</code>‰∏≠ÔºåÂèØ‰ª•‰ΩøÁî®<code>containsKey(key)</code>Êù•Âà§Êñ≠Âà∞Â∫ïÊòØÂê¶Â≠òÂú®Ëøô‰∏™<code>key</code>ËøòÊòØ<code>key</code>ÂØπÂ∫îÁöÑ<code>value</code>ÁöÑÂÄº‰∏∫<code>null</code>„ÄÇÂú®Â§öÁ∫øÁ®ãÁöÑÊÉÖÂÜµ‰∏ã‰ΩøÁî®<code>containsKey(key)</code>Êù•ÂÅöËøô‰∏™Âà§Êñ≠ÊòØÂ≠òÂú®ÈóÆÈ¢òÁöÑÔºåÂõ†‰∏∫Âú®<code>containsKey(key)</code>Âíå<code>ConcurrentHashMap.get(key)</code>‰∏§Ê¨°Ë∞ÉÁî®ÁöÑËøáÁ®ã‰∏≠Ôºå<code>key</code>ÁöÑÂÄºÂ∑≤ÁªèÂèëÁîü‰∫ÜÊîπÂèò„ÄÇ</p>
<h3 id="üåüConcurrentHashMapÂú®JDK1-7ÂíåJDK1-8ÁâàÊú¨‰∏≠ÁöÑÂå∫Âà´Ôºü"><a href="#üåüConcurrentHashMapÂú®JDK1-7ÂíåJDK1-8ÁâàÊú¨‰∏≠ÁöÑÂå∫Âà´Ôºü" class="headerlink" title="üåüConcurrentHashMapÂú®JDK1.7ÂíåJDK1.8ÁâàÊú¨‰∏≠ÁöÑÂå∫Âà´Ôºü"></a>üåüConcurrentHashMapÂú®JDK1.7ÂíåJDK1.8ÁâàÊú¨‰∏≠ÁöÑÂå∫Âà´Ôºü</h3><ul>
<li>  ÂÆûÁé∞ÁªìÊûÑ‰∏äÁöÑ‰∏çÂêåÔºåJDK1.7ÊòØÂü∫‰∫éSegmentÂÆûÁé∞ÁöÑÔºåJDK1.8ÊòØÂü∫‰∫éNodeÊï∞ÁªÑ+ÈìæË°®/Á∫¢ÈªëÊ†ëÂÆûÁé∞ÁöÑ„ÄÇ</li>
<li>  ‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®ÊñπÈù¢ÔºöJDK1.7ÈááÁî®‰∫ÜÂàÜÊÆµÈîÅÁöÑÊú∫Âà∂ÔºåÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂç†Áî®ÈîÅÊó∂Ôºå‰ºöÈîÅ‰Ωè‰∏Ä‰∏™SegmentÂØπË±°Ôºå‰∏ç‰ºöÂΩ±ÂìçÂÖ∂‰ªñSegmentÂØπË±°„ÄÇJDK1.8ÂàôÊòØÈááÁî®‰∫ÜCASÂíå<code>synchronize</code>ÁöÑÊñπÂºèÊù•‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ</li>
<li>Âú®Â≠òÂèñÊï∞ÊçÆÊñπÈù¢Ôºö<ul>
<li><strong>JDK1.7‰∏≠ÁöÑ<code>put()</code>ÊñπÊ≥ïÔºö</strong><ul>
<li>  ÂÖàËÆ°ÁÆóÂá∫<code>key</code>ÁöÑ<code>hash</code>ÂÄºÔºåÂà©Áî®<code>hash</code>ÂÄºÂØπsegmentÊï∞ÁªÑÂèñ‰ΩôÊâæÂà∞ÂØπÂ∫îÁöÑsegmentÂØπË±°„ÄÇ</li>
<li>  Â∞ùËØïËé∑ÂèñÈîÅÔºåÂ§±Ë¥•ÂàôËá™ÊóãÁõ¥Ëá≥ÊàêÂäüÔºåËé∑ÂèñÂà∞ÈîÅÔºåÈÄöËøáËÆ°ÁÆóÁöÑ<code>hash</code>ÂÄºÂØπhashentryÊï∞ÁªÑËøõË°åÂèñ‰ΩôÔºåÊâæÂà∞ÂØπÂ∫îÁöÑentryÂØπË±°„ÄÇ</li>
<li>  ÈÅçÂéÜÈìæË°®ÔºåÊü•ÊâæÂØπÂ∫îÁöÑ<code>key</code>ÂÄºÔºåÂ¶ÇÊûúÊâæÂà∞ÂàôÂ∞ÜÊóßÁöÑvalueÁõ¥Êé•Ë¶ÜÁõñÔºåÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÔºåÂàôÊ∑ªÂä†Âà∞ÈìæË°®‰∏≠„ÄÇÔºàJDK1.7ÊòØÊèíÂÖ•Âà∞ÈìæË°®Â§¥ÈÉ®ÔºåJDK1.8ÊòØÊèíÂÖ•Âà∞ÈìæË°®Â∞æÈÉ®ÔºåËøôÈáåÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ã‰∏∫‰ªÄ‰πàËøôÊ†∑Ôºâ</li>
</ul>
</li>
<li><strong>JDK1.8‰∏≠ÁöÑ<code>put()</code>ÊñπÊ≥ï:</strong><ul>
<li>  ËÆ°ÁÆó<code>key</code>ÂÄºÁöÑ<code>hash</code>ÂÄºÔºåÊâæÂà∞ÂØπÂ∫îÁöÑ<code>Node</code>ÔºåÂ¶ÇÊûúÂΩìÂâç‰ΩçÁΩÆ‰∏∫Á©∫ÂàôÂèØ‰ª•Áõ¥Êé•ÂÜôÂÖ•Êï∞ÊçÆ„ÄÇ</li>
<li>  Âà©Áî®CASÂ∞ùËØïÂÜôÂÖ•ÔºåÂ¶ÇÊûúÂ§±Ë¥•ÂàôËá™ÊóãÁõ¥Ëá≥ÊàêÂäüÔºåÂ¶ÇÊûúÈÉΩ‰∏çÊª°Ë∂≥ÔºåÂàôÂà©Áî®<code>synchronized</code>ÈîÅÂÜôÂÖ•Êï∞ÊçÆ„ÄÇ</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="üåüConcurrentHashMapËø≠‰ª£Âô®ÊòØÂº∫‰∏ÄËá¥ÊÄßËøòÊòØÂº±‰∏ÄËá¥ÊÄßÔºü"><a href="#üåüConcurrentHashMapËø≠‰ª£Âô®ÊòØÂº∫‰∏ÄËá¥ÊÄßËøòÊòØÂº±‰∏ÄËá¥ÊÄßÔºü" class="headerlink" title="üåüConcurrentHashMapËø≠‰ª£Âô®ÊòØÂº∫‰∏ÄËá¥ÊÄßËøòÊòØÂº±‰∏ÄËá¥ÊÄßÔºü"></a>üåüConcurrentHashMapËø≠‰ª£Âô®ÊòØÂº∫‰∏ÄËá¥ÊÄßËøòÊòØÂº±‰∏ÄËá¥ÊÄßÔºü</h3><p>‰∏éHashMap‰∏çÂêåÁöÑÊòØÔºå<code>ConcurrentHashMap</code>Ëø≠‰ª£Âô®ÊòØÂº±‰∏ÄËá¥ÊÄß„ÄÇ</p>
<p>Âº±‰∏ÄËá¥ÊÄßÔºöÂΩì<code>ConcurrentHashMap</code>ÁöÑËø≠‰ª£Âô®ÂàõÂª∫ÂêéÔºå‰ºöÈÅçÂéÜÂìàÂ∏åË°®‰∏≠ÁöÑÂÖÉÁ¥†ÔºåÂú®ÈÅçÂéÜÁöÑËøáÁ®ã‰∏≠ÔºåÂìàÂ∏åË°®‰∏≠ÁöÑÂÖÉÁ¥†ÂèØËÉΩÂèëÁîüÂèòÂåñÔºåÂ¶ÇÊûúËøôÈÉ®ÂàÜÂèòÂåñÂèëÁîüÂú®Â∑≤ÁªèÈÅçÂéÜËøáÁöÑÂú∞ÊñπÔºåËø≠‰ª£Âô®Âàô‰∏ç‰ºöÂèçÊò†Âá∫Êù•ÔºåÂ¶ÇÊûúËøôÈÉ®ÂàÜÂèòÂåñÂèëÁîüÂú®Êú™ÈÅçÂéÜËøáÁöÑÂú∞ÊñπÔºåËø≠‰ª£Âô®Âàô‰ºöÂèçÊò†Âá∫Êù•„ÄÇÊç¢ÁßçËØ¥Ê≥ïÂ∞±ÊòØ<code>put()</code>ÊñπÊ≥ïÂ∞Ü‰∏Ä‰∏™ÂÖÉÁ¥†Âä†ÂÖ•Âà∞Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÂêéÔºå<code>get()</code>ÂèØËÉΩÂú®ÊüêÊÆµÊó∂Èó¥ÂÜÖËøòÁúã‰∏çÂà∞Ëøô‰∏™ÂÖÉÁ¥†„ÄÇ</p>
<p>ËøôÊ†∑ËÆæËÆ°‰∏ªË¶ÅÊòØ‰∏∫<code>ConcurrenthashMap</code>ÁöÑÊÄßËÉΩËÄÉËôëÔºåÂ¶ÇÊûúÊÉ≥ÂÅöÂà∞Âº∫‰∏ÄËá¥ÊÄßÔºåÂ∞±Ë¶ÅÂà∞Â§ÑÂä†ÈîÅÔºåÊÄßËÉΩ‰ºö‰∏ãÈôçÂæàÂ§ö„ÄÇÊâÄ‰ª•<code>ConcurrentHashMap</code>ÊòØÊîØÊåÅÂú®Ëø≠‰ª£ËøáÁ®ã‰∏≠ÔºåÂêëmap‰∏≠Ê∑ªÂä†ÂÖÉÁ¥†ÁöÑÔºåËÄå<code>HashMap</code>ËøôÊ†∑Êìç‰ΩúÂàô‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</p>
<h2 id="‚ù∑CopyOnWriteArrayList"><a href="#‚ù∑CopyOnWriteArrayList" class="headerlink" title="‚ù∑CopyOnWriteArrayList"></a>‚ù∑CopyOnWriteArrayList</h2><h3 id="üåü‰ªÄ‰πàÊòØCopyOnWriteArrayListÔºü"><a href="#üåü‰ªÄ‰πàÊòØCopyOnWriteArrayListÔºü" class="headerlink" title="üåü‰ªÄ‰πàÊòØCopyOnWriteArrayListÔºü"></a>üåü‰ªÄ‰πàÊòØCopyOnWriteArrayListÔºü</h3><blockquote>
<p><code>CopyOnWriteArrayList</code>‰∏é<code>ReentrantReadWriteLock</code> ËØªÂÜôÈîÅÁöÑÊÄùÊÉ≥ÈùûÂ∏∏Á±ª‰ººÔºå‰πüÂ∞±ÊòØËØªËØªÂÖ±‰∫´„ÄÅÂÜôÂÜô‰∫íÊñ•„ÄÅËØªÂÜô‰∫íÊñ•„ÄÅÂÜôËØª‰∫íÊñ•„ÄÇJDK ‰∏≠Êèê‰æõ‰∫Ü <code>CopyOnWriteArrayList</code> Á±ªÁõ∏ÊØî‰∫éËØªÂÜôÈîÅÁöÑÊÄùÊÉ≥ÂèàÊõ¥Ëøõ‰∏ÄÊ≠•„ÄÇ</p>
</blockquote>
<p>ËØªÂèñÊìç‰ΩúÊòØÂÆâÂÖ®ÁöÑ„ÄÇ‰∏∫‰∫ÜÂ∞ÜËØªÂèñÁöÑÊÄßËÉΩÂèëÊå•Âà∞ÊûÅËá¥Ôºå<code>CopyOnWriteArrayList</code> ËØªÂèñÊòØÂÆåÂÖ®‰∏çÁî®Âä†ÈîÅÁöÑÔºåÂπ∂‰∏îÊõ¥ÂéâÂÆ≥ÁöÑÊòØÔºöÂÜôÂÖ•‰πü‰∏ç‰ºöÈòªÂ°ûËØªÂèñÊìç‰Ωú„ÄÇÂè™ÊúâÂÜôÂÖ•ÂíåÂÜôÂÖ•‰πãÈó¥ÈúÄË¶ÅËøõË°åÂêåÊ≠•Á≠âÂæÖ„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåËØªÊìç‰ΩúÁöÑÊÄßËÉΩÂ∞±‰ºöÂ§ßÂπÖÂ∫¶ÊèêÂçá„ÄÇ</p>
<p>CopyOnWriteArrayList ÈááÁî®‰∫Ü<strong>ÂÜôÂÖ•Êó∂Êã∑Ë¥ù</strong>ÁöÑÊÄùÊÉ≥ÔºåÂ¢ûÂà†ÊîπÊìç‰Ωú‰ºöÂ∞ÜÂ∫ïÂ±ÇÊï∞ÁªÑÊã∑Ë¥ù‰∏Ä‰ªΩÔºåÂú®Êñ∞Êï∞ÁªÑ‰∏äÊâßË°åÊìç‰ΩúÔºå‰∏çÂΩ±ÂìçÂÖ∂ÂÆÉÁ∫øÁ®ãÁöÑ<strong>Âπ∂ÂèëËØªÔºåËØªÂÜôÂàÜÁ¶ª</strong></p>
<h3 id="üåüCopyOnWriteArrayList-ÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÔºü"><a href="#üåüCopyOnWriteArrayList-ÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÔºü" class="headerlink" title="üåüCopyOnWriteArrayList ÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÔºü"></a>üåüCopyOnWriteArrayList ÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÔºü</h3><p><code>CopyOnWriteArrayList</code> Á±ªÁöÑÊâÄÊúâÂèØÂèòÊìç‰ΩúÔºàaddÔºåset Á≠âÁ≠âÔºâÈÉΩÊòØÈÄöËøáÂàõÂª∫Â∫ïÂ±ÇÊï∞ÁªÑÁöÑÊñ∞ÂâØÊú¨Êù•ÂÆûÁé∞ÁöÑ„ÄÇÂΩì List ÈúÄË¶ÅË¢´‰øÆÊîπÁöÑÊó∂ÂÄôÔºåÂπ∂‰∏ç‰øÆÊîπÂéüÊúâÂÜÖÂÆπÔºåËÄåÊòØÂØπÂéüÊúâÊï∞ÊçÆËøõË°å‰∏ÄÊ¨°Â§çÂà∂ÔºåÂ∞Ü‰øÆÊîπÁöÑÂÜÖÂÆπÂÜôÂÖ•ÂâØÊú¨„ÄÇÂÜôÂÆå‰πãÂêéÔºåÂÜçÂ∞Ü‰øÆÊîπÂÆåÁöÑÂâØÊú¨ÊõøÊç¢ÂéüÊù•ÁöÑÊï∞ÊçÆÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰øùËØÅÂÜôÊìç‰Ωú‰∏ç‰ºöÂΩ±ÂìçËØªÊìç‰Ωú‰∫Ü„ÄÇ</p>
<h3 id="üåüCopyOnWriteArrayListÊúâ‰ΩïÁº∫Èô∑ÔºåËØ¥ËØ¥ÂÖ∂Â∫îÁî®Âú∫ÊôØ"><a href="#üåüCopyOnWriteArrayListÊúâ‰ΩïÁº∫Èô∑ÔºåËØ¥ËØ¥ÂÖ∂Â∫îÁî®Âú∫ÊôØ" class="headerlink" title="üåüCopyOnWriteArrayListÊúâ‰ΩïÁº∫Èô∑ÔºåËØ¥ËØ¥ÂÖ∂Â∫îÁî®Âú∫ÊôØ?"></a>üåüCopyOnWriteArrayListÊúâ‰ΩïÁº∫Èô∑ÔºåËØ¥ËØ¥ÂÖ∂Â∫îÁî®Âú∫ÊôØ?</h3><ul>
<li>Áî±‰∫éÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÊã∑Ë¥ùÊï∞ÁªÑÔºå‰ºöÊ∂àËÄóÂÜÖÂ≠òÔºåÂ¶ÇÊûúÂéüÊï∞ÁªÑÁöÑÂÜÖÂÆπÊØîËæÉÂ§öÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØËÉΩÂØºËá¥young gcÊàñËÄÖfull gc</li>
<li>‰∏çËÉΩÁî®‰∫éÂÆûÊó∂ËØªÁöÑÂú∫ÊôØÔºåÂÉèÊã∑Ë¥ùÊï∞ÁªÑ„ÄÅÊñ∞Â¢ûÂÖÉÁ¥†ÈÉΩÈúÄË¶ÅÊó∂Èó¥ÔºåÊâÄ‰ª•Ë∞ÉÁî®‰∏Ä‰∏™setÊìç‰ΩúÂêéÔºåËØªÂèñÂà∞Êï∞ÊçÆÂèØËÉΩËøòÊòØÊóßÁöÑÔºåËôΩÁÑ∂CopyOnWriteArrayList ËÉΩÂÅöÂà∞ÊúÄÁªà‰∏ÄËá¥ÊÄßÔºå‰ΩÜÊòØËøòÊòØÊ≤°Ê≥ïÊª°Ë∂≥ÂÆûÊó∂ÊÄßË¶ÅÊ±ÇÔºõ</li>
</ul>
<p><strong>CopyOnWriteArrayList ÈÄÇÂêàËØªÂ§öÂÜôÂ∞ëÁöÑÂú∫ÊôØ</strong></p>
<h2 id="‚ù∏ConcurrentLinkedQueue"><a href="#‚ù∏ConcurrentLinkedQueue" class="headerlink" title="‚ù∏ConcurrentLinkedQueue"></a>‚ù∏ConcurrentLinkedQueue</h2><p>Java Êèê‰æõÁöÑÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ <code>Queue</code> ÂèØ‰ª•ÂàÜ‰∏∫<strong>ÈòªÂ°ûÈòüÂàó</strong>Âíå<strong>ÈùûÈòªÂ°ûÈòüÂàó</strong></p>
<ul>
<li>ÈòªÂ°ûÈòüÂàóÁöÑÂÖ∏Âûã‰æãÂ≠êÊòØ <code>BlockingQueue</code>ÔºåÈòªÂ°ûÈòüÂàóÂèØ‰ª•ÈÄöËøá<strong>Âä†ÈîÅ</strong>Êù•ÂÆûÁé∞</li>
<li>ÈùûÈòªÂ°ûÈòüÂàóÁöÑÂÖ∏Âûã‰æãÂ≠êÊòØ <code>ConcurrentLinkedQueue</code>Ôºå ÈùûÈòªÂ°ûÈòüÂàóÂèØ‰ª•ÈÄöËøá <strong>CAS</strong> Êìç‰ΩúÂÆûÁé∞„ÄÇ</li>
</ul>
<p><code>ConcurrentLinkedQueue</code>Ëøô‰∏™ÈòüÂàó‰ΩøÁî®ÈìæË°®‰Ωú‰∏∫ÂÖ∂Êï∞ÊçÆÁªìÊûÑÔºé<code>ConcurrentLinkedQueue</code> Â∫îËØ•ÁÆóÊòØÂú®È´òÂπ∂ÂèëÁéØÂ¢É‰∏≠ÊÄßËÉΩÊúÄÂ•ΩÁöÑÈòüÂàó‰∫Ü„ÄÇÂÆÉ‰πãÊâÄÊúâËÉΩÊúâÂæàÂ•ΩÁöÑÊÄßËÉΩÔºåÊòØÂõ†‰∏∫ÂÖ∂ÂÜÖÈÉ®Â§çÊùÇÁöÑÂÆûÁé∞„ÄÇ</p>
<p> <code>ConcurrentLinkedQueue</code> ‰∏ªË¶Å‰ΩøÁî® CAS ÈùûÈòªÂ°ûÁÆóÊ≥ïÊù•ÂÆûÁé∞Á∫øÁ®ãÂÆâÂÖ®„ÄÇ</p>
<p><code>ConcurrentLinkedQueue</code> ÈÄÇÂêàÂú®ÂØπÊÄßËÉΩË¶ÅÊ±ÇÁõ∏ÂØπËæÉÈ´òÔºåÂêåÊó∂ÂØπÈòüÂàóÁöÑËØªÂÜôÂ≠òÂú®Â§ö‰∏™Á∫øÁ®ãÂêåÊó∂ËøõË°åÁöÑÂú∫ÊôØÔºåÂç≥Â¶ÇÊûúÂØπÈòüÂàóÂä†ÈîÅÁöÑÊàêÊú¨ËæÉÈ´òÂàôÈÄÇÂêà‰ΩøÁî®Êó†ÈîÅÁöÑ <code>ConcurrentLinkedQueue</code> Êù•Êõø‰ª£„ÄÇ</p>
<h2 id="‚ùπBlockingQueue"><a href="#‚ùπBlockingQueue" class="headerlink" title="‚ùπBlockingQueue"></a>‚ùπBlockingQueue</h2><p>ÈòªÂ°ûÈòüÂàóÔºàBlockingQueueÔºâË¢´ÂπøÊ≥õ‰ΩøÁî®Âú®‚ÄúÁîü‰∫ßËÄÖ-Ê∂àË¥πËÄÖ‚ÄùÈóÆÈ¢ò‰∏≠ÔºåÂÖ∂ÂéüÂõ†ÊòØ BlockingQueue Êèê‰æõ‰∫ÜÂèØÈòªÂ°ûÁöÑÊèíÂÖ•ÂíåÁßªÈô§ÁöÑÊñπÊ≥ï„ÄÇÂΩìÈòüÂàóÂÆπÂô®Â∑≤Êª°ÔºåÁîü‰∫ßËÄÖÁ∫øÁ®ã‰ºöË¢´ÈòªÂ°ûÔºåÁõ¥Âà∞ÈòüÂàóÊú™Êª°ÔºõÂΩìÈòüÂàóÂÆπÂô®‰∏∫Á©∫Êó∂ÔºåÊ∂àË¥πËÄÖÁ∫øÁ®ã‰ºöË¢´ÈòªÂ°ûÔºåÁõ¥Ëá≥ÈòüÂàóÈùûÁ©∫Êó∂‰∏∫Ê≠¢„ÄÇ</p>
<p>BlockingQueue ÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåÁªßÊâøËá™ QueueÔºåÊâÄ‰ª•ÂÖ∂ÂÆûÁé∞Á±ª‰πüÂèØ‰ª•‰Ωú‰∏∫ Queue ÁöÑÂÆûÁé∞Êù•‰ΩøÁî®ÔºåËÄå Queue ÂèàÁªßÊâøËá™ Collection Êé•Âè£„ÄÇ‰∏ãÈù¢ÊòØ BlockingQueue ÁöÑÁõ∏ÂÖ≥ÂÆûÁé∞Á±ªÔºö</p>
<p><img src="https://img.jwt1399.top/img/202301071556671.png"></p>
<h2 id="‚ù∫ConcurrentSkipListMap"><a href="#‚ù∫ConcurrentSkipListMap" class="headerlink" title="‚ù∫ConcurrentSkipListMap"></a>‚ù∫ConcurrentSkipListMap</h2><p>ÂØπ‰∫é‰∏Ä‰∏™ÂçïÈìæË°®ÔºåÂç≥‰ΩøÈìæË°®ÊòØÊúâÂ∫èÁöÑÔºåÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥Ë¶ÅÂú®ÂÖ∂‰∏≠Êü•ÊâæÊüê‰∏™Êï∞ÊçÆÔºå‰πüÂè™ËÉΩ‰ªéÂ§¥Âà∞Â∞æÈÅçÂéÜÈìæË°®ÔºåËøôÊ†∑ÊïàÁéáËá™ÁÑ∂Â∞±‰ºöÂæà‰ΩéÔºåË∑≥Ë°®Â∞±‰∏ç‰∏ÄÊ†∑‰∫Ü„ÄÇË∑≥Ë°®ÊòØ‰∏ÄÁßçÂèØ‰ª•Áî®Êù•Âø´ÈÄüÊü•ÊâæÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊúâÁÇπÁ±ª‰ºº‰∫éÂπ≥Ë°°Ê†ë„ÄÇÂÆÉ‰ª¨ÈÉΩÂèØ‰ª•ÂØπÂÖÉÁ¥†ËøõË°åÂø´ÈÄüÁöÑÊü•Êâæ„ÄÇ</p>
<p>‰ΩÜ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÂå∫Âà´ÊòØÔºöÂØπÂπ≥Ë°°Ê†ëÁöÑÊèíÂÖ•ÂíåÂà†Èô§ÂæÄÂæÄÂæàÂèØËÉΩÂØºËá¥Âπ≥Ë°°Ê†ëËøõË°å‰∏ÄÊ¨°ÂÖ®Â±ÄÁöÑË∞ÉÊï¥„ÄÇËÄåÂØπË∑≥Ë°®ÁöÑÊèíÂÖ•ÂíåÂà†Èô§Âè™ÈúÄË¶ÅÂØπÊï¥‰∏™Êï∞ÊçÆÁªìÊûÑÁöÑÂ±ÄÈÉ®ËøõË°åÊìç‰ΩúÂç≥ÂèØ„ÄÇËøôÊ†∑Â∏¶Êù•ÁöÑÂ•ΩÂ§ÑÊòØÔºöÂú®È´òÂπ∂ÂèëÁöÑÊÉÖÂÜµ‰∏ãÔºå‰Ω†‰ºöÈúÄË¶Å‰∏Ä‰∏™ÂÖ®Â±ÄÈîÅÊù•‰øùËØÅÊï¥‰∏™Âπ≥Ë°°Ê†ëÁöÑÁ∫øÁ®ãÂÆâÂÖ®„ÄÇËÄåÂØπ‰∫éË∑≥Ë°®Ôºå‰Ω†Âè™ÈúÄË¶ÅÈÉ®ÂàÜÈîÅÂç≥ÂèØ„ÄÇËøôÊ†∑ÔºåÂú®È´òÂπ∂ÂèëÁéØÂ¢É‰∏ãÔºå‰Ω†Â∞±ÂèØ‰ª•Êã•ÊúâÊõ¥Â•ΩÁöÑÊÄßËÉΩ„ÄÇËÄåÂ∞±Êü•ËØ¢ÁöÑÊÄßËÉΩËÄåË®ÄÔºåË∑≥Ë°®ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰πüÊòØ O(logn) „ÄÇË∑≥Ë°®ÁöÑÊú¨Ë¥®ÊòØÂêåÊó∂Áª¥Êä§‰∫ÜÂ§ö‰∏™ÈìæË°®ÔºåÂπ∂‰∏îÈìæË°®ÊòØÂàÜÂ±ÇÁöÑ„ÄÇ</p>
<h1 id="üìöÂèÇËÄÉËµÑÊñô"><a href="#üìöÂèÇËÄÉËµÑÊñô" class="headerlink" title="üìöÂèÇËÄÉËµÑÊñô"></a>üìöÂèÇËÄÉËµÑÊñô</h1><ul>
<li><a target="_blank" rel="noopener" href="https://pdai.tech/md/java/thread/java-thread-x-overview.html">‚ô•JavaÂπ∂ÂèëÁü•ËØÜ‰ΩìÁ≥ªËØ¶Ëß£‚ô• | Java ÂÖ®Ê†àÁü•ËØÜ‰ΩìÁ≥ª (pdai.tech)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.mianshi.online/multi-thread-daemon-thread.html">Ë∑Ø‰∫∫Âº†ÁöÑÈù¢ËØïÁ¨îËÆ∞ (mianshi.online)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CL0610/Java-concurrency">JavaÂπ∂ÂèëÁü•ËØÜÁÇπÊÄªÁªì (github.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/feichitianxia/article/details/110495764?spm=1001.2014.3001.5502"> ‰∏ÄÊñáËÆ©‰Ω†ÂΩªÂ∫ïÊòéÁôΩThreadLocal</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/crazymakercircle/p/14491965.html#autoid-h2-0-0-0">ThreadLocalÔºàÂè≤‰∏äÊúÄÂÖ®Ôºâ</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/3f413b4af088415baafc159591a1a411">CASÊìç‰ΩúÁöÑÂ∫ïÂ±ÇÂéüÁêÜ‰ª•ÂèäÂ∫îÁî®ËØ¶Ëß£</a></li>
</ul>
<h1 id="‚ù§Ô∏èSponsor"><a href="#‚ù§Ô∏èSponsor" class="headerlink" title="‚ù§Ô∏èSponsor"></a>‚ù§Ô∏èSponsor</h1><p>ÊÇ®ÁöÑÊîØÊåÅÊòØÊàë‰∏çÊñ≠ÂâçËøõÁöÑÂä®ÂäõÔºåÂ¶ÇÊûúÊÇ®ÊÑüËßâÊú¨ÊñáÂØπÊÇ®ÊúâÊâÄÂ∏ÆÂä©ÁöÑËØùÔºåÂèØ‰ª•ËÄÉËôëÊâìËµè‰∏Ä‰∏ãÊú¨ÊñáÔºåÁî®‰ª•Áª¥ÊåÅÊú¨ÂçöÂÆ¢ÁöÑËøêËê•Ë¥πÁî®ÔºåÊãíÁªùÁôΩÂ´ñÔºå‰ªé‰Ω†ÊàëÂÅöËµ∑ÔºÅü•∞ü•∞ü•∞</p>
<table>
  <tbody>
     <tr>
         <td style="text-align:center;">ÊîØ‰ªòÂÆù</td>
         <td style="text-align:center;">ÂæÆ‰ø°</td>
     </tr>
   <tr>
    <td style="text-align:center;" ><img width="200" src="https://jwt1399.top/medias/reward/alipay.png"></td>    
      <td style="text-align:center;"><img width="200" src="https://jwt1399.top/medias/reward/sponor_wechat.png"></td>     
  </tr>
</tbody></table>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        ÊñáÁ´†‰ΩúËÄÖ:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jwt1399.top" rel="external nofollow noreferrer">ÁÆÄÁÆÄ</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        ÊñáÁ´†ÈìæÊé•:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jwt1399.top/posts/19988.html">https://jwt1399.top/posts/19988.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ÁâàÊùÉÂ£∞Êòé:
                    </i>
                </span>
                <span class="reprint-info">
                    Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà•Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî®
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÊù•Ê∫ê
                    <a href="https://jwt1399.top" target="_blank">ÁÆÄÁÆÄ</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Â§çÂà∂ÊàêÂäüÔºåËØ∑ÈÅµÂæ™Êú¨ÊñáÁöÑËΩ¨ËΩΩËßÑÂàô</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">Êü•Áúã</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/JUC/">
                                    <span class="chip bg-color">JUC</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,linkedin,facebook,twitter,google,douban" data-wechat-qrcode-helper="<p>ÂæÆ‰ø°Êâ´‰∏ÄÊâ´Âç≥ÂèØÂàÜ‰∫´ÔºÅ</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">Êâì</a>
	<a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">Ëµè</a>
    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">‰Ω†ÁöÑËµèËØÜÊòØÊàëÂâçËøõÁöÑÂä®Âäõ</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">ÊîØ‰ªòÂÆù</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">ÂæÆ ‰ø°</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="ÊîØ‰ªòÂÆùÊâìËµè‰∫åÁª¥Á†Å">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="ÂæÆ‰ø°ÊâìËµè‰∫åÁª¥Á†Å">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        /*max-width: 100%;*/
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
    .v[data-class=v] .vinput {
     padding: 0px 0px;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>ËØÑËÆ∫<center>Â°´‰∏äÈÇÆÁÆ±‰ºöÊî∂Âà∞ËØÑËÆ∫ÂõûÂ§çÊèêÈÜíÂì¶!!!</center></span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/valine/1.4.18/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'Awf92dhT3VWqTfENqbCDoqbA-gzGzoHsz',
        appKey: '9uN7ODvigK9GAp8CYBz0fOrX',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: '',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '[Â°´‰∏äÈÇÆÁÆ±Ôºå‰ºöÁªô‰Ω†ÂèëÈÄÅËØÑËÆ∫ÊèêÈÜí]Ôºå„ÉæÔæâ‚âß‚àÄ‚â¶)o ËØ∑ÁïÖÊâÄÊ¨≤Ë®Ä~',
        enableQQ: true,
        boolean: true,
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Êú¨ÁØá
            </div>
            <div class="card">
                <a href="/posts/19988.html">
                    <div class="card-image">
                        
                        <img src="https://img.jwt1399.top/img/202212062044543.jpg" class="responsive-img" alt="Q&AÔºöJUC">
                        
                        <span class="card-title">Q&AÔºöJUC</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            ‚ë†Á∫øÁ®ã‚ù∂Âü∫Á°ÄüåüÁ∫øÁ®ãÂíåËøõÁ®ãÁöÑÂå∫Âà´ËøõÁ®ãÔºöÊòØÁ®ãÂ∫èËøêË°åÂíåËµÑÊ∫êÂàÜÈÖçÁöÑÂü∫Êú¨Âçï‰Ωç

Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÂ†ÜÂíåÊ†àÔºåÊó¢‰∏çÂÖ±‰∫´Â†ÜÔºå‰∫¶‰∏çÂÖ±‰∫´Ê†àÔºåËøõÁ®ãÁî±Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶„ÄÇ

Á∫øÁ®ãÔºöÊòØ CPU Ë∞ÉÂ∫¶ÂíåÂàÜÊ¥æÁöÑÂü∫Êú¨Âçï‰ΩçÔºåÊòØËøõÁ®ãÁöÑ‰∏Ä‰∏™ÂÆû‰Ωì

Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÊ†àÂíåÂÖ±‰∫´ÁöÑÂ†ÜÔºåÂÖ±‰∫´Â†ÜÔºå‰∏ç
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-12-27
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Q-A/" class="post-category">
                                    Q&A
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JUC/">
                        <span class="chip bg-color">JUC</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ‰∏ã‰∏ÄÁØá&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/38527.html">
                    <div class="card-image">
                        
                        <img src="https://img.jwt1399.top/img/202212022124200.jpg" class="responsive-img" alt="Q&AÔºöJVM">
                        
                        <span class="card-title">Q&AÔºöJVM</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Êú¨ÁØáÊñáÁ´†‰∏≠Êï¥ÁêÜ‰∫ÜJVM‰∏≠ÂøÖÁü•ÂøÖ‰ºöÁü•ËØÜÁÇπÔºåÂåÖÂê´JVMÂÜÖÂ≠òÁªìÊûÑ„ÄÅÂØπË±°ÂÆû‰æãÂåñ„ÄÅÂûÉÂúæÂõûÊî∂„ÄÅÁ±ªÂä†ËΩΩ„ÄÅJVMË∞É‰ºòÁ≠âÁ≠âÁªèÂÖ∏ÈóÆÈ¢ò
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-12-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Q-A/" class="post-category">
                                    Q&A
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JVM/">
                        <span class="chip bg-color">JVM</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('100')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'Êù•Ê∫ê: ÁÆÄË®Ä‰πã<br />'
            + 'ÊñáÁ´†‰ΩúËÄÖ: ÁÆÄÁÆÄ<br />'
            + 'ÊñáÁ´†ÈìæÊé•: <a href="' + url + '">' + url + '</a><br />'
            + 'Êú¨ÊñáÁ´†Ëëó‰ΩúÊùÉÂΩí‰ΩúËÄÖÊâÄÊúâÔºå‰ªª‰ΩïÂΩ¢ÂºèÁöÑËΩ¨ËΩΩÈÉΩËØ∑Ê≥®ÊòéÂá∫Â§Ñ„ÄÇ';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- ‰ª£Á†ÅÂùóÂäüËÉΩ‰æùËµñ -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ‰ª£Á†ÅËØ≠Ë®Ä -->

    
<!-- ‰ª£Á†ÅÂùóÂ§çÂà∂ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ‰ª£Á†ÅÂùóÊî∂Áº© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- ‰ª£Á†ÅÂùóÊäòË°å -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ÁõÆÂΩï</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC ÊÇ¨ÊµÆÊåâÈíÆ. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('2'),
            headingSelector: 'h1, h2, h3, h4, h5, h6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4, h5, h6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ‰øÆÂ§çÊñáÁ´†Âç°Áâá div ÁöÑÂÆΩÂ∫¶. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // ÂàáÊç¢TOCÁõÆÂΩïÂ±ïÂºÄÊî∂Áº©ÁöÑÁõ∏ÂÖ≥Êìç‰Ωú.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="https://jwt1399.top" target="_blank">ÁÆÄÁÆÄ</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>&nbsp;|

			<!-- <span>‰∏∫‚ô•Ô∏èÔ∏èÂèëÁîµ</span> -->
            <a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img no-lazy src="https://img.jwt1399.top/img/20200824181422.png" style="width: 47px; vertical-align: middle;" ></a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;Á´ôÁÇπÊÄªÂ≠óÊï∞:&nbsp;<span
                class="white-color">921k</span>&nbsp;Â≠ó
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;ÊÄªËÆøÈóÆÈáè:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;Ê¨°
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;ÊÄªËÆøÈóÆ‰∫∫Êï∞:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;‰∫∫
            </span>
            
            <br>

            
            <span id="sitetime">ËΩΩÂÖ•ËøêË°åÊó∂Èó¥...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "7";
                    var startDate = "2";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "Êú¨Á´ôÂ∑≤ÂÆâÂÖ®ËøêË°å " + diffDays + " Â§© " + diffHours +
                            " Â∞èÊó∂ " + diffMinutes + " ÂàÜÈíü " + diffSeconds + " Áßí";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "Êú¨Á´ôÂ∑≤ÂÆâÂÖ®ËøêË°å " + diffYears + " Âπ¥ " + diffDays +
                            " Â§© " + diffHours + " Â∞èÊó∂ " + diffMinutes + " ÂàÜÈíü " + diffSeconds + " Áßí";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            <a href="https://search.google.com/search-console?resource_id=http%3A%2F%2Fjwt1399.top%2F" target="_blank"
                rel="nofollow noopener">Ë∞∑Ê≠åÁªüËÆ°</a>&nbsp;|
            
            <span id="icp"><img no-lazy src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://www.beian.miit.gov.cn/" target="_blank">ËúÄICPÂ§á19020450Âè∑</a>
            </span>
            |
            
            <a href="https://tongji.baidu.com/web/10000159136/overview/index?siteId=14519996" target="_blank"
                rel="nofollow noopener">ÁôæÂ∫¶ÁªüËÆ°</a>

        </div>
        <div class="col s12 m4 l4 social-link social-statis">

    <a href="https://jwt1399.top/baidusitemap.xml" class="tooltipped" target="_blank" data-tooltip="ËÆøÈóÆÊàëÁöÑsitemap" data-position="top" data-delay="50">
        <i class="fas fa-sitemap"></i>
    </a>


    <a href="https://pl.jwt1399.top" class="tooltipped" target="_blank" data-tooltip="valineËØÑËÆ∫: https://pl.jwt1399.top" data-position="top" data-delay="50">
        <i class="fab fa-optin-monster"></i>
    </a>


    <a href="mailto:1019084218@qq.com" class="tooltipped" target="_blank" data-tooltip="ÈÇÆ‰ª∂ËÅîÁ≥ªÊàë" data-position="top" data-delay="50">
        <i class="fas fa-envelope"></i>
    </a>













    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1019084218" class="tooltipped" target="_blank" data-tooltip="QQËÅîÁ≥ªÊàë: 1019084218" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>


    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS ËÆ¢ÈòÖ" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>

    <!-- ÊêúÁ¥¢ÈÅÆÁΩ©Ê°Ü -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;ÊêúÁ¥¢</span>
            <input type="search" id="searchInput" name="s" placeholder="ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÁöÑÂÖ≥ÈîÆÂ≠ó"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.json", 'searchInput', 'searchResult');
});
</script>
    <!-- ÂõûÂà∞È°∂ÈÉ®ÊåâÈíÆ -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.staticfile.org/aos/3.0.0-beta.6/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>
	<!--valine_‰∫∫Êú∫È™åËØÅ-->
	<button id="TencentCaptcha"data-appid="2046265119"data-cbfn="callback"type="button" hidden></button>
	
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-160042502-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-160042502-1');
</script>


    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0e306ce3426983ae6367d094d39f1190";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon.min.js" async="async"></script>
    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

        
</body>

</html>
